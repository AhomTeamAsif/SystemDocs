<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>SystemDocs</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Crypto Market Data Aggregator</li><li class="chapter-item expanded "><a href="Crypto_Market_Data/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/feature_list.html"><strong aria-hidden="true">2.</strong> Features Overview </a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/1-blockchain-data-infrastructure.html"><strong aria-hidden="true">2.1.</strong> BLOCKCHAIN DATA INFRASTRUCTURE</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/2-centralized-exchange-cex-integration.html"><strong aria-hidden="true">2.2.</strong> CENTRALIZED EXCHANGE (CEX) INTEGRATION</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/3-decentralized-exchange-dex-integration.html"><strong aria-hidden="true">2.3.</strong> DECENTRALIZED EXCHANGE (DEX) INTEGRATION</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/4-price-aggregation--analytics-engine.html"><strong aria-hidden="true">2.4.</strong> PRICE AGGREGATION & ANALYTICS ENGINE</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/5-time-series-data-generation.html"><strong aria-hidden="true">2.5.</strong> TIME-SERIES DATA GENERATION</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/6-advanced-analytics-features.html"><strong aria-hidden="true">2.6.</strong> ADVANCED ANALYTICS FEATURES</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/7-user-authentication--authorization.html"><strong aria-hidden="true">2.7.</strong> USER AUTHENTICATION & AUTHORIZATION</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/8-api-key-management--authentication.html"><strong aria-hidden="true">2.8.</strong> API KEY MANAGEMENT & AUTHENTICATION</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/9-subscription--billing-management.html"><strong aria-hidden="true">2.9.</strong> SUBSCRIPTION & BILLING MANAGEMENT</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/10-rate-limiting--quota-management.html"><strong aria-hidden="true">2.10.</strong> RATE LIMITING & QUOTA MANAGEMENT</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/11-api--data-distribution.html"><strong aria-hidden="true">2.11.</strong> API & DATA DISTRIBUTION</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/12-real-time-data-streaming.html"><strong aria-hidden="true">2.12.</strong> REAL-TIME DATA STREAMING</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Feature_List/13-compliance--security.html"><strong aria-hidden="true">2.13.</strong> COMPLIANCE & SECURITY</a></li></ol></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/data_definition_sheet.html"><strong aria-hidden="true">3.</strong>  Data Definition Overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/1-blockchain-data-infrastructure.html"><strong aria-hidden="true">3.1.</strong> Blockchain Data Infrastructure</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/2-centralized-exchange-cex-integration.html"><strong aria-hidden="true">3.2.</strong> Centralized Exchange (CEX) Integration</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/3-decentralized-exchange-dex-integration.html"><strong aria-hidden="true">3.3.</strong> Decentralized Exchange (DEX) Integration</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/4-price-aggregation--analytics-engine.html"><strong aria-hidden="true">3.4.</strong> Price Aggregation & Analytics Engine</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/5-time-series-data-generation.html"><strong aria-hidden="true">3.5.</strong> Time-Series Data Generation</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/6-advanced-analytics-features.html"><strong aria-hidden="true">3.6.</strong> Advanced Analytics Features</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/7-api-key-management--authentication.html"><strong aria-hidden="true">3.7.</strong> API Key Management & Authentication</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/12-subscription--billing-management.html"><strong aria-hidden="true">3.8.</strong> Subscription & Billing Management</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/8-rate-limiting--quota-management.html"><strong aria-hidden="true">3.9.</strong> Rate Limiting & Quota Management</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/9-api-data-distribution.html"><strong aria-hidden="true">3.10.</strong> API & Data Distribution</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/10-real-time-data-streamin.html"><strong aria-hidden="true">3.11.</strong> Real-Time Data Streaming</a></li><li class="chapter-item expanded "><a href="Crypto_Market_Data/Data_Defination_Sheet/11-compliance--security.html"><strong aria-hidden="true">3.12.</strong> Compliance & Security</a></li></ol></li><li class="chapter-item expanded "><a href="class_diagram.html"><strong aria-hidden="true">4.</strong> Class Diagram</a></li><li class="chapter-item expanded "><a href="er_diagram.html"><strong aria-hidden="true">5.</strong> ER Diagram</a></li><li class="chapter-item expanded "><a href="dfd.html"><strong aria-hidden="true">6.</strong> Data Flow Diagram (DFD)</a></li><li class="chapter-item expanded affix "><li class="part-title">RPC Node Provider Service</li><li class="chapter-item expanded "><a href="Introduction_rpc.html"><strong aria-hidden="true">7.</strong> RPC Node Provider Service</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SystemDocs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="1-introduction"><a class="header" href="#1-introduction">1. Introduction</a></h1>
<h1 id="crypto-market-data-aggregator"><a class="header" href="#crypto-market-data-aggregator">Crypto Market Data Aggregator</a></h1>
<p>This institutional-grade cryptocurrency market intelligence platform has been proposed by <strong>Sagar, Walid, and Asif</strong> from the blockchain team at <strong>AlXICorn</strong>, in response to organizational requirements for comprehensive market data solutions.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>This platform delivers institutional-grade cryptocurrency market intelligence through a unified data pipeline connecting:</p>
<ul>
<li><strong>100+ blockchain networks</strong> with real-time node integration</li>
<li><strong>200+ decentralized exchanges</strong> with automated liquidity tracking</li>
<li><strong>100+ centralized exchanges</strong> with sub-100ms price feeds</li>
</ul>
<p>Inspired by CoinGecko and CoinMarketCap, we provide mathematically-verified market data for trading systems, analysts, and blockchain applications.</p>
<hr />
<h2 id="core-mission"><a class="header" href="#core-mission">Core Mission</a></h2>
<p>Solve critical market fragmentation through:</p>
<ol>
<li><strong>Zero third-party dependencies</strong> - Direct blockchain node integrations</li>
<li><strong>Sub-second market data</strong> - Faster than exchange API propagation</li>
<li><strong>Manipulation-resistant pricing</strong> - Statistical consensus algorithms</li>
<li><strong>Institutional-grade analytics</strong> - Customizable time-series pipelines</li>
</ol>
<hr />
<h2 id="architectural-pillars"><a class="header" href="#architectural-pillars">Architectural Pillars</a></h2>
<h3 id="1-blockchain-data-infrastructure"><a class="header" href="#1-blockchain-data-infrastructure">1. Blockchain Data Infrastructure</a></h3>
<p><strong>Multi-Chain Intelligence</strong></p>
<ul>
<li>Real-time block processing (1-3s confirmation)</li>
<li>Chain reorganization handling with atomic rollbacks</li>
<li>Multi-node redundancy with automatic failover</li>
<li>Smart contract event decoding for 200+ DEX protocols</li>
</ul>
<p><strong>Key Advantages</strong></p>
<ul>
<li>Direct node access eliminates third-party latency</li>
<li>100% coverage of EVM and non-EVM chains</li>
<li>Event-driven architecture for instant liquidity updates</li>
</ul>
<h3 id="2-exchange-integration-system"><a class="header" href="#2-exchange-integration-system">2. Exchange Integration System</a></h3>
<p><strong>Unified Data Gateway</strong></p>
<ul>
<li>Single API integration for 100+ CEX platforms</li>
<li>Real-time trade processing</li>
<li>Exchange health scoring and reliability metrics</li>
</ul>
<p><strong>Intelligent Management</strong></p>
<ul>
<li>Dynamic rate limit optimization</li>
<li>Anomaly detection for erroneous pricing</li>
<li>Volume-weighted exchange ranking</li>
</ul>
<h3 id="3-market-synthesis-engine"><a class="header" href="#3-market-synthesis-engine">3. Market Synthesis Engine</a></h3>
<p><strong>Consensus Pricing</strong></p>
<ul>
<li>Volume-weighted aggregation across 300+ sources</li>
<li>Statistical outlier filtering</li>
<li>Dynamic exchange weighting</li>
</ul>
<p><strong>Advanced Analytics</strong></p>
<ul>
<li>VWAP/TWAP calculations</li>
<li>Liquidity health scoring</li>
<li>Volatility modeling</li>
<li>Token security audits</li>
</ul>
<h3 id="4-enterprise-delivery-framework"><a class="header" href="#4-enterprise-delivery-framework">4. Enterprise Delivery Framework</a></h3>
<p><strong>Data Distribution</strong></p>
<ul>
<li>WebSocket streams with</li>
<li>Customizable OHLCV pipelines (1m to monthly)</li>
<li>Historical data bulk export</li>
</ul>
<p><strong>Compliance &amp; Security</strong></p>
<ul>
<li>GDPR/CCPA compliant data management</li>
<li>Military-grade API protection</li>
<li>Role-based access controls</li>
</ul>
<hr />
<h2 id="market-problem-resolution"><a class="header" href="#market-problem-resolution">Market Problem Resolution</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Market Challenge</th><th>Our Solution</th><th>Impact</th></tr></thead><tbody>
<tr><td>Fragmented liquidity</td><td>300+ unified trading venues</td><td>Complete market visibility</td></tr>
<tr><td>Price manipulation</td><td>Statistical outlier detection</td><td>99.7% data accuracy guarantee</td></tr>
<tr><td>Cross-chain arbitrage</td><td>Atomic multi-chain tracking</td><td>Real-time opportunity detection</td></tr>
<tr><td>Institutional data needs</td><td>Custom VWAP/TWAP calculations</td><td>Trading compliance enablement</td></tr>
<tr><td>API reliability issues</td><td>Exchange health monitoring</td><td>99.99% uptime SLA</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="technology-differentiation"><a class="header" href="#technology-differentiation">Technology Differentiation</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Capability</th><th>Industry Standard</th><th>Our Platform</th><th>Advantage</th></tr></thead><tbody>
<tr><td>Data latency</td><td>15-60 seconds</td><td><strong>5-10s</strong></td><td>20-200x faster</td></tr>
<tr><td>Price sources</td><td>50-100</td><td><strong>300+</strong></td><td>3x coverage</td></tr>
<tr><td>Blockchain networks</td><td>10-20</td><td><strong>100+</strong></td><td>Full EVM/non-EVM</td></tr>
<tr><td>DEX protocol coverage</td><td>Top 50</td><td><strong>200+</strong></td><td>Emerging market</td></tr>
<tr><td>Consensus methodology</td><td>Simple average</td><td><strong>Volume-weighted reliability scoring</strong></td><td>Manipulation-resistant</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="platform-applications"><a class="header" href="#platform-applications">Platform Applications</a></h2>
<ol>
<li>
<p><strong>Real-time trading systems</strong></p>
<ul>
<li>WebSocket API for price streams</li>
<li>Exchange-specific order book feeds</li>
</ul>
</li>
<li>
<p><strong>Research &amp; backtesting</strong></p>
<ul>
<li>Historical OHLCV endpoints</li>
<li>Bulk data export (CSV/JSON/Parquet)</li>
</ul>
</li>
<li>
<p><strong>Risk management</strong></p>
<ul>
<li>Token security scoring</li>
<li>Liquidity health metrics</li>
</ul>
</li>
<li>
<p><strong>Enterprise integration</strong></p>
<ul>
<li>Custom SLA agreements</li>
<li>Dedicated infrastructure support</li>
</ul>
</li>
</ol>
<blockquote>
<p>&quot;In blockchain markets, data latency is the invisible tax on every transaction. Our platform eliminates this tax.&quot;<br />
â€” Platform Architecture Principle</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="features-overview"><a class="header" href="#features-overview">Features Overview</a></h1>
<p>Explore the core features of the Crypto Market Data Aggregator through this summary, with direct links to in-depth documentation for each component.</p>
<hr />
<h2 id="feature-modules"><a class="header" href="#feature-modules">Feature Modules</a></h2>
<ul>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./1-blockchain-data-infrastructure.html">Blockchain Data Infrastructure</a><br />
Core components for multi-chain blockchain data integration, real-time processing, event extraction, and redundancy.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./2-centralized-exchange-cex-integration.html">Centralized Exchange (CEX) Integration</a><br />
Unified API integration with 100+ centralized exchanges for real-time price feeds, trade history, and health monitoring.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./3-decentralized-exchange-dex-integration.html">Decentralized Exchange (DEX) Integration</a><br />
Support for 200+ DEX protocols with automated pool discovery, AMM price calculations, and cross-chain tracking.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./4-price-aggregation--analytics-engine.html">Price Aggregation &amp; Analytics Engine</a><br />
Volume-weighted price consensus, outlier detection, exchange weighting, VWAP calculations, and fair value estimation.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./5-time-series-data-generation.html">Time-Series Data Generation</a><br />
Multi-timeframe OHLCV generation, custom aggregation windows, detailed volume analysis, and data interpolation.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./6-advanced-analytics-features.html">Advanced Analytics Features</a><br />
Automated token security scoring, liquidity health metrics, and real-time volatility modeling.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./7-user-authentication--authorization.html">User Authentication &amp; Authorization</a><br />
Robust user registration, role-based access control, OAuth/SSO integration, and session management.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./8-api-key-management--authentication.html">API Key Management &amp; Authentication</a><br />
Secure API key lifecycle management, authentication middleware, internal service authentication, and scoped permissions.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./9-subscription--billing-management.html">Subscription &amp; Billing Management</a><br />
Subscription tiers, payment processing, usage tracking, lifecycle management, and enterprise contracts.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./10-rate-limiting--quota-management.html">Rate Limiting &amp; Quota Management</a><br />
Tiered rate limiting, usage quotas, fair usage policies, and dynamic rate adjustments based on system load.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./11-api--data-distribution.html">API &amp; Data Distribution</a><br />
Core price endpoints, market data APIs, OHLCV access, exchange data, search &amp; discovery, and bulk historical exports.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./12-real-time-data-streaming.html">Real-Time Data Streaming</a><br />
WebSocket streaming for live data, subscription management, push notifications across multiple channels.</p>
</li>
<li>
<p><a href="Crypto_Market_Data/Feature_List/./13-compliance--security.html">Compliance &amp; Security</a><br />
Data privacy and GDPR compliance, API security, DDoS protection, and automated threat detection.</p>
</li>
</ul>
<hr />
<p>Feel free to explore each module for a deeper understanding of the platformâ€™s capabilities and architecture.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="blockchain-data-infrastructure"><a class="header" href="#blockchain-data-infrastructure">Blockchain Data Infrastructure</a></h1>
<p>This module outlines the core components responsible for integrating, processing, and managing blockchain data across multiple networks. It ensures high-speed, reliable, and accurate data access necessary for real-time decentralized finance (DeFi) applications.</p>
<hr />
<h2 id="bc-001-multi-chain-node-integration"><a class="header" href="#bc-001-multi-chain-node-integration">BC-001: Multi-Chain Node Integration</a></h2>
<p><strong>Description</strong><br />
Establishes direct connections to over 100 blockchain networks, including Ethereum, Binance Smart Chain, Polygon, Avalanche, Arbitrum, and Solana. Supports both EVM and non-EVM chains through persistent WebSocket and RPC connections.</p>
<p><strong>Why This Feature Exists</strong><br />
Direct integration eliminates dependency on third-party providers, ensuring authenticity and reducing latency. It enables the platform to access raw blockchain data immediately upon block confirmation.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Maintain connections to 100+ blockchain networks</li>
<li>Support both EVM and non-EVM chains</li>
<li>Manage network-specific protocols and data formats</li>
<li>Provide failover mechanisms for node connectivity</li>
</ul>
<hr />
<h2 id="bc-002-real-time-block-processing"><a class="header" href="#bc-002-real-time-block-processing">BC-002: Real-Time Block Processing</a></h2>
<p><strong>Description</strong><br />
Processes each new block within 1â€“3 seconds of confirmation across all supported networks. Parses headers, extracts transaction data, and detects significant events.</p>
<p><strong>Why This Feature Exists</strong><br />
Block-level events drive the crypto market. Processing them in real-time ensures detection of swaps, transfers, and interactions instantlyâ€”providing accurate, up-to-date data to users.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Parse block data within 1â€“3 seconds of confirmation</li>
<li>Extract all transactions and relevant details</li>
<li>Detect DEX swaps, token transfers, smart contract interactions</li>
<li>Handle high-throughput chains with sub-second block times</li>
<li>Manage processing queues for simultaneous block events</li>
</ul>
<hr />
<h2 id="bc-003-event-log-extraction"><a class="header" href="#bc-003-event-log-extraction">BC-003: Event Log Extraction</a></h2>
<p><strong>Description</strong><br />
Decodes smart contract events (e.g., swaps, mints, burns, liquidity changes) across 200+ DEX protocols using a contract ABI and signature database.</p>
<p><strong>Why This Feature Exists</strong><br />
Smart contract events provide the raw data for interpreting market activity. Accurate event extraction is critical for pricing, volume analytics, and liquidity monitoring.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Decode events from 200+ DEX protocols</li>
<li>Maintain updated ABI databases for major contracts</li>
<li>Handle proxy contracts and upgradeable implementations</li>
<li>Extract pricing and volume data from AMM events</li>
<li>Support multiple event formats and standards</li>
</ul>
<hr />
<h2 id="bc-004-multi-node-redundancy"><a class="header" href="#bc-004-multi-node-redundancy">BC-004: Multi-Node Redundancy</a></h2>
<p><strong>Description</strong><br />
Implements automatic failover mechanisms between primary and backup nodes per blockchain network to ensure uninterrupted data flow.</p>
<p><strong>Why This Feature Exists</strong><br />
Blockchain nodes may become unresponsive or lag behind. Redundancy ensures high availability, uptime, and data consistency across networks.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Maintain multiple node connections per network</li>
<li>Implement automatic failover logic</li>
<li>Monitor node health and synchronization status</li>
<li>Load-balance across active nodes</li>
<li>Enable graceful degradation during failures</li>
</ul>
<hr />
<h2 id="bc-005-chain-reorganization-handling"><a class="header" href="#bc-005-chain-reorganization-handling">BC-005: Chain Reorganization Handling</a></h2>
<p><strong>Description</strong><br />
Detects and manages blockchain reorganizations (reorgs) when previously confirmed blocks are invalidated due to longer chains being adopted.</p>
<p><strong>Why This Feature Exists</strong><br />
Reorgs can lead to incorrect data if not handled properly. This mechanism ensures that stale data is reverted and replaced with accurate, canonical information.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Detect reorganizations across all networks</li>
<li>Revert invalidated data from orphaned blocks</li>
<li>Reprocess data from the new canonical chain</li>
<li>Notify downstream systems of corrections</li>
<li>Maintain audit trails for all reorg events</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams"><a class="header" href="#-visual-references--diagrams">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635454190177&cot=14" target="_blank"> On-chain Data Scrapping </a></p>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635458959932&cot=14" target="_blank"> On-chain Data Processing </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="centralized-exchange-cex-integration"><a class="header" href="#centralized-exchange-cex-integration">Centralized Exchange (CEX) Integration</a></h1>
<p>This module focuses on connecting to a wide range of centralized cryptocurrency exchanges to collect market data, trade history, and monitor exchange health, enabling comprehensive and reliable market insights.</p>
<hr />
<h2 id="cex-001-multi-exchange-api-integration"><a class="header" href="#cex-001-multi-exchange-api-integration">CEX-001: Multi-Exchange API Integration</a></h2>
<p><strong>Description</strong><br />
Establishes direct connections to over 100 centralized exchanges using both REST APIs and WebSocket feeds. It handles diverse API specifications, authentication methods, and provides a unified data collection framework.</p>
<p><strong>Why This Feature Exists</strong><br />
Centralized exchanges dominate trading volume and price discovery. Integrating many exchanges ensures broad market coverage, redundancy against outages, and access to diverse trading pairs.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Connect to 100+ centralized exchanges</li>
<li>Support various authentication methods (API keys, OAuth, etc.)</li>
<li>Handle multiple API formats and protocols (REST, WebSocket)</li>
<li>Manage exchange-specific configurations and updates</li>
</ul>
<hr />
<h2 id="cex-002-real-time-price-feeds"><a class="header" href="#cex-002-real-time-price-feeds">CEX-002: Real-Time Price Feeds</a></h2>
<p><strong>Description</strong><br />
Collects live price updates from all connected exchanges with sub-100 millisecond latency, normalizing data and distributing updates efficiently to downstream consumers.</p>
<p><strong>Why This Feature Exists</strong><br />
Prices fluctuate rapidly in crypto markets. Real-time feeds enable timely trading decisions, arbitrage opportunities, and accurate market snapshots.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Collect price updates with &lt;100ms latency</li>
<li>Handle high-frequency updates and spikes</li>
<li>Normalize prices across exchanges for consistency</li>
<li>Detect and filter erroneous or outlier data</li>
<li>Distribute updates via low-latency channels</li>
</ul>
<hr />
<h2 id="cex-003-trade-history-collection"><a class="header" href="#cex-003-trade-history-collection">CEX-003: Trade History Collection</a></h2>
<p><strong>Description</strong><br />
Gathers comprehensive trade execution data from all exchanges, including price, volume, timestamp, and trade direction. Supports replay and historical analysis.</p>
<p><strong>Why This Feature Exists</strong><br />
Trade history underpins volume metrics, technical indicators, and market analysis, revealing true trading activity beyond just price data.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Collect real-time trade executions</li>
<li>Store detailed data: price, volume, time, side (buy/sell)</li>
<li>Handle trade corrections and cancellations</li>
<li>Support multiple trade types (market, limit, stop)</li>
<li>Provide historical replay functionality</li>
</ul>
<hr />
<h2 id="cex-004-exchange-health-monitoring"><a class="header" href="#cex-004-exchange-health-monitoring">CEX-004: Exchange Health Monitoring</a></h2>
<p><strong>Description</strong><br />
Continuously tracks API response times, error rates, availability, and data quality metrics for all connected exchanges, providing reliability scores and alerting on issues.</p>
<p><strong>Why This Feature Exists</strong><br />
Exchange APIs vary in reliability. Monitoring health ensures data accuracy, allows dynamic data source weighting, and triggers failover if needed.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Monitor API response time and uptime</li>
<li>Track error rates and timeouts</li>
<li>Assess and score data quality and consistency</li>
<li>Generate reliability metrics for exchanges</li>
<li>Alert operators on exchange-specific issues</li>
</ul>
<hr />
<h2 id="cex-005-rate-limit-management"><a class="header" href="#cex-005-rate-limit-management">CEX-005: Rate Limit Management</a></h2>
<p><strong>Description</strong><br />
Intelligently manages API rate limits across exchanges through request queuing, prioritization, and throttling to maximize data throughput without violating usage policies.</p>
<p><strong>Why This Feature Exists</strong><br />
Exchanges impose strict API rate limits; exceeding them causes bans or suspensions. Managing limits smartly ensures uninterrupted data collection.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Track rate limits per exchange and endpoint</li>
<li>Queue and prioritize API requests dynamically</li>
<li>Throttle requests based on real-time usage</li>
<li>Predict and prevent potential rate limit violations</li>
<li>Optimize request patterns for efficiency</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-1"><a class="header" href="#-visual-references--diagrams-1">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635931036520&cot=14" target="_blank"> CEX Integration Data Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="decentralized-exchange-dex-integration"><a class="header" href="#decentralized-exchange-dex-integration">Decentralized Exchange (DEX) Integration</a></h1>
<p>This module supports a broad range of decentralized exchange protocols to capture comprehensive DeFi trading data, ensuring full coverage of the decentralized trading ecosystem.</p>
<hr />
<h2 id="dex-001-protocol-coverage"><a class="header" href="#dex-001-protocol-coverage">DEX-001: Protocol Coverage</a></h2>
<p><strong>Description</strong><br />
Supports over 200 DEX protocols across all major blockchain networks, handling varied smart contract interfaces, AMM formulas, and trading mechanisms.</p>
<p><strong>Why This Feature Exists</strong><br />
DEX trading forms a significant part of cryptocurrency volume. Covering a wide range of protocols ensures users have access to the full DeFi market landscape.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Support 200+ DEX protocols across major chains</li>
<li>Handle different AMM types (constant product, stable swaps, concentrated liquidity)</li>
<li>Support order book and hybrid DEX models</li>
<li>Manage protocol-specific features and parameters</li>
<li>Track protocol upgrades and new versions</li>
</ul>
<hr />
<h2 id="dex-002-automated-pool-discovery"><a class="header" href="#dex-002-automated-pool-discovery">DEX-002: Automated Pool Discovery</a></h2>
<p><strong>Description</strong><br />
Automatically detects new trading pairs and liquidity pools created across supported DEX protocols, maintaining comprehensive and up-to-date market coverage.</p>
<p><strong>Why This Feature Exists</strong><br />
New pools emerge continuously in DeFi without advance notice. Automated discovery ensures no opportunity is missed.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Monitor pool creation events on all protocols</li>
<li>Index new trading pairs automatically</li>
<li>Validate pool legitimacy and filter scam tokens</li>
<li>Track pool metadata and configurations</li>
<li>Maintain updated registry of active pools</li>
</ul>
<hr />
<h2 id="dex-003-amm-price-calculation"><a class="header" href="#dex-003-amm-price-calculation">DEX-003: AMM Price Calculation</a></h2>
<p><strong>Description</strong><br />
Calculates accurate token prices using the specific AMM formulas employed by various DEX protocols, covering simple and complex multi-asset curves.</p>
<p><strong>Why This Feature Exists</strong><br />
DEX prices are formula-based rather than order book-driven. Accurate calculations enable correct market data and arbitrage detection.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Support all major AMM formula types</li>
<li>Handle dynamic parameters including fees</li>
<li>Calculate prices for multi-hop swaps</li>
<li>Account for slippage and price impact</li>
<li>Provide price quotes for different trade sizes</li>
</ul>
<hr />
<h2 id="dex-005-cross-chain-pool-tracking"><a class="header" href="#dex-005-cross-chain-pool-tracking">DEX-005: Cross-Chain Pool Tracking</a></h2>
<p><strong>Description</strong><br />
Tracks identical token pairs across multiple blockchain networks to enable cross-chain price comparison and identify arbitrage opportunities.</p>
<p><strong>Why This Feature Exists</strong><br />
Tokens often exist on multiple chains, and price differences can be exploited. Cross-chain tracking provides insight into multi-chain token dynamics.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Identify equivalent tokens across different chains</li>
<li>Track cross-chain price disparities</li>
<li>Monitor bridge activity and token transfers</li>
<li>Calculate cross-chain arbitrage opportunities</li>
<li>Provide unified multi-chain token views</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-2"><a class="header" href="#-visual-references--diagrams-2">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635929424258&cot=14" target="_blank"> DEX Protocol Coverage Overview </a>
<a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635928237147&cot=14" target="_blank"> On-Chain Data Infrastructure </a></p>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635928237147&cot=14" target="_blank"> On-Chain Data Infrastructure </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="price-aggregation--analytics-engine"><a class="header" href="#price-aggregation--analytics-engine">Price Aggregation &amp; Analytics Engine</a></h1>
<p>This module aggregates and analyzes price data from multiple sources to deliver accurate, reliable, and actionable market insights, supporting both real-time and historical analytics.</p>
<hr />
<h2 id="pa-001-multi-source-price-consensus"><a class="header" href="#pa-001-multi-source-price-consensus">PA-001: Multi-Source Price Consensus</a></h2>
<p><strong>Description</strong><br />
Aggregates price data from over 100 centralized exchanges (CEX) and 200 decentralized exchanges (DEX) using volume-weighted algorithms to produce a single authoritative price per trading pair.</p>
<p><strong>Why This Feature Exists</strong><br />
Prices vary across venues. A multi-source consensus price minimizes outliers and manipulation effects, providing a true reflection of market value.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Aggregate prices from 100+ CEX and 200+ DEX sources</li>
<li>Implement volume-weighted consensus algorithms</li>
<li>Handle diverse price formats and pair conventions</li>
<li>Provide confidence intervals for price estimates</li>
<li>Support both real-time and historical consensus pricing</li>
</ul>
<hr />
<h2 id="pa-002-outlier-detection-algorithm"><a class="header" href="#pa-002-outlier-detection-algorithm">PA-002: Outlier Detection Algorithm</a></h2>
<p><strong>Description</strong><br />
Employs statistical methods to identify and filter erroneous price data caused by exchange errors or manipulation, preserving data quality.</p>
<p><strong>Why This Feature Exists</strong><br />
Faulty prices can distort consensus. Detecting and filtering outliers ensures reliable data integrity.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Statistical analysis of price deviations</li>
<li>Real-time outlier detection and filtering</li>
<li>Historical pattern validation</li>
<li>Configurable sensitivity parameters</li>
<li>Maintain audit trails of filtered data points</li>
</ul>
<hr />
<h2 id="pa-003-exchange-weight-calculation"><a class="header" href="#pa-003-exchange-weight-calculation">PA-003: Exchange Weight Calculation</a></h2>
<p><strong>Description</strong><br />
Dynamically assigns weights to exchanges based on volume, reliability, and data quality to influence consensus prices appropriately.</p>
<p><strong>Why This Feature Exists</strong><br />
Exchanges differ in reliability and significance. Weighting ensures trustworthy venues have more influence.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Volume-based weighting algorithms</li>
<li>Reliability scoring from historical data</li>
<li>Real-time adjustment of weights</li>
<li>Transparent weighting methodology</li>
<li>Historical tracking and analysis of weights</li>
</ul>
<hr />
<h2 id="pa-006-vwap-calculations"><a class="header" href="#pa-006-vwap-calculations">PA-006: VWAP Calculations</a></h2>
<p><strong>Description</strong><br />
Calculates Time-Weighted Average Price (TWAP) and Volume-Weighted Average Price (VWAP) metrics over customizable timeframes, supporting institutional benchmarks.</p>
<p><strong>Why This Feature Exists</strong><br />
VWAP and TWAP are key benchmarks in institutional and algorithmic trading, aiding performance evaluation and fair value assessment.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Compute VWAP over multiple timeframes</li>
<li>Support custom trading sessions and periods</li>
<li>Adjust calculations for market volatility and conditions</li>
<li>Provide historical VWAP data</li>
<li>Enable institutional trading benchmark support</li>
</ul>
<hr />
<h2 id="pa-007-fair-value-estimation"><a class="header" href="#pa-007-fair-value-estimation">PA-007: Fair Value Estimation</a></h2>
<p><strong>Description</strong><br />
Estimates the fair value of assets by combining multi-source prices, volume data, and market depth to reflect true market value accurately.</p>
<p><strong>Why This Feature Exists</strong><br />
Fair value provides a baseline for evaluating current prices and identifying good investment opportunities.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Multi-factor fair value models integrating fundamental and technical factors</li>
<li>Real-time updates on fair value</li>
<li>Confidence intervals and uncertainty metrics</li>
<li>Historical tracking of fair value estimates</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-3"><a class="header" href="#-visual-references--diagrams-3">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635970275686&cot=10" target="_blank"> Price Aggregation Engine </a></p>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635928237147&cot=14" target="_blank"> Time Series Data Generation </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="time-series-data-generation"><a class="header" href="#time-series-data-generation">Time-Series Data Generation</a></h1>
<p>This module generates, processes, and maintains high-quality time-series market data across various granularities, supporting diverse analysis and visualization needs.</p>
<hr />
<h2 id="ts-001-multi-timeframe-ohlcv"><a class="header" href="#ts-001-multi-timeframe-ohlcv">TS-001: Multi-Timeframe OHLCV</a></h2>
<p><strong>Description</strong><br />
Generates Open, High, Low, Close, and Volume (OHLCV) candlestick data across multiple timeframes ranging from 5-second intervals to monthly periods.</p>
<p><strong>Why This Feature Exists</strong><br />
OHLCV data is foundational for price visualization and technical analysis. Supporting various timeframes enables flexible trading strategies and comprehensive charting.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Generate candles for 5s, 1m, 5m, 15m, 1h, 4h, 24h, 7d, 30d intervals</li>
<li>Ensure consistency across timeframes</li>
<li>Handle partial candles and provide real-time updates</li>
<li>Support historical candle reconstruction</li>
<li>Validate data quality for all timeframes</li>
</ul>
<hr />
<h2 id="ts-002-custom-aggregation-windows"><a class="header" href="#ts-002-custom-aggregation-windows">TS-002: Custom Aggregation Windows</a></h2>
<p><strong>Description</strong><br />
Allows institutional clients to define custom aggregation periods tailored to specific trading or reporting needs.</p>
<p><strong>Why This Feature Exists</strong><br />
Standard timeframes may not suit all use cases. Custom windows offer flexibility for specialized strategies and research applications.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Support user-defined aggregation periods</li>
<li>Manage overlapping and non-standard windows</li>
<li>Provide API endpoints for custom timeframes</li>
<li>Maintain performance with arbitrary window sizes</li>
<li>Enable complex aggregation rules and filters</li>
</ul>
<hr />
<h2 id="ts-003-volume-analysis"><a class="header" href="#ts-003-volume-analysis">TS-003: Volume Analysis</a></h2>
<p><strong>Description</strong><br />
Offers detailed volume breakdowns by source, timeframe, and market type, giving insights into trading activity and market participation.</p>
<p><strong>Why This Feature Exists</strong><br />
Volume indicates market interest and trend strength. Detailed analysis helps identify significant activity and trading patterns.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Break down volume by exchange and market type</li>
<li>Track volume trends across timeframes</li>
<li>Detect volume spikes and anomalies</li>
<li>Provide volume-based technical indicators</li>
<li>Support volume profile analysis</li>
</ul>
<hr />
<h2 id="ts-008-data-interpolation"><a class="header" href="#ts-008-data-interpolation">TS-008: Data Interpolation</a></h2>
<p><strong>Description</strong><br />
Fills missing time-series data points using statistical and interpolation methods to ensure complete datasets.</p>
<p><strong>Why This Feature Exists</strong><br />
Complete time series are critical for accurate analytics. Interpolation mitigates gaps caused by missing or delayed source data.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Use multiple interpolation methods (linear, spline, etc.)</li>
<li>Apply context-aware interpolation based on market conditions</li>
<li>Quantify uncertainty in interpolated values</li>
<li>Allow configurable interpolation parameters</li>
<li>Validate interpolation accuracy</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-4"><a class="header" href="#-visual-references--diagrams-4">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635957717472&cot=10" target="_blank"> Time-Series Data Generation Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="advanced-analytics-features"><a class="header" href="#advanced-analytics-features">Advanced Analytics Features</a></h1>
<p>This module provides sophisticated analytics that enhance user insights into token safety, liquidity health, and market volatility, supporting safer and smarter trading decisions.</p>
<hr />
<h2 id="aa-001-token-security-scoring"><a class="header" href="#aa-001-token-security-scoring">AA-001: Token Security Scoring</a></h2>
<p><strong>Description</strong><br />
Automatically analyzes smart contracts to detect potential security risks, scam tokens, and threats, assigning safety scores to tokens.</p>
<p><strong>Why This Feature Exists</strong><br />
The crypto ecosystem includes many fraudulent or risky tokens. Automated scoring protects users by flagging risky assets before interaction.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Automated smart contract vulnerability analysis</li>
<li>Scam token detection algorithms</li>
<li>Multi-factor risk scoring system</li>
<li>Real-time updates with new threat information</li>
<li>Integration with external security and threat databases</li>
</ul>
<hr />
<h2 id="aa-002-liquidity-health-metrics"><a class="header" href="#aa-002-liquidity-health-metrics">AA-002: Liquidity Health Metrics</a></h2>
<p><strong>Description</strong><br />
Analyzes the health and stability of liquidity pools by measuring concentration risk, provider behavior, and sustainability.</p>
<p><strong>Why This Feature Exists</strong><br />
Healthy liquidity pools ensure quality trading and investment safety. Health metrics help identify stable pools and warn about risky or mismanaged ones.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Measure liquidity concentration and distribution</li>
<li>Track liquidity provider behavior patterns</li>
<li>Monitor pool sustainability indicators</li>
<li>Identify pools at risk of abandonment</li>
<li>Provide historical liquidity health trend analysis</li>
</ul>
<hr />
<h2 id="aa-006-volatility-modeling"><a class="header" href="#aa-006-volatility-modeling">AA-006: Volatility Modeling</a></h2>
<p><strong>Description</strong><br />
Offers real-time calculations of asset volatility using multiple models, aiding understanding of price stability and risk.</p>
<p><strong>Why This Feature Exists</strong><br />
Volatility is crucial for trading strategies, option pricing, and risk management. Real-time modeling informs sophisticated trading decisions.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Support multiple volatility calculation methods</li>
<li>Provide real-time volatility updates</li>
<li>Perform historical volatility analysis</li>
<li>Include volatility forecasting models</li>
<li>Integrate with options pricing models</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-5"><a class="header" href="#-visual-references--diagrams-5">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635970491038&cot=10" target="_blank"> Advanced Analysis Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-authentication--authorization"><a class="header" href="#user-authentication--authorization">User Authentication &amp; Authorization</a></h1>
<p>This module ensures secure and flexible user access management, supporting registration, role-based permissions, single sign-on, and robust session control.</p>
<hr />
<h2 id="ua-001-user-registration--management"><a class="header" href="#ua-001-user-registration--management">UA-001: User Registration &amp; Management</a></h2>
<p><strong>Description</strong><br />
Provides a complete user registration system with email verification, profile management, and strong account security features.</p>
<p><strong>Why This Feature Exists</strong><br />
Authentication enables personalized services, usage tracking, and security enforcement. Robust management controls access to premium features and protects user data.</p>
<p><strong>Scope</strong></p>
<ul>
<li>User registration with email verification</li>
<li>Secure password management using encryption</li>
<li>Support for two-factor authentication (2FA)</li>
<li>Account recovery and password reset mechanisms</li>
<li>User profile and preference management</li>
<li>Account deletion and data privacy compliance</li>
</ul>
<hr />
<h2 id="ua-002-role-based-access-control-rbac"><a class="header" href="#ua-002-role-based-access-control-rbac">UA-002: Role-Based Access Control (RBAC)</a></h2>
<p><strong>Priority:</strong> Critical (P0)</p>
<p><strong>Description</strong><br />
Implements flexible role-based permissions controlling feature and data access based on user roles and subscription tiers.</p>
<p><strong>Why This Feature Exists</strong><br />
Different users require different access levels. RBAC ensures security and data integrity by restricting unauthorized access.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Define user roles (Admin, Enterprise, Professional, Basic)</li>
<li>Permission matrix for feature access</li>
<li>Dynamic role assignment and updates</li>
<li>Hierarchical permission inheritance</li>
<li>Audit logging for permission changes</li>
</ul>
<hr />
<h2 id="ua-003-oauth--sso-integration"><a class="header" href="#ua-003-oauth--sso-integration">UA-003: OAuth &amp; SSO Integration</a></h2>
<p><strong>Description</strong><br />
Enables single sign-on (SSO) integration with popular identity providers like Google, GitHub, and enterprise SSO systems to streamline user onboarding.</p>
<p><strong>Why This Feature Exists</strong><br />
SSO reduces onboarding friction and supports enterprise integration with existing authentication infrastructures.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Support OAuth 2.0 and OpenID Connect</li>
<li>Integration with Google, GitHub, Microsoft accounts</li>
<li>SAML support for enterprise SSO</li>
<li>Custom identity provider integration</li>
<li>Automatic account linking and provisioning</li>
</ul>
<hr />
<h2 id="ua-004-session-management"><a class="header" href="#ua-004-session-management">UA-004: Session Management</a></h2>
<p><strong>Description</strong><br />
Manages user sessions across web and API interfaces, including session timeouts, concurrency limits, and secure handling.</p>
<p><strong>Why This Feature Exists</strong><br />
Proper session management balances security and user experience by preventing unauthorized access and enabling seamless cross-device usage.</p>
<p><strong>Scope</strong></p>
<ul>
<li>JWT token-based session management</li>
<li>Configurable session timeouts</li>
<li>Limits on concurrent sessions</li>
<li>Session revocation and blacklisting</li>
<li>Cross-device session synchronization</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-6"><a class="header" href="#-visual-references--diagrams-6">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635547799269&cot=14" target="_blank"> User Authentication Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api-key-management--authentication"><a class="header" href="#api-key-management--authentication">API Key Management &amp; Authentication</a></h1>
<p>This module provides secure and flexible API key lifecycle management and authentication mechanisms, ensuring controlled and auditable programmatic access to platform services.</p>
<hr />
<h2 id="ak-001-api-key-generation--management"><a class="header" href="#ak-001-api-key-generation--management">AK-001: API Key Generation &amp; Management</a></h2>
<p><strong>Description</strong><br />
Enables users to generate, manage, and rotate API keys securely, supporting multiple keys per user with descriptive naming and scope-based permissions.</p>
<p><strong>Why This Feature Exists</strong><br />
API keys authenticate programmatic access. Robust key management secures access while offering flexibility for diverse integrations.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Secure API key generation with cryptographic randomness</li>
<li>Multiple keys per user with descriptive names</li>
<li>Key rotation and expiration policies</li>
<li>Scope-based permissions for fine-grained access control</li>
<li>Usage tracking and analytics</li>
<li>Secure encrypted key storage</li>
</ul>
<hr />
<h2 id="ak-002-api-authentication-middleware"><a class="header" href="#ak-002-api-authentication-middleware">AK-002: API Authentication Middleware</a></h2>
<p><strong>Description</strong><br />
Provides centralized middleware to validate API keys, check permissions, and enforce secure access control across all API endpoints.</p>
<p><strong>Why This Feature Exists</strong><br />
Ensuring every API request is authenticated and authorized protects data security and enables usage monitoring.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Fast API key validation and lookup</li>
<li>Permission checks based on key scopes</li>
<li>Request signature validation for sensitive operations</li>
<li>IP whitelisting and geo-restrictions</li>
<li>Threat detection and automatic request blocking</li>
<li>Detailed authentication logs</li>
</ul>
<hr />
<h2 id="ak-003-internal-service-authentication"><a class="header" href="#ak-003-internal-service-authentication">AK-003: Internal Service Authentication</a></h2>
<p><strong>Description</strong><br />
Manages secure authentication between internal services using JWT tokens, mutual TLS, and service mesh security to prevent unauthorized access.</p>
<p><strong>Why This Feature Exists</strong><br />
Internal service communication must be secured to prevent data leaks and unauthorized access.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Service-to-service JWT token management</li>
<li>Mutual TLS (mTLS) for internal communications</li>
<li>Service identity and certificate lifecycle management</li>
<li>Internal API gateway enforcing authentication</li>
<li>Integration with service mesh security frameworks</li>
</ul>
<hr />
<h2 id="ak-004-key-scope--permissions"><a class="header" href="#ak-004-key-scope--permissions">AK-004: Key Scope &amp; Permissions</a></h2>
<p><strong>Description</strong><br />
Allows creation of API keys with specific scopes and permissions, enforcing least privilege access to only authorized endpoints and data.</p>
<p><strong>Why This Feature Exists</strong><br />
Different applications need different access levels. Scoped keys reduce security risks by limiting exposure.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Granular permission scopes (read, write, admin)</li>
<li>Endpoint-specific access control</li>
<li>Data type and asset-level filtering</li>
<li>Time-based access restrictions</li>
<li>Custom permission sets for enterprise clients</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-7"><a class="header" href="#-visual-references--diagrams-7">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635973940032&cot=10" target="_blank"> API Key Management Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription--billing-management"><a class="header" href="#subscription--billing-management">Subscription &amp; Billing Management</a></h1>
<p>This module manages user subscription plans, billing processes, and enterprise contracts, enabling flexible monetization and customer lifecycle management.</p>
<hr />
<h2 id="sb-001-subscription-tiers"><a class="header" href="#sb-001-subscription-tiers">SB-001: Subscription Tiers</a></h2>
<p><strong>Description</strong><br />
Defines and manages multiple subscription tiers with different access levels, rate limits, and feature sets to serve varied user segments.</p>
<p><strong>Why This Feature Exists</strong><br />
Different users have distinct needs and budgets. Tiered plans optimize resource use and revenue generation across segments.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Multiple subscription tiers (Free, Professional, Enterprise, Custom)</li>
<li>Feature access matrix per tier</li>
<li>Rate limit and quota management</li>
<li>Historical data access restrictions</li>
<li>Support level differentiation</li>
<li>Custom enterprise agreements</li>
</ul>
<hr />
<h2 id="sb-002-payment-processing"><a class="header" href="#sb-002-payment-processing">SB-002: Payment Processing</a></h2>
<p><strong>Description</strong><br />
Handles payments, billing cycles, and payment methods by integrating with providers like Stripe for reliable revenue collection.</p>
<p><strong>Why This Feature Exists</strong><br />
Automated payment processing ensures consistent revenue and user convenience in subscription management.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Support multiple payment methods (credit card, bank transfer, crypto)</li>
<li>Automated recurring billing</li>
<li>Prorated upgrades and downgrades</li>
<li>Failed payment retries and handling</li>
<li>Invoice generation and delivery</li>
<li>Payment history and receipt management</li>
</ul>
<hr />
<h2 id="sb-003-usage-tracking--billing"><a class="header" href="#sb-003-usage-tracking--billing">SB-003: Usage Tracking &amp; Billing</a></h2>
<p><strong>Description</strong><br />
Tracks API usage, data consumption, and other billable metrics for accurate, usage-based billing and quota enforcement.</p>
<p><strong>Why This Feature Exists</strong><br />
Usage-based billing aligns costs with value, offering flexible pricing and transparent consumption insights.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Real-time tracking of all billable metrics</li>
<li>Usage aggregation and reporting</li>
<li>Overage detection and billing</li>
<li>Usage analytics and optimization advice</li>
<li>Historical usage data and trends</li>
<li>Custom usage metrics for enterprise clients</li>
</ul>
<hr />
<h2 id="sb-004-subscription-lifecycle-management"><a class="header" href="#sb-004-subscription-lifecycle-management">SB-004: Subscription Lifecycle Management</a></h2>
<p><strong>Description</strong><br />
Manages subscription lifecycle events including free trials, plan changes, cancellations, and reactivations for smooth customer experiences.</p>
<p><strong>Why This Feature Exists</strong><br />
Effective lifecycle management reduces churn and improves customer satisfaction by enabling flexible plan management.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Free trial management with automatic conversion</li>
<li>Seamless plan upgrades and downgrades</li>
<li>Cancellation and reactivation workflows</li>
<li>Grace periods for failed payments</li>
<li>Subscription pause and resume options</li>
<li>Customer retention and win-back campaigns</li>
</ul>
<hr />
<h2 id="sb-005-enterprise-contracts"><a class="header" href="#sb-005-enterprise-contracts">SB-005: Enterprise Contracts</a></h2>
<p><strong>Description</strong><br />
Manages customized enterprise contracts with negotiated terms, pricing, SLAs, and dedicated support.</p>
<p><strong>Why This Feature Exists</strong><br />
Enterprise clients require tailored agreements beyond standard subscriptions, supporting high-value partnerships.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Custom pricing and contract term management</li>
<li>Service Level Agreement (SLA) tracking</li>
<li>Volume discounts and commitment pricing</li>
<li>Custom feature development and integrations</li>
<li>Dedicated support and account management</li>
<li>Contract renewal and negotiation workflows</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-8"><a class="header" href="#-visual-references--diagrams-8">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635538261089&cot=14" target="_blank"> Subscription Management Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rate-limiting--quota-management"><a class="header" href="#rate-limiting--quota-management">Rate Limiting &amp; Quota Management</a></h1>
<p>This module ensures fair and efficient resource allocation by enforcing tiered rate limits, usage quotas, and dynamic adjustments, protecting platform stability and user experience.</p>
<hr />
<h2 id="rl-001-tiered-rate-limiting"><a class="header" href="#rl-001-tiered-rate-limiting">RL-001: Tiered Rate Limiting</a></h2>
<p><strong>Description</strong><br />
Implements rate limiting based on subscription tiers, balancing fair resource access, abuse prevention, and system performance.</p>
<p><strong>Why This Feature Exists</strong><br />
Prevents overload and abuse, incentivizes subscriptions, and maintains service quality for all users.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Per-tier rate limits (requests per minute/hour/day)</li>
<li>Endpoint-specific rate limiting</li>
<li>Burst allowances for short-term traffic spikes</li>
<li>Rate limit headers and client feedback</li>
<li>Automatic limit increases for higher tiers</li>
<li>Custom rate limits for enterprise clients</li>
</ul>
<hr />
<h2 id="rl-002-usage-quotas"><a class="header" href="#rl-002-usage-quotas">RL-002: Usage Quotas</a></h2>
<p><strong>Description</strong><br />
Manages quotas for API calls, data access, and other metrics, tracking usage and enforcing subscription limits with transparency.</p>
<p><strong>Why This Feature Exists</strong><br />
Controls costs and resource use, supports usage-based pricing, and helps users optimize consumption.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Monthly and daily quotas</li>
<li>Different quota categories (API calls, data points, historical data)</li>
<li>Real-time tracking and enforcement</li>
<li>Quota reset cycles and carryover policies</li>
<li>Usage notifications and warnings</li>
<li>Upgrade options and recommendations</li>
</ul>
<hr />
<h2 id="rl-003-fair-usage-policies"><a class="header" href="#rl-003-fair-usage-policies">RL-003: Fair Usage Policies</a></h2>
<p><strong>Description</strong><br />
Enforces policies preventing abuse while allowing legitimate high-volume usage via anomaly detection and automated actions.</p>
<p><strong>Why This Feature Exists</strong><br />
Protects platform from abuse, maintains quality, and reduces manual overhead through automation.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Automated abuse detection algorithms</li>
<li>Progressive enforcement (warnings, throttling, blocking)</li>
<li>Appeal and review processes</li>
<li>Whitelist for verified high-volume users</li>
<li>Usage pattern analysis and optimization</li>
<li>Violation reporting and analytics</li>
</ul>
<hr />
<h2 id="rl-004-dynamic-rate-adjustment"><a class="header" href="#rl-004-dynamic-rate-adjustment">RL-004: Dynamic Rate Adjustment</a></h2>
<p><strong>Description</strong><br />
Adjusts rate limits dynamically based on system load, user behavior, and subscription status to optimize resources and experience.</p>
<p><strong>Why This Feature Exists</strong><br />
Ensures optimal resource use and flexibility to adapt to changing conditions.</p>
<p><strong>Scope</strong></p>
<ul>
<li>System load-based rate adjustments</li>
<li>User behavior-based limit optimization</li>
<li>Predictive scaling and adjustments</li>
<li>A/B testing for rate limit strategies</li>
<li>Real-time performance monitoring</li>
<li>Automated adjustments aligned with SLA requirements</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-9"><a class="header" href="#-visual-references--diagrams-9">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635539448293&cot=14" target="_blank"> Rate Limiting &amp; Quota Management Flow </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api--data-distribution"><a class="header" href="#api--data-distribution">API &amp; Data Distribution</a></h1>
<p>This module offers comprehensive API endpoints and data distribution services, enabling developers and applications to access current, historical, and granular market data efficiently.</p>
<hr />
<h2 id="api-001-core-price-endpoints"><a class="header" href="#api-001-core-price-endpoints">API-001: Core Price Endpoints</a></h2>
<p><strong>Description</strong><br />
Provides REST API endpoints to access current and historical price data, supporting batch requests and multiple currencies.</p>
<p><strong>Why This Feature Exists</strong><br />
Price data is fundamental for crypto applications. Reliable APIs allow easy integration of accurate pricing information.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Current price endpoints for all supported assets</li>
<li>Historical price data with various timeframes</li>
<li>Batch requests for multiple assets</li>
<li>Price change calculations and statistics</li>
<li>Support for multiple currencies and conversion rates</li>
</ul>
<hr />
<h2 id="api-002-market-data-endpoints"><a class="header" href="#api-002-market-data-endpoints">API-002: Market Data Endpoints</a></h2>
<p><strong>Description</strong><br />
Delivers comprehensive market data including rankings, volume stats, market capitalization, and trending assets.</p>
<p><strong>Why This Feature Exists</strong><br />
Complete market context is necessary for informative applications that provide comparative and ranking information.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Market capitalization and rankings</li>
<li>Volume and trading statistics</li>
<li>Market performance metrics</li>
<li>Trending and notable movers</li>
<li>Market summary and overview data</li>
</ul>
<hr />
<h2 id="api-003-ohlcv-data-access"><a class="header" href="#api-003-ohlcv-data-access">API-003: OHLCV Data Access</a></h2>
<p><strong>Description</strong><br />
Provides API access to candlestick (OHLCV) data across all supported timeframes for technical analysis and charting.</p>
<p><strong>Why This Feature Exists</strong><br />
OHLCV data underpins technical analysis, charting, and backtesting, enabling sophisticated analytics.</p>
<p><strong>Scope</strong></p>
<ul>
<li>OHLCV data for all supported timeframes</li>
<li>Historical candlestick access</li>
<li>Real-time candle updates</li>
<li>Support for custom timeframes</li>
<li>Data export capabilities</li>
</ul>
<hr />
<h2 id="api-004-exchange-data-apis"><a class="header" href="#api-004-exchange-data-apis">API-004: Exchange Data APIs</a></h2>
<p><strong>Description</strong><br />
Offers APIs for exchange-specific data including prices, volumes, health, and market information.</p>
<p><strong>Why This Feature Exists</strong><br />
Exchange-specific data aids arbitrage, comparisons, and platform-specific integrations.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Exchange-specific price and volume data</li>
<li>Exchange listings and market info</li>
<li>Exchange health and status metrics</li>
<li>Historical exchange-specific data</li>
<li>Exchange comparison tools</li>
</ul>
<hr />
<h2 id="api-005-search--discovery-apis"><a class="header" href="#api-005-search--discovery-apis">API-005: Search &amp; Discovery APIs</a></h2>
<p><strong>Description</strong><br />
Provides search and discovery functionality for tokens, exchanges, and other entities with auto-complete and filtering.</p>
<p><strong>Why This Feature Exists</strong><br />
Efficient search tools help users navigate thousands of tokens and exchanges to find relevant assets.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Token search by name, symbol, or address</li>
<li>Exchange search and filtering</li>
<li>Auto-complete and suggestion APIs</li>
<li>Category and tag-based discovery</li>
<li>Popular and trending search results</li>
</ul>
<hr />
<h2 id="api-006-historical-data-bulk-export"><a class="header" href="#api-006-historical-data-bulk-export">API-006: Historical Data Bulk Export</a></h2>
<p><strong>Description</strong><br />
Enables large-scale historical data downloads for backtesting, research, and analytics, supporting multiple formats and scheduling.</p>
<p><strong>Why This Feature Exists</strong><br />
Researchers and quantitative analysts require bulk historical datasets for analysis and strategy development.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Bulk historical data export</li>
<li>Multiple formats (CSV, JSON, Parquet)</li>
<li>Compressed data delivery</li>
<li>Scheduled exports</li>
<li>Custom date range selection</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-10"><a class="header" href="#-visual-references--diagrams-10">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635976081674&cot=10" target="_blank"> API &amp; Data Distribution Architecture </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="real-time-data-streaming"><a class="header" href="#real-time-data-streaming">Real-Time Data Streaming</a></h1>
<p>This module enables low-latency streaming and notification services to deliver live market data and alerts to applications and users.</p>
<hr />
<h2 id="rt-001-websocket-api"><a class="header" href="#rt-001-websocket-api">RT-001: WebSocket API</a></h2>
<p><strong>Description</strong><br />
Provides real-time data streaming over WebSocket connections for live prices, market data, and time-sensitive updates.</p>
<p><strong>Why This Feature Exists</strong><br />
Real-time updates are critical for trading and monitoring applications. WebSocket offers an efficient, continuous data delivery mechanism.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Real-time streaming of price and market data</li>
<li>Subscription management for specific assets and markets</li>
<li>Connection authentication and authorization</li>
<li>Automatic reconnection and failover</li>
<li>Streaming rate limits and subscription quotas</li>
</ul>
<hr />
<h2 id="rt-002-push-notification-services"><a class="header" href="#rt-002-push-notification-services">RT-002: Push Notification Services</a></h2>
<p><strong>Description</strong><br />
Delivers price alerts, market events, and critical updates through multiple channels including email, SMS, and webhooks.</p>
<p><strong>Why This Feature Exists</strong><br />
Users require timely alerts on important events even when not actively monitoring the platform.</p>
<p><strong>Scope</strong></p>
<ul>
<li>Price alert notifications with customizable thresholds</li>
<li>Market event notifications (e.g., listings, delistings)</li>
<li>Multi-channel delivery (email, SMS, webhook)</li>
<li>User preferences and scheduling for notifications</li>
<li>Delivery confirmation and retry mechanisms</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-11"><a class="header" href="#-visual-references--diagrams-11">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635545563119&cot=14" target="_blank"> Real-Time Data Streaming Architecture </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compliance--security"><a class="header" href="#compliance--security">Compliance &amp; Security</a></h1>
<p>This module focuses on protecting user data, meeting regulatory requirements, and safeguarding the platform against security threats.</p>
<hr />
<h2 id="cs-001-data-privacy--gdpr-compliance"><a class="header" href="#cs-001-data-privacy--gdpr-compliance">CS-001: Data Privacy &amp; GDPR Compliance</a></h2>
<p><strong>Priority:</strong> Critical (P0)</p>
<p><strong>Description</strong><br />
Ensures compliance with data privacy laws such as GDPR, CCPA, and regional regulations, empowering users with control over their personal information.</p>
<p><strong>Why This Feature Exists</strong><br />
Legal compliance is mandatory in many regions and builds user trust by protecting privacy and reducing legal risks.</p>
<p><strong>Scope</strong></p>
<ul>
<li>User consent management</li>
<li>Data portability and export capabilities</li>
<li>Implementation of the right to be forgotten</li>
<li>Privacy policy management and consent tracking</li>
<li>Data minimization and retention policies</li>
</ul>
<hr />
<h2 id="cs-002-api-security--ddos-protection"><a class="header" href="#cs-002-api-security--ddos-protection">CS-002: API Security &amp; DDoS Protection</a></h2>
<p><strong>Description</strong><br />
Implements security measures to defend against malicious attacks, ensuring platform stability and data integrity.</p>
<p><strong>Why This Feature Exists</strong><br />
APIs are common targets for attacks; robust defenses maintain availability and protect users.</p>
<p><strong>Scope</strong></p>
<ul>
<li>DDoS detection and mitigation</li>
<li>Request filtering and validation</li>
<li>IP-based blocking and reputation management</li>
<li>Integration with threat intelligence feeds</li>
<li>Automated security incident response</li>
</ul>
<hr />
<h2 id="-visual-references--diagrams-12"><a class="header" href="#-visual-references--diagrams-12">ðŸ“Š Visual References &amp; Diagrams</a></h2>
<p><a href="https://miro.com/app/board/uXjVJbMT7pg=/?moveToWidget=3458764635547378485&cot=14" target="_blank"> Compliance &amp; Security Architecture </a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-definition-overview"><a class="header" href="#data-definition-overview">Data Definition Overview</a></h1>
<p>This document outlines the data definitions and inter-feature relationships that form the foundation of the Crypto Market Data Aggregator platform. Each section focuses on the data schema, formats, dependencies, and interactions necessary for the corresponding feature module to function correctly.</p>
<p>Understanding these definitions is critical for backend development, database modeling, API design, and analytics pipeline integration. These data structures ensure consistent, reliable, and scalable system behavior.</p>
<h2 id="-feature-modules-covered"><a class="header" href="#-feature-modules-covered">ðŸ“¦ Feature Modules Covered</a></h2>
<p>Below are the major feature modules whose data models and interdependencies are defined in this document:</p>
<ul>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./1-blockchain-data-infrastructure.html">Blockchain Data Infrastructure</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./2-centralized-exchange-cex-integration.html">Centralized Exchange (CEX) Integration</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./3-decentralized-exchange-dex-integration.html">Decentralized Exchange (DEX) Integration</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./4-price-aggregation--analytics-engine.html">Price Aggregation &amp; Analytics Engine</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./5-time-series-data-generation.html">Time-Series Data Generation</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./6-advanced-analytics-features.html">Advanced Analytics Features</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./7-api-key-management--authentication.html">API Key Management &amp; Authentication</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./12-subscription--billing-management.html">Subscription &amp; Billing Management</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./8-rate-limiting--quota-management.html">Rate Limiting &amp; Quota Management</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./9-api-data-distribution.html">API &amp; Data Distribution</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./10-real-time-data-streamin.html">Real-Time Data Streaming</a></li>
<li><a href="Crypto_Market_Data/Data_Defination_Sheet/./11-compliance--security.html">Compliance &amp; Security</a></li>
</ul>
<blockquote>
<p>ðŸ” Each section defines key data structures, field types, normalization standards, and how the entities relate to one another across modules.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="blockchain-data-infrastructure-1"><a class="header" href="#blockchain-data-infrastructure-1">Blockchain Data Infrastructure</a></h1>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<p>This document details the data models that support the platform's Blockchain Data Infrastructure features. These structures are designed to manage direct blockchain connections, real-time block processing, event extraction, and chain reorganization handling across 100+ blockchain networks. The primary purpose of these models is to ensure reliable data collection from multiple blockchain networks, maintain data accuracy during chain reorganizations, and provide comprehensive monitoring of node health and blockchain events.</p>
<hr />
<h2 id="relations-between-tables"><a class="header" href="#relations-between-tables">Relations between tables</a></h2>
<ul>
<li><strong>BlockchainNetwork &amp; Other Entities:</strong> The BlockchainNetwork table is the root of the hierarchy. It has one-to-many relationships with NodeConnection, BlockData, ChainReorganization, and ContractABI. This means a single defined network can have multiple node connections for redundancy, will produce a stream of blocks, can experience multiple reorganizations, and can have many known smart contracts.</li>
<li><strong>NodeConnection &amp; Dependent Data:</strong> The NodeConnection table has a many-to-one relationship with BlockchainNetwork, as multiple nodes are used to monitor a single network. It also has one-to-many relationships with BlockData (the specific node that fetched a block is recorded) and NodeHealthMetric (a time-series of health data is stored for each node).</li>
<li><strong>BlockData, TransactionData, &amp; EventLog:</strong> These tables form a clear hierarchy. BlockData has a one-to-many relationship with TransactionData (a block contains many transactions). TransactionData in turn has a one-to-many relationship with EventLog (a transaction can emit multiple events). For efficient querying, EventLog also maintains a direct foreign key to BlockData. All three tables link back to the BlockchainNetwork they belong to.</li>
<li><strong>ContractABI &amp; EventLog:</strong> A one-to-many relationship exists where one ContractABI record can be used to decode many events in the EventLog table. The link is established by matching the EventLog.contract_address and EventLog.network_id to the composite primary key of the ContractABI table. This is crucial for event decoding.</li>
<li><strong>ChainReorganization &amp; BlockchainNetwork:</strong> The ChainReorganization table has a many-to-one relationship with BlockchainNetwork. This allows the system to log every reorg event that occurs on a specific network, tracking the orphaned blocks and the new canonical chain for data correction purposes.</li>
</ul>
<hr />
<h2 id="blockchainnetwork"><a class="header" href="#blockchainnetwork">BlockchainNetwork</a></h2>
<p>Defines supported blockchain networks and their configuration parameters, supporting feature BC-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the blockchain network</td></tr>
<tr><td>network_name</td><td>String</td><td>Yes</td><td>e.g., &quot;Ethereum&quot;, &quot;Polygon&quot;</td><td>Human-readable network name</td></tr>
<tr><td>chain_id</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Unique chain identifier (e.g., 1 for Ethereum mainnet)</td></tr>
<tr><td>network_type</td><td>Enum</td><td>Yes</td><td>EVM, NON_EVM</td><td>Type of blockchain network</td></tr>
<tr><td>native_currency</td><td>String</td><td>Yes</td><td>e.g., &quot;ETH&quot;, &quot;BNB&quot;</td><td>Native currency symbol</td></tr>
<tr><td>block_time_seconds</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Average time between blocks</td></tr>
<tr><td>confirmation_blocks</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Blocks required for transaction confirmation</td></tr>
<tr><td>rpc_endpoints</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>List of RPC endpoint URLs</td></tr>
<tr><td>websocket_endpoints</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>List of WebSocket endpoint URLs</td></tr>
<tr><td>explorer_url</td><td>String</td><td>No</td><td>URL</td><td>Block explorer base URL</td></tr>
<tr><td>is_testnet</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this is a testnet</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether network monitoring is active</td></tr>
<tr><td>gas_token_symbol</td><td>String</td><td>No</td><td>e.g., &quot;ETH&quot;, &quot;MATIC&quot;</td><td>Symbol for gas/fee token</td></tr>
<tr><td>decimals</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Decimal places for native currency</td></tr>
<tr><td>supports_logs</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether network supports event logs</td></tr>
<tr><td>supports_trace</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether network supports transaction tracing</td></tr>
<tr><td>max_block_gas_limit</td><td>BigInt</td><td>No</td><td>Positive integer</td><td>Maximum gas limit per block</td></tr>
<tr><td>priority</td><td>Integer</td><td>Yes</td><td>1-100</td><td>Processing priority (higher = more important)</td></tr>
<tr><td>health_check_interval_seconds</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Seconds between health checks</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When network was added</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When network configuration was last updated</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>network_id</code></li>
</ul>
<hr />
<h2 id="nodeconnection"><a class="header" href="#nodeconnection">NodeConnection</a></h2>
<p>Manages individual node connections for blockchain networks, supporting features BC-001 and BC-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>connection_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the node connection</td></tr>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockchainNetwork</td></tr>
<tr><td>node_url</td><td>String</td><td>Yes</td><td>URL</td><td>Full URL of the blockchain node</td></tr>
<tr><td>connection_type</td><td>Enum</td><td>Yes</td><td>RPC_HTTP, RPC_HTTPS, WEBSOCKET, WEBSOCKET_SECURE</td><td>Type of connection</td></tr>
<tr><td>node_provider</td><td>String</td><td>No</td><td>e.g., &quot;Infura&quot;, &quot;Alchemy&quot;</td><td>Node provider name</td></tr>
<tr><td>is_primary</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this is the primary node for the network</td></tr>
<tr><td>priority</td><td>Integer</td><td>Yes</td><td>1-10</td><td>Connection priority for failover (1 = highest)</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>ACTIVE, INACTIVE, FAILED, MAINTENANCE</td><td>Current connection status</td></tr>
<tr><td>last_block_number</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Last processed block number</td></tr>
<tr><td>last_successful_request</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When last successful request was made</td></tr>
<tr><td>last_failed_request</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When last failed request occurred</td></tr>
<tr><td>consecutive_failures</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of consecutive failures</td></tr>
<tr><td>max_consecutive_failures</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Maximum failures before marking as failed</td></tr>
<tr><td>response_time_ms</td><td>Integer</td><td>No</td><td>Milliseconds</td><td>Average response time</td></tr>
<tr><td>requests_per_second_limit</td><td>Integer</td><td>No</td><td>Positive integer</td><td>Rate limit for this node</td></tr>
<tr><td>current_requests_per_second</td><td>Float</td><td>No</td><td>Non-negative float</td><td>Current request rate</td></tr>
<tr><td>health_score</td><td>Integer</td><td>Yes</td><td>0-100</td><td>Overall health score (100 = excellent)</td></tr>
<tr><td>sync_status</td><td>Enum</td><td>Yes</td><td>SYNCED, SYNCING, BEHIND, UNKNOWN</td><td>Node synchronization status</td></tr>
<tr><td>peer_count</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>Number of connected peers</td></tr>
<tr><td>is_archive_node</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether node maintains full historical data</td></tr>
<tr><td>supports_websocket</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether node supports WebSocket connections</td></tr>
<tr><td>api_key_required</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether API key is required</td></tr>
<tr><td>connection_config</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional connection configuration</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When connection was established</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When connection was last updated</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>connection_id</code></li>
<li>Foreign Key: <code>network_id</code> references <code>BlockchainNetwork.network_id</code></li>
</ul>
<hr />
<h2 id="blockdata"><a class="header" href="#blockdata">BlockData</a></h2>
<p>Stores processed block information from all blockchain networks, supporting feature BC-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>block_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the block record</td></tr>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockchainNetwork</td></tr>
<tr><td>block_number</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Block number on the blockchain</td></tr>
<tr><td>block_hash</td><td>String</td><td>Yes</td><td>Hex string</td><td>Unique hash of the block</td></tr>
<tr><td>parent_hash</td><td>String</td><td>Yes</td><td>Hex string</td><td>Hash of the parent block</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Block timestamp from blockchain</td></tr>
<tr><td>processed_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When block was processed by our system</td></tr>
<tr><td>processing_time_ms</td><td>Integer</td><td>Yes</td><td>Milliseconds</td><td>Time taken to process this block</td></tr>
<tr><td>transaction_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of transactions in block</td></tr>
<tr><td>gas_used</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Total gas used in block</td></tr>
<tr><td>gas_limit</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Gas limit for the block</td></tr>
<tr><td>base_fee_per_gas</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Base fee per gas (EIP-1559 networks)</td></tr>
<tr><td>difficulty</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Block difficulty</td></tr>
<tr><td>total_difficulty</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Total chain difficulty at this block</td></tr>
<tr><td>miner_address</td><td>String</td><td>No</td><td>Address</td><td>Address of block miner/validator</td></tr>
<tr><td>extra_data</td><td>String</td><td>No</td><td>Hex string</td><td>Additional data included in block</td></tr>
<tr><td>block_size_bytes</td><td>Integer</td><td>No</td><td>Positive integer</td><td>Size of block in bytes</td></tr>
<tr><td>uncle_count</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>Number of uncle blocks (if applicable)</td></tr>
<tr><td>is_canonical</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether block is part of canonical chain</td></tr>
<tr><td>is_processed</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether all transactions have been processed</td></tr>
<tr><td>event_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of events extracted from block</td></tr>
<tr><td>swap_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of DEX swaps in block</td></tr>
<tr><td>transfer_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of token transfers in block</td></tr>
<tr><td>reorg_detected</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this block was involved in a reorganization</td></tr>
<tr><td>confirmation_status</td><td>Enum</td><td>Yes</td><td>PENDING, CONFIRMED, FINALIZED</td><td>Block confirmation status</td></tr>
<tr><td>node_connection_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to NodeConnection that processed this block</td></tr>
<tr><td>raw_block_data</td><td>JSON</td><td>No</td><td>JSON object</td><td>Raw block data from node (for debugging)</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>block_id</code></li>
<li>Foreign Key: <code>network_id</code> references <code>BlockchainNetwork.network_id</code></li>
<li>Foreign Key: <code>node_connection_id</code> references <code>NodeConnection.connection_id</code></li>
</ul>
<hr />
<h2 id="transactiondata"><a class="header" href="#transactiondata">TransactionData</a></h2>
<p>Contains individual transaction details extracted from blocks, supporting feature BC-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>transaction_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the transaction record</td></tr>
<tr><td>block_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockData</td></tr>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockchainNetwork</td></tr>
<tr><td>transaction_hash</td><td>String</td><td>Yes</td><td>Hex string</td><td>Unique transaction hash</td></tr>
<tr><td>transaction_index</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Position of transaction in block</td></tr>
<tr><td>from_address</td><td>String</td><td>Yes</td><td>Address</td><td>Sender address</td></tr>
<tr><td>to_address</td><td>String</td><td>No</td><td>Address</td><td>Recipient address (null for contract creation)</td></tr>
<tr><td>value</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Amount transferred in native currency</td></tr>
<tr><td>gas_limit</td><td>BigInt</td><td>Yes</td><td>Positive integer</td><td>Gas limit set for transaction</td></tr>
<tr><td>gas_used</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Actual gas used</td></tr>
<tr><td>gas_price</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Gas price paid</td></tr>
<tr><td>max_fee_per_gas</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Max fee per gas (EIP-1559)</td></tr>
<tr><td>max_priority_fee_per_gas</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Max priority fee per gas (EIP-1559)</td></tr>
<tr><td>nonce</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Sender's transaction nonce</td></tr>
<tr><td>transaction_type</td><td>Integer</td><td>No</td><td>0-2</td><td>Transaction type (0=legacy, 1=EIP-2930, 2=EIP-1559)</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>SUCCESS, FAILED, PENDING</td><td>Transaction execution status</td></tr>
<tr><td>block_timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp when transaction was mined</td></tr>
<tr><td>is_contract_creation</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether transaction creates a contract</td></tr>
<tr><td>created_contract_address</td><td>String</td><td>No</td><td>Address</td><td>Address of created contract (if applicable)</td></tr>
<tr><td>input_data</td><td>Text</td><td>No</td><td>Hex string</td><td>Transaction input data</td></tr>
<tr><td>logs_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of logs generated</td></tr>
<tr><td>internal_transactions_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of internal transactions</td></tr>
<tr><td>is_dex_interaction</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether transaction interacts with DEX</td></tr>
<tr><td>swap_detected</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether transaction contains DEX swap</td></tr>
<tr><td>token_transfers_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of token transfers</td></tr>
<tr><td>error_message</td><td>Text</td><td>No</td><td>Free text</td><td>Error message if transaction failed</td></tr>
<tr><td>cumulative_gas_used</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Cumulative gas used up to this transaction</td></tr>
<tr><td>effective_gas_price</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Effective gas price paid</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>transaction_id</code></li>
<li>Foreign Key: <code>block_id</code> references <code>BlockData.block_id</code></li>
<li>Foreign Key: <code>network_id</code> references <code>BlockchainNetwork.network_id</code></li>
</ul>
<hr />
<h2 id="eventlog"><a class="header" href="#eventlog">EventLog</a></h2>
<p>Stores decoded smart contract events, particularly DEX-related events, supporting feature BC-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>event_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the event log</td></tr>
<tr><td>transaction_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to TransactionData</td></tr>
<tr><td>block_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockData</td></tr>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockchainNetwork</td></tr>
<tr><td>log_index</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Position of log within transaction</td></tr>
<tr><td>contract_address</td><td>String</td><td>Yes</td><td>Address</td><td>Address of contract that emitted the event</td></tr>
<tr><td>event_signature</td><td>String</td><td>Yes</td><td>Hex string</td><td>Keccak256 hash of event signature</td></tr>
<tr><td>event_name</td><td>String</td><td>No</td><td>e.g., &quot;Swap&quot;, &quot;Transfer&quot;</td><td>Human-readable event name</td></tr>
<tr><td>topic_0</td><td>String</td><td>Yes</td><td>Hex string</td><td>First topic (event signature)</td></tr>
<tr><td>topic_1</td><td>String</td><td>No</td><td>Hex string</td><td>Second topic (first indexed parameter)</td></tr>
<tr><td>topic_2</td><td>String</td><td>No</td><td>Hex string</td><td>Third topic (second indexed parameter)</td></tr>
<tr><td>topic_3</td><td>String</td><td>No</td><td>Hex string</td><td>Fourth topic (third indexed parameter)</td></tr>
<tr><td>data</td><td>Text</td><td>Yes</td><td>Hex string</td><td>Non-indexed event data</td></tr>
<tr><td>decoded_data</td><td>JSON</td><td>No</td><td>JSON object</td><td>Decoded event parameters</td></tr>
<tr><td>event_type</td><td>Enum</td><td>Yes</td><td>SWAP, TRANSFER, MINT, BURN, SYNC, APPROVAL, OTHER</td><td>Categorized event type</td></tr>
<tr><td>protocol_name</td><td>String</td><td>No</td><td>e.g., &quot;Uniswap V3&quot;</td><td>DEX/protocol name</td></tr>
<tr><td>protocol_version</td><td>String</td><td>No</td><td>e.g., &quot;v3&quot;</td><td>Protocol version</td></tr>
<tr><td>is_dex_event</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether event is from a DEX protocol</td></tr>
<tr><td>token_0_address</td><td>String</td><td>No</td><td>Address</td><td>First token address (for swap events)</td></tr>
<tr><td>token_1_address</td><td>String</td><td>No</td><td>Address</td><td>Second token address (for swap events)</td></tr>
<tr><td>amount_0</td><td>BigInt</td><td>No</td><td>Integer</td><td>Amount of first token</td></tr>
<tr><td>amount_1</td><td>BigInt</td><td>No</td><td>Integer</td><td>Amount of second token</td></tr>
<tr><td>sender_address</td><td>String</td><td>No</td><td>Address</td><td>Address that initiated the swap</td></tr>
<tr><td>recipient_address</td><td>String</td><td>No</td><td>Address</td><td>Address that received the output</td></tr>
<tr><td>liquidity_delta</td><td>BigInt</td><td>No</td><td>Integer</td><td>Change in liquidity (for mint/burn events)</td></tr>
<tr><td>sqrt_price_x96</td><td>BigInt</td><td>No</td><td>Integer</td><td>Square root price (for AMM events)</td></tr>
<tr><td>tick</td><td>Integer</td><td>No</td><td>Integer</td><td>Current tick (for concentrated liquidity)</td></tr>
<tr><td>fee_tier</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>Fee tier for the pool</td></tr>
<tr><td>block_timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp when event was emitted</td></tr>
<tr><td>is_removed</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether log was removed due to reorg</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>event_id</code></li>
<li>Foreign Key: <code>transaction_id</code> references <code>TransactionData.transaction_id</code></li>
<li>Foreign Key: <code>block_id</code> references <code>BlockData.block_id</code></li>
<li>Foreign Key: <code>network_id</code> references <code>BlockchainNetwork.network_id</code></li>
<li>Foreign Key: <code>(contract_address, network_id)</code> references <code>ContractABI.(contract_address, network_id)</code></li>
</ul>
<hr />
<h2 id="contractabi"><a class="header" href="#contractabi">ContractABI</a></h2>
<p>Maintains ABI information for smart contracts to enable event decoding, supporting feature BC-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>contract_address</td><td>String</td><td>Yes</td><td>Address</td><td>Contract address. Primary key</td></tr>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockchainNetwork. Part of composite key</td></tr>
<tr><td>contract_name</td><td>String</td><td>No</td><td>Free text</td><td>Human-readable contract name</td></tr>
<tr><td>abi_json</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>Complete ABI definition</td></tr>
<tr><td>abi_hash</td><td>String</td><td>Yes</td><td>Hash</td><td>SHA-256 hash of ABI JSON</td></tr>
<tr><td>is_proxy</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether contract is a proxy</td></tr>
<tr><td>implementation_address</td><td>String</td><td>No</td><td>Address</td><td>Implementation address (for proxy contracts)</td></tr>
<tr><td>proxy_type</td><td>Enum</td><td>No</td><td>EIP1967, EIP1822, TRANSPARENT, BEACON</td><td>Type of proxy pattern</td></tr>
<tr><td>verified</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether ABI is verified</td></tr>
<tr><td>verification_source</td><td>String</td><td>No</td><td>e.g., &quot;Etherscan&quot;</td><td>Source of ABI verification</td></tr>
<tr><td>protocol_category</td><td>Enum</td><td>No</td><td>DEX, LENDING, BRIDGE, NFT, DEFI, OTHER</td><td>Protocol category</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When ABI was added</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When ABI was last updated</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>(contract_address, network_id)</code></li>
<li>Foreign Key: <code>network_id</code> references <code>BlockchainNetwork.network_id</code></li>
</ul>
<hr />
<h2 id="chainreorganization"><a class="header" href="#chainreorganization">ChainReorganization</a></h2>
<p>Tracks blockchain reorganization events and their impact, supporting feature BC-005.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>reorg_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the reorganization event</td></tr>
<tr><td>network_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to BlockchainNetwork</td></tr>
<tr><td>detected_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When reorganization was detected</td></tr>
<tr><td>reorg_depth</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Number of blocks affected by reorg</td></tr>
<tr><td>old_chain_tip_hash</td><td>String</td><td>Yes</td><td>Hex string</td><td>Hash of old chain tip before reorg</td></tr>
<tr><td>new_chain_tip_hash</td><td>String</td><td>Yes</td><td>Hex string</td><td>Hash of new chain tip after reorg</td></tr>
<tr><td>fork_block_number</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Block number where chains diverged</td></tr>
<tr><td>fork_block_hash</td><td>String</td><td>Yes</td><td>Hex string</td><td>Hash of the fork point block</td></tr>
<tr><td>orphaned_blocks</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>List of orphaned block hashes</td></tr>
<tr><td>new_blocks</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>List of new canonical block hashes</td></tr>
<tr><td>affected_transactions</td><td>JSON</td><td>No</td><td>JSON array</td><td>Transactions that were invalidated</td></tr>
<tr><td>reprocessing_status</td><td>Enum</td><td>Yes</td><td>PENDING, IN_PROGRESS, COMPLETED, FAILED</td><td>Status of data reprocessing</td></tr>
<tr><td>reprocessing_started_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When reprocessing began</td></tr>
<tr><td>reprocessing_completed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When reprocessing finished</td></tr>
<tr><td>data_corrections_made</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of data corrections applied</td></tr>
<tr><td>downstream_notifications_sent</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether downstream systems were notified</td></tr>
<tr><td>severity</td><td>Enum</td><td>Yes</td><td>LOW, MEDIUM,HIGH, CRITICAL</td><td>Severity of the reorganization</td></tr>
<tr><td>impact_assessment</td><td>Text</td><td>No</td><td>Free text</td><td>Assessment of reorg impact</td></tr>
<tr><td>resolution_notes</td><td>Text</td><td>No</td><td>Free text</td><td>Notes on how reorg was handled</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>reorg_id</code></li>
<li>Foreign Key: <code>network_id</code> references <code>BlockchainNetwork.network_id</code></li>
</ul>
<hr />
<h2 id="nodehealthmetric"><a class="header" href="#nodehealthmetric">NodeHealthMetric</a></h2>
<p>Time-series data tracking node health and performance, supporting feature BC-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>connection_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to NodeConnection. Part of composite key</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When metrics were recorded. Part of composite key</td></tr>
<tr><td>is_responsive</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether node is responding to requests</td></tr>
<tr><td>response_time_ms</td><td>Integer</td><td>No</td><td>Milliseconds</td><td>Response time for health check</td></tr>
<tr><td>current_block_number</td><td>BigInt</td><td>No</td><td>Non-negative integer</td><td>Current block number reported by node</td></tr>
<tr><td>blocks_behind</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>How many blocks behind the node is</td></tr>
<tr><td>peer_count</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>Number of connected peers</td></tr>
<tr><td>sync_percentage</td><td>Float</td><td>No</td><td>0.0 - 100.0</td><td>Synchronization percentage</td></tr>
<tr><td>requests_successful</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Successful requests in measurement window</td></tr>
<tr><td>requests_failed</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Failed requests in measurement window</td></tr>
<tr><td>error_rate</td><td>Float</td><td>Yes</td><td>0.0 - 1.0</td><td>Error rate for the measurement period</td></tr>
<tr><td>cpu_usage</td><td>Float</td><td>No</td><td>0.0 - 100.0</td><td>CPU usage percentage (if available)</td></tr>
<tr><td>memory_usage</td><td>Float</td><td>No</td><td>0.0 - 100.0</td><td>Memory usage percentage (if available)</td></tr>
<tr><td>disk_usage</td><td>Float</td><td>No</td><td>0.0 - 100.0</td><td>Disk usage percentage (if available)</td></tr>
<tr><td>network_latency_ms</td><td>Integer</td><td>No</td><td>Milliseconds</td><td>Network latency to node</td></tr>
<tr><td>health_score</td><td>Integer</td><td>Yes</td><td>0-100</td><td>Calculated health score</td></tr>
</tbody></table>
</div>
<p><strong>Keys:</strong></p>
<ul>
<li>Primary Key: <code>(connection_id, timestamp)</code></li>
<li>Foreign Key: <code>connection_id</code> references <code>NodeConnection.connection_id</code></li>
</ul>
<hr />
<h2 id="summary-of-relationships"><a class="header" href="#summary-of-relationships">Summary of Relationships</a></h2>
<ul>
<li><code>BlockchainNetwork [network_id (PK)] 1 =&gt; * NodeConnection [network_id (FK)]</code></li>
<li><code>BlockchainNetwork [network_id (PK)] 1 =&gt; * BlockData [network_id (FK)]</code></li>
<li><code>BlockchainNetwork [network_id (PK)] 1 =&gt; * TransactionData [network_id (FK)]</code></li>
<li><code>BlockchainNetwork [network_id (PK)] 1 =&gt; * EventLog [network_id (FK)]</code></li>
<li><code>BlockchainNetwork [network_id (PK)] 1 =&gt; * ContractABI [network_id (FK)]</code></li>
<li><code>BlockchainNetwork [network_id (PK)] 1 =&gt; * ChainReorganization [network_id (FK)]</code></li>
<li><code>NodeConnection [connection_id (PK)] 1 =&gt; * BlockData [node_connection_id (FK)]</code></li>
<li><code>NodeConnection [connection_id (PK)] 1 =&gt; * NodeHealthMetric [connection_id (FK)]</code></li>
<li><code>BlockData [block_id (PK)] 1 =&gt; * TransactionData [block_id (FK)]</code></li>
<li><code>BlockData [block_id (PK)] 1 =&gt; * EventLog [block_id (FK)]</code></li>
<li><code>TransactionData [transaction_id (PK)] 1 =&gt; * EventLog [transaction_id (FK)]</code></li>
<li><code>ContractABI [contract_address, network_id (PK)] 1 =&gt; * EventLog [contract_address, network_id (FK)]</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="centralized-exchange-cex-integration-1"><a class="header" href="#centralized-exchange-cex-integration-1">Centralized Exchange (CEX) Integration</a></h1>
<h2 id="overview-2"><a class="header" href="#overview-2">Overview</a></h2>
<p>This document outlines the data structures required for the Centralized Exchange (CEX) Integration feature. It includes:</p>
<ul>
<li>Exchange-specific configurations</li>
<li>Real-time price feeds</li>
<li>Historical trade data</li>
<li>Exchange health monitoring</li>
<li>API rate limit management</li>
</ul>
<p>These models enable market data aggregation from over 100 CEXs.</p>
<hr />
<h2 id="entity-relationships"><a class="header" href="#entity-relationships">Entity Relationships</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Relationship</th><th>Cardinality</th><th>Description</th></tr></thead><tbody>
<tr><td>Exchange â†” ApiKey</td><td>1 â†’ *</td><td>Each exchange can have multiple API keys.</td></tr>
<tr><td>Exchange â†” Ticker</td><td>1 â†’ *</td><td>Each exchange has many ticker entries per market pair.</td></tr>
<tr><td>Exchange â†” Trade</td><td>1 â†’ *</td><td>Each exchange produces many trades over time.</td></tr>
<tr><td>Exchange â†” ExchangeHealthLog</td><td>1 â†’ *</td><td>Each exchange has many health logs.</td></tr>
<tr><td>Exchange â†” RateLimitStatus</td><td>1 â†’ *</td><td>Each exchange has multiple rate limit status entries.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-exchange"><a class="header" href="#-exchange">ðŸ“„ Exchange</a></h2>
<blockquote>
<p>Stores configuration for each connected exchange (supports <code>CEX-001</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>exchange_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier.</td></tr>
<tr><td>name</td><td>String</td><td>Yes</td><td>e.g., &quot;Binance&quot;</td><td>Name of the exchange.</td></tr>
<tr><td>api_base_url</td><td>String</td><td>Yes</td><td>URL</td><td>Base REST API URL.</td></tr>
<tr><td>websocket_url</td><td>String</td><td>No</td><td>URL</td><td>WebSocket feed URL.</td></tr>
<tr><td>documentation_url</td><td>String</td><td>No</td><td>URL</td><td>Official API documentation.</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true / false</td><td>Enables or disables data collection.</td></tr>
<tr><td>config_params</td><td>JSON</td><td>No</td><td>JSON object</td><td>Exchange-specific config.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Record creation time.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Last config update.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-apikey"><a class="header" href="#-apikey">ðŸ“„ ApiKey</a></h2>
<blockquote>
<p>Stores credentials for API access.</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>key_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique API key ID.</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Exchange</code>.</td></tr>
<tr><td>api_key</td><td>String</td><td>Yes</td><td>Encrypted String</td><td>Public key.</td></tr>
<tr><td>secret_key</td><td>String</td><td>Yes</td><td>Encrypted String</td><td>Secret key for signing.</td></tr>
<tr><td>passphrase</td><td>String</td><td>No</td><td>Encrypted String</td><td>Optional passphrase.</td></tr>
<tr><td>auth_method</td><td>Enum</td><td>Yes</td><td>API_KEY, OAUTH</td><td>Authentication method.</td></tr>
<tr><td>permissions</td><td>JSON</td><td>No</td><td>[&quot;read&quot;, &quot;trade&quot;]</td><td>Permissions list.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Creation time.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-ticker"><a class="header" href="#-ticker">ðŸ“„ Ticker</a></h2>
<blockquote>
<p>Stores real-time price data (supports <code>CEX-002</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>BigInt</td><td>Yes</td><td>Auto-incrementing</td><td>Unique ticker update ID.</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Exchange</code>.</td></tr>
<tr><td>pair_symbol</td><td>String</td><td>Yes</td><td>e.g., &quot;BTC/USDT&quot;</td><td>Trading pair symbol.</td></tr>
<tr><td>last_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Last traded price.</td></tr>
<tr><td>bid_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Best price to sell.</td></tr>
<tr><td>ask_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Best price to buy.</td></tr>
<tr><td>base_volume_24h</td><td>Decimal(36,18)</td><td>No</td><td>Numeric</td><td>24h base volume.</td></tr>
<tr><td>quote_volume_24h</td><td>Decimal(36,18)</td><td>No</td><td>Numeric</td><td>24h quote volume.</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601 (with ms)</td><td>Time price update was received.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-trade"><a class="header" href="#-trade">ðŸ“„ Trade</a></h2>
<blockquote>
<p>Stores all executed trades (supports <code>CEX-003</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>trade_id</td><td>String</td><td>Yes</td><td>Exchange-specific ID</td><td>Unique trade ID from exchange.</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Exchange</code>.</td></tr>
<tr><td>pair_symbol</td><td>String</td><td>Yes</td><td>e.g., &quot;BTC/USDT&quot;</td><td>Trading pair.</td></tr>
<tr><td>price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Trade price.</td></tr>
<tr><td>volume</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Amount traded.</td></tr>
<tr><td>side</td><td>Enum</td><td>Yes</td><td>BUY / SELL</td><td>Trade direction.</td></tr>
<tr><td>executed_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601 (with ms)</td><td>Trade execution time.</td></tr>
<tr><td>logged_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Time trade was logged in system.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-exchangehealthlog"><a class="header" href="#-exchangehealthlog">ðŸ“„ ExchangeHealthLog</a></h2>
<blockquote>
<p>Logs exchange API health status (supports <code>CEX-004</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>log_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique health log ID.</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Exchange</code>.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>UP, DOWN, DEGRADED</td><td>Operational state.</td></tr>
<tr><td>response_time_ms</td><td>Integer</td><td>No</td><td>ms</td><td>API average response time.</td></tr>
<tr><td>error_rate_percent</td><td>Float</td><td>No</td><td>0.0 - 100.0</td><td>Error rate percentage.</td></tr>
<tr><td>data_quality_score</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Score for data completeness.</td></tr>
<tr><td>details</td><td>Text</td><td>No</td><td>Free text</td><td>Additional notes (e.g., error details).</td></tr>
<tr><td>checked_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Health check timestamp.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-ratelimitstatus"><a class="header" href="#-ratelimitstatus">ðŸ“„ RateLimitStatus</a></h2>
<blockquote>
<p>Tracks API usage against rate limits (supports <code>CEX-005</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>BigInt</td><td>Yes</td><td>Auto-incrementing</td><td>Unique entry ID.</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Exchange</code>.</td></tr>
<tr><td>endpoint_group</td><td>String</td><td>Yes</td><td>e.g., &quot;Public&quot;</td><td>API endpoint group.</td></tr>
<tr><td>request_count</td><td>Integer</td><td>Yes</td><td>Numeric</td><td>Requests made in current window.</td></tr>
<tr><td>limit_per_window</td><td>Integer</td><td>Yes</td><td>Numeric</td><td>Allowed max per window.</td></tr>
<tr><td>window_seconds</td><td>Integer</td><td>Yes</td><td>Seconds</td><td>Length of rate limit window.</td></tr>
<tr><td>reset_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Time window resets.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Last updated.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-relationships-summary"><a class="header" href="#-relationships-summary">ðŸ”— Relationships Summary</a></h2>
<pre><code class="language-text">Exchange [exchange_id (PK)]
 â”œâ”€â”€ 1 â†’ * ApiKey              [key_id (PK), exchange_id (FK)]
 â”œâ”€â”€ 1 â†’ * Ticker              [id (PK), exchange_id (FK)]
 â”œâ”€â”€ 1 â†’ * Trade               [trade_id (PK), exchange_id (FK)]
 â”œâ”€â”€ 1 â†’ * ExchangeHealthLog   [log_id (PK), exchange_id (FK)]
 â””â”€â”€ 1 â†’ * RateLimitStatus     [id (PK), exchange_id (FK)]

ApiKey [key_id (PK)]
 â””â”€â”€ * â†’ 1 Exchange            [exchange_id (FK)]

Ticker [id (PK)]
 â””â”€â”€ * â†’ 1 Exchange            [exchange_id (FK)]

Trade [trade_id (PK)]
 â””â”€â”€ * â†’ 1 Exchange            [exchange_id (FK)]

ExchangeHealthLog [log_id (PK)]
 â””â”€â”€ * â†’ 1 Exchange            [exchange_id (FK)]

RateLimitStatus [id (PK)]
 â””â”€â”€ * â†’ 1 Exchange            [exchange_id (FK)]
</code></pre>
<h2 id="-entities-summary"><a class="header" href="#-entities-summary">ðŸ“Œ Entities Summary</a></h2>
<pre><code class="language-text">Entity              Primary Key    Foreign Keys
------------------------------------------------------------
Exchange            exchange_id    â€”
ApiKey              key_id         exchange_id â†’ Exchange.exchange_id
Ticker              id             exchange_id â†’ Exchange.exchange_id
Trade               trade_id       exchange_id â†’ Exchange.exchange_id
ExchangeHealthLog   log_id         exchange_id â†’ Exchange.exchange_id
RateLimitStatus     id             exchange_id â†’ Exchange.exchange_id
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="decentralized-exchange-dex-integration-1"><a class="header" href="#decentralized-exchange-dex-integration-1">Decentralized Exchange (DEX) Integration</a></h1>
<h2 id="overview-3"><a class="header" href="#overview-3">Overview</a></h2>
<p>This document specifies the data models required to support the platform's Decentralized Exchange (DEX) Integration features. The design focuses on:</p>
<ul>
<li>Comprehensive protocol coverage</li>
<li>Automated discovery of liquidity pools</li>
<li>Accurate price calculations</li>
</ul>
<p>These models handle the diverse and dynamic nature of DeFi, storing data on blockchains, DEX protocols, liquidity pools, and their real-time states.</p>
<hr />
<h2 id="entity-relationships-1"><a class="header" href="#entity-relationships-1">Entity Relationships</a></h2>
<p>The following relationships logically separate static protocol configurations from dynamic, high-frequency market data:</p>
<h3 id="blockchain--dexprotocol"><a class="header" href="#blockchain--dexprotocol"><code>Blockchain</code> â‡„ <code>DexProtocol</code></a></h3>
<ul>
<li><strong>Cardinality:</strong> One-to-Many (1 â†’ *)</li>
<li><strong>Description:</strong> Each blockchain (e.g., Ethereum) can host multiple DEX protocols (e.g., Uniswap V3, Curve). Each DEX protocol is tied to a single blockchain.</li>
</ul>
<hr />
<h3 id="dexprotocol--liquiditypool"><a class="header" href="#dexprotocol--liquiditypool"><code>DexProtocol</code> â‡„ <code>LiquidityPool</code></a></h3>
<ul>
<li><strong>Cardinality:</strong> One-to-Many (1 â†’ *)</li>
<li><strong>Description:</strong> A DEX protocol consists of many liquidity pools. Each pool represents a trading pair and is uniquely associated with a protocol.</li>
</ul>
<hr />
<h3 id="liquiditypool--poolstate"><a class="header" href="#liquiditypool--poolstate"><code>LiquidityPool</code> â‡„ <code>PoolState</code></a></h3>
<ul>
<li><strong>Cardinality:</strong> One-to-One (1 â†’ 1)</li>
<li><strong>Description:</strong>
<ul>
<li><code>LiquidityPool</code> stores static market data (e.g., tokens, fee tier).</li>
<li><code>PoolState</code> stores dynamic, frequently updated data (e.g., reserves, current tick).</li>
</ul>
</li>
</ul>
<hr />
<h3 id="liquiditypool--dexswap"><a class="header" href="#liquiditypool--dexswap"><code>LiquidityPool</code> â‡„ <code>DexSwap</code></a></h3>
<ul>
<li><strong>Cardinality:</strong> One-to-Many (1 â†’ *)</li>
<li><strong>Description:</strong> A liquidity pool handles many swaps. Each swap is a unique entry in the <code>DexSwap</code> table, allowing complete historical trade tracking.</li>
</ul>
<hr />
<h2 id="tables--fields"><a class="header" href="#tables--fields">Tables &amp; Fields</a></h2>
<h3 id="-blockchain"><a class="header" href="#-blockchain">ðŸ§± Blockchain</a></h3>
<p>Master list of supported blockchain networks.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>chain_id</code></td><td>Integer</td><td>Yes</td><td>e.g., 1, 137</td><td>Unique numeric ID of the blockchain. <strong>(PK)</strong></td></tr>
<tr><td><code>name</code></td><td>String</td><td>Yes</td><td>e.g., &quot;Ethereum&quot;</td><td>Common name of the blockchain</td></tr>
<tr><td><code>symbol</code></td><td>String</td><td>Yes</td><td>e.g., &quot;ETH&quot;</td><td>Native currency symbol</td></tr>
<tr><td><code>rpc_url</code></td><td>String</td><td>Yes</td><td>URL</td><td>JSON-RPC endpoint</td></tr>
<tr><td><code>explorer_url</code></td><td>String</td><td>Yes</td><td>URL</td><td>Base URL of the block explorer</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-dexprotocol"><a class="header" href="#-dexprotocol">ðŸ§± DexProtocol</a></h3>
<p>DEX protocol configurations and metadata.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>protocol_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>Internal DEX protocol ID <strong>(PK)</strong></td></tr>
<tr><td><code>chain_id</code></td><td>Integer</td><td>Yes</td><td>Numeric</td><td>FK to <code>Blockchain.chain_id</code></td></tr>
<tr><td><code>name</code></td><td>String</td><td>Yes</td><td>e.g., &quot;Uniswap V3&quot;</td><td>DEX name</td></tr>
<tr><td><code>version</code></td><td>String</td><td>No</td><td>e.g., &quot;3.0&quot;</td><td>Protocol version</td></tr>
<tr><td><code>factory_address</code></td><td>String</td><td>Yes</td><td>Hex Address</td><td>Address of the protocolâ€™s factory smart contract</td></tr>
<tr><td><code>amm_type</code></td><td>Enum</td><td>Yes</td><td>AMM Type Enum</td><td>Type of AMM (e.g., CONSTANT_PRODUCT, STABLESWAP)</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-liquiditypool"><a class="header" href="#-liquiditypool">ðŸ§± LiquidityPool</a></h3>
<p>Registry of all liquidity pools discovered.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>Internal ID for the pool <strong>(PK)</strong></td></tr>
<tr><td><code>protocol_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>DexProtocol.protocol_id</code></td></tr>
<tr><td><code>pool_address</code></td><td>String</td><td>Yes</td><td>Hex Address</td><td>Address of pool smart contract</td></tr>
<tr><td><code>token0_asset_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Asset.asset_id</code> (token0)</td></tr>
<tr><td><code>token1_asset_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Asset.asset_id</code> (token1)</td></tr>
<tr><td><code>fee_tier</code></td><td>Decimal(5,4)</td><td>No</td><td>Numeric</td><td>Swap fee percentage (e.g., 0.0030 = 0.3%)</td></tr>
<tr><td><code>status</code></td><td>Enum</td><td>Yes</td><td>ACTIVE/UNVERIFIED</td><td>Pool verification status</td></tr>
<tr><td><code>creation_block</code></td><td>BigInt</td><td>Yes</td><td>Numeric</td><td>Block number when the pool was created</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-poolstate"><a class="header" href="#-poolstate">ðŸ§± PoolState</a></h3>
<p>Real-time state of a liquidity pool.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>LiquidityPool.pool_id</code> <strong>(PK)</strong></td></tr>
<tr><td><code>reserve0</code></td><td>String</td><td>Yes</td><td>BigInt</td><td>Total reserve of token0</td></tr>
<tr><td><code>reserve1</code></td><td>String</td><td>Yes</td><td>BigInt</td><td>Total reserve of token1</td></tr>
<tr><td><code>total_liquidity</code></td><td>String</td><td>No</td><td>BigInt</td><td>Total liquidity (optional for some AMMs)</td></tr>
<tr><td><code>current_tick</code></td><td>Integer</td><td>No</td><td>Numeric</td><td>Current tick for concentrated liquidity AMMs</td></tr>
<tr><td><code>last_updated_at</code></td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Time of last update</td></tr>
<tr><td><code>last_updated_block</code></td><td>BigInt</td><td>Yes</td><td>Numeric</td><td>Block number of last update</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-dexswap"><a class="header" href="#-dexswap">ðŸ§± DexSwap</a></h3>
<p>Logs of every swap executed in pools.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tx_hash</code></td><td>String</td><td>Yes</td><td>Hex String</td><td>On-chain transaction hash <strong>(PK)</strong></td></tr>
<tr><td><code>pool_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>LiquidityPool.pool_id</code></td></tr>
<tr><td><code>block_number</code></td><td>BigInt</td><td>Yes</td><td>Numeric</td><td>Block number of the swap</td></tr>
<tr><td><code>trader_address</code></td><td>String</td><td>Yes</td><td>Hex Address</td><td>Address of swap initiator</td></tr>
<tr><td><code>amount_in</code></td><td>String</td><td>Yes</td><td>BigInt</td><td>Input token amount</td></tr>
<tr><td><code>amount_out</code></td><td>String</td><td>Yes</td><td>BigInt</td><td>Output token amount</td></tr>
<tr><td><code>token_in_asset_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Asset.asset_id</code> (input token)</td></tr>
<tr><td><code>token_out_asset_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to <code>Asset.asset_id</code> (output token)</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="relationships-summary"><a class="header" href="#relationships-summary">Relationships Summary</a></h2>
<pre><code class="language-text">Blockchain [chain_id (PK)]
 â””â”€â”€ 1 â†’ * DexProtocol [protocol_id (PK), chain_id (FK)]

DexProtocol [protocol_id (PK)]
 â””â”€â”€ 1 â†’ * LiquidityPool [pool_id (PK), protocol_id (FK)]

Asset [asset_id (PK)]
 â”œâ”€â”€ 1 â†’ * LiquidityPool [token0_asset_id (FK)]
 â””â”€â”€ 1 â†’ * LiquidityPool [token1_asset_id (FK)]

LiquidityPool [pool_id (PK)]
 â”œâ”€â”€ 1 â†’ 1 PoolState [pool_id (PK, FK)]
 â””â”€â”€ 1 â†’ * DexSwap [tx_hash (PK), pool_id (FK)]

Asset [asset_id (PK)]
 â”œâ”€â”€ 1 â†’ * DexSwap [token_in_asset_id (FK)]
 â””â”€â”€ 1 â†’ * DexSwap [token_out_asset_id (FK)]
</code></pre>
<h2 id="erd-summary"><a class="header" href="#erd-summary">ERD Summary</a></h2>
<h3 id="-blockchain-1"><a class="header" href="#-blockchain-1">ðŸ“¦ Blockchain</a></h3>
<ul>
<li><code>chain_id</code> â€” <strong>Primary Key (PK)</strong></li>
</ul>
<hr />
<h3 id="-dexprotocol-1"><a class="header" href="#-dexprotocol-1">ðŸ“¦ DexProtocol</a></h3>
<ul>
<li><code>protocol_id</code> â€” <strong>Primary Key (PK)</strong></li>
<li><code>chain_id</code> â€” <strong>Foreign Key (FK â†’ Blockchain.chain_id)</strong></li>
</ul>
<hr />
<h3 id="-liquiditypool-1"><a class="header" href="#-liquiditypool-1">ðŸ“¦ LiquidityPool</a></h3>
<ul>
<li><code>pool_id</code> â€” <strong>Primary Key (PK)</strong></li>
<li><code>protocol_id</code> â€” <strong>Foreign Key (FK â†’ DexProtocol.protocol_id)</strong></li>
<li><code>token0_asset_id</code> â€” <strong>Foreign Key (FK â†’ Asset.asset_id)</strong></li>
<li><code>token1_asset_id</code> â€” <strong>Foreign Key (FK â†’ Asset.asset_id)</strong></li>
</ul>
<hr />
<h3 id="-poolstate-1"><a class="header" href="#-poolstate-1">ðŸ“¦ PoolState</a></h3>
<ul>
<li><code>pool_id</code> â€” <strong>Primary Key (PK), Foreign Key (FK â†’ LiquidityPool.pool_id)</strong></li>
</ul>
<hr />
<h3 id="-dexswap-1"><a class="header" href="#-dexswap-1">ðŸ“¦ DexSwap</a></h3>
<ul>
<li><code>tx_hash</code> â€” <strong>Primary Key (PK)</strong></li>
<li><code>pool_id</code> â€” <strong>Foreign Key (FK â†’ LiquidityPool.pool_id)</strong></li>
<li><code>token_in_asset_id</code> â€” <strong>Foreign Key (FK â†’ Asset.asset_id)</strong></li>
<li><code>token_out_asset_id</code> â€” <strong>Foreign Key (FK â†’ Asset.asset_id)</strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="price-aggregation--analytics-engine-1"><a class="header" href="#price-aggregation--analytics-engine-1">Price Aggregation &amp; Analytics Engine</a></h1>
<h3 id="overview-4"><a class="header" href="#overview-4">Overview</a></h3>
<p>This document specifies the data models required for the platform's advanced Price Aggregation &amp; Analytics Engine. These structures are designed to support the calculation and storage of authoritative consensus prices, dynamic source weightings, analytical benchmarks like VWAP, and the auditable filtering of price outliers. The goal is to transform raw data from hundreds of CEX and DEX sources into reliable, high-quality market intelligence.</p>
<h3 id="aggregatedprice"><a class="header" href="#aggregatedprice">AggregatedPrice</a></h3>
<p>Stores the final, authoritative consensus price and fair value estimations for each asset, supporting features PA-001 and PA-007.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>asset_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to the Asset table. Part of the composite primary key.</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The time for which this price is valid. Part of the composite primary key.</td></tr>
<tr><td>price_type</td><td>Enum</td><td>Yes</td><td>CONSENSUS, FAIR_VALUE</td><td>The type of price calculation. Part of the composite primary key.</td></tr>
<tr><td>price_usd</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The calculated authoritative price in USD.</td></tr>
<tr><td>confidence_score</td><td>Float</td><td>Yes</td><td>0.0 - 1.0</td><td>A score indicating the system's confidence in the accuracy of the calculated price.</td></tr>
<tr><td>contributing_sources</td><td>Integer</td><td>Yes</td><td>Numeric</td><td>The number of individual data sources used in this calculation.</td></tr>
<tr><td>metadata</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional details, e.g., confidence intervals or factors used in fair value calculation.</td></tr>
</tbody></table>
</div>
<h3 id="sourceweight"><a class="header" href="#sourceweight">SourceWeight</a></h3>
<p>Stores the dynamically calculated weight for each trading venue, used to determine its influence on the consensus price, supporting PA-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>source_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>The ID of the source (e.g., CEX market_id or DEX pool_id). Part of a composite key.</td></tr>
<tr><td>source_type</td><td>Enum</td><td>Yes</td><td>CEX_MARKET, DEX_POOL</td><td>The type of the data source. Part of a composite key.</td></tr>
<tr><td>calculated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The timestamp when this weight was calculated. Part of a composite key.</td></tr>
<tr><td>weight</td><td>Float</td><td>Yes</td><td>0.0 - 1.0</td><td>The final calculated weight for the source, representing its overall influence.</td></tr>
<tr><td>volume_score</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Component score based on the source's relative trading volume.</td></tr>
<tr><td>reliability_score</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Component score based on the source's historical uptime and data quality.</td></tr>
<tr><td>details</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional metrics that contributed to the final weight.</td></tr>
</tbody></table>
</div>
<h3 id="priceoutlierlog"><a class="header" href="#priceoutlierlog">PriceOutlierLog</a></h3>
<p>An audit trail for the outlier detection algorithm, logging all filtered or flagged price points, supporting PA-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>log_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the log entry.</td></tr>
<tr><td>source_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>The ID of the source that produced the outlier (e.g., market_id or pool_id).</td></tr>
<tr><td>source_type</td><td>Enum</td><td>Yes</td><td>CEX_MARKET, DEX_POOL</td><td>The type of the data source.</td></tr>
<tr><td>outlier_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The anomalous price that was detected.</td></tr>
<tr><td>consensus_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The market consensus price at the time of detection for comparison.</td></tr>
<tr><td>deviation_percent</td><td>Float</td><td>Yes</td><td>Numeric</td><td>The percentage deviation of the outlier from the consensus price.</td></tr>
<tr><td>action_taken</td><td>Enum</td><td>Yes</td><td>FILTERED, FLAGGED</td><td>The action taken by the system (e.g., excluded from calculation or just flagged).</td></tr>
<tr><td>detected_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The time the outlier was detected.</td></tr>
</tbody></table>
</div>
<h3 id="calculatedbenchmark"><a class="header" href="#calculatedbenchmark">CalculatedBenchmark</a></h3>
<p>Stores the results of VWAP and TWAP calculations, supporting PA-006.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>asset_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to the Asset table. Part of the composite primary key.</td></tr>
<tr><td>benchmark_type</td><td>Enum</td><td>Yes</td><td>VWAP, TWAP</td><td>The type of benchmark calculated. Part of the composite primary key.</td></tr>
<tr><td>start_time</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The beginning of the time window for the calculation. Part of the composite primary key.</td></tr>
<tr><td>end_time</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The end of the time window for the calculation.</td></tr>
<tr><td>value</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The calculated value of the benchmark (e.g., the VWAP price).</td></tr>
<tr><td>total_volume</td><td>Decimal(36,18)</td><td>No</td><td>Numeric</td><td>The total volume during the window, primarily for VWAP.</td></tr>
</tbody></table>
</div>
<h3 id="relations-between-tables-1"><a class="header" href="#relations-between-tables-1">Relations between Tables</a></h3>
<ul>
<li><strong>AggregatedPrice table:</strong> This is a primary output table, storing the final consensus and fair value prices for each asset. It is the result of aggregating data from numerous sources, weighted by the SourceWeight table.</li>
<li><strong>SourceWeight table:</strong> This table stores a dynamically calculated &quot;trust score&quot; or weight for every individual data source (e.g., a specific market on a CEX or a liquidity pool on a DEX). These weights are a key input for the consensus price calculation in the AggregatedPrice table.</li>
<li><strong>PriceOutlierLog table:</strong> This table acts as an audit trail, recording every time a price point from a source is flagged or filtered out by the outlier detection algorithm. It provides transparency into the data cleansing process.</li>
<li><strong>CalculatedBenchmark table:</strong> This table stores the results of complex analytical calculations, such as VWAP and TWAP, for each asset over various timeframes. It provides standardized benchmarks for traders and analysts.</li>
</ul>
<h3 id="entities--relationships"><a class="header" href="#entities--relationships">Entities &amp; Relationships</a></h3>
<ul>
<li><strong>AggregatedPrice</strong>
<ul>
<li>asset_id (PK, FK â†’ Asset.asset_id)</li>
<li>timestamp (PK)</li>
<li>price_type (PK)</li>
</ul>
</li>
<li><strong>SourceWeight</strong>
<ul>
<li>source_id (PK)</li>
<li>source_type (PK)</li>
<li>calculated_at (PK)</li>
</ul>
</li>
<li><strong>PriceOutlierLog</strong>
<ul>
<li>log_id (PK)</li>
</ul>
</li>
<li><strong>CalculatedBenchmark</strong>
<ul>
<li>asset_id (PK, FK â†’ Asset.asset_id)</li>
<li>benchmark_type (PK)</li>
<li>start_time (PK)</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="time-series-data-generation-1"><a class="header" href="#time-series-data-generation-1">Time-Series Data Generation</a></h1>
<h3 id="overview-5"><a class="header" href="#overview-5">Overview</a></h3>
<p>This document outlines the data models required to support the platform's Time-Series Data Generation engine. These structures are designed to store standardized OHLCV data, detailed volume analytics, and definitions for custom client aggregations. The models also include mechanisms for tracking data quality and the application of interpolation to ensure the integrity and completeness of all time-series data.</p>
<h3 id="relations-between-tables-2"><a class="header" href="#relations-between-tables-2">Relations between Tables</a></h3>
<ul>
<li><strong>Ohlcv table</strong>: The primary table for storing standardized candlestick data. It is populated by the time-series engine and serves as the foundation for most technical analysis. It includes a field to distinguish between real and interpolated data.</li>
<li><strong>AggregatedVolume table</strong>: This table provides a more granular view of trading volume, breaking it down by source (CEX market or DEX pool) and other dimensions. It supports detailed volume analysis that goes beyond the total volume in the Ohlcv table.</li>
<li><strong>CustomAggregationDefinition table</strong>: Belongs to a User (or an institutional client account). It stores the parameters for non-standard timeframes, allowing clients to save and reuse their custom aggregation rules.</li>
<li><strong>TimeSeriesLog table</strong>: An audit log that records significant events related to the time-series generation process, such as data quality validation failures or the application of interpolation algorithms.</li>
</ul>
<h3 id="ohlcv-revised"><a class="header" href="#ohlcv-revised">Ohlcv (Revised)</a></h3>
<p>Stores aggregated Open, High, Low, Close, and Volume (candlestick) data for a specific market, supporting TS-001. This is a revised version of the previously defined table.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>market_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to the CEX Market or a similar identifier for a globally aggregated asset. Part of the composite primary key.</td></tr>
<tr><td>timeframe</td><td>String</td><td>Yes</td><td>e.g., &quot;1h&quot;, &quot;1d&quot;</td><td>The timeframe for the candle. Part of the composite primary key.</td></tr>
<tr><td>open_time</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The start time of the candle. Part of the composite primary key.</td></tr>
<tr><td>open_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The price at the start of the timeframe.</td></tr>
<tr><td>high_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The highest price during the timeframe.</td></tr>
<tr><td>low_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The lowest price during the timeframe.</td></tr>
<tr><td>close_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The price at the end of the timeframe.</td></tr>
<tr><td>volume</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The total volume traded during the timeframe.</td></tr>
<tr><td>data_source_type</td><td>Enum</td><td>Yes</td><td>REAL, INTERPOLATED</td><td>Indicates if the candle data is from real trades or filled by an interpolation algorithm (TS-008).</td></tr>
</tbody></table>
</div>
<h3 id="aggregatedvolume"><a class="header" href="#aggregatedvolume">AggregatedVolume</a></h3>
<p>Stores detailed volume breakdowns by source and time period, supporting the Volume Analysis feature (TS-003).</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>source_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>The ID of the source (e.g., CEX market_id or DEX pool_id). Part of the composite primary key.</td></tr>
<tr><td>source_type</td><td>Enum</td><td>Yes</td><td>CEX_MARKET, DEX_POOL</td><td>The type of the data source. Part of the composite primary key.</td></tr>
<tr><td>timeframe</td><td>String</td><td>Yes</td><td>e.g., &quot;1h&quot;, &quot;1d&quot;</td><td>The aggregation timeframe. Part of the composite primary key.</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The start time of the aggregation window. Part of the composite primary key.</td></tr>
<tr><td>total_volume</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>The total volume traded in quote currency.</td></tr>
<tr><td>buy_volume</td><td>Decimal(36,18)</td><td>No</td><td>Numeric</td><td>The portion of total volume attributed to buy-side trades.</td></tr>
<tr><td>sell_volume</td><td>Decimal(36,18)</td><td>No</td><td>Numeric</td><td>The portion of total volume attributed to sell-side trades.</td></tr>
<tr><td>trade_count</td><td>Integer</td><td>No</td><td>Numeric</td><td>The total number of trades during the period.</td></tr>
<tr><td>data_source_type</td><td>Enum</td><td>Yes</td><td>REAL, INTERPOLATED</td><td>Indicates if the volume data is from real trades or interpolated (TS-008).</td></tr>
</tbody></table>
</div>
<h3 id="customaggregationdefinition"><a class="header" href="#customaggregationdefinition">CustomAggregationDefinition</a></h3>
<p>Stores client-defined parameters for custom aggregation windows, supporting TS-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>definition_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the custom definition.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to the User or client account that owns this definition.</td></tr>
<tr><td>definition_name</td><td>String</td><td>Yes</td><td>Free text</td><td>A user-friendly name for the custom window (e.g., &quot;My Weekly Report Window&quot;).</td></tr>
<tr><td>window_seconds</td><td>Integer</td><td>Yes</td><td>Seconds</td><td>The size of the aggregation window in seconds.</td></tr>
<tr><td>aggregation_rules</td><td>JSON</td><td>No</td><td>JSON object</td><td>Advanced rules for the aggregation, such as custom filters or calculations.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp when the definition was created.</td></tr>
</tbody></table>
</div>
<h3 id="timeserieslog"><a class="header" href="#timeserieslog">TimeSeriesLog</a></h3>
<p>An audit trail for events related to time-series data generation and quality control (TS-001, TS-008).</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>log_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the log entry.</td></tr>
<tr><td>event_type</td><td>Enum</td><td>Yes</td><td>INTERPOLATION_APPLIED, VALIDATION_FAIL</td><td>The type of event that occurred.</td></tr>
<tr><td>target_table</td><td>String</td><td>Yes</td><td>e.g., &quot;Ohlcv&quot;</td><td>The name of the table where the event occurred.</td></tr>
<tr><td>target_key</td><td>JSON</td><td>Yes</td><td>JSON object</td><td>A JSON representation of the primary key of the affected record.</td></tr>
<tr><td>details</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional details about the event, such as the interpolation method used or the reason for validation failure.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The time the log entry was created.</td></tr>
</tbody></table>
</div>
<h3 id="relationships"><a class="header" href="#relationships">Relationships</a></h3>
<ul>
<li>Market [market_id (PK)] 1 =&gt; * Ohlcv [market_id (FK)]</li>
<li>The AggregatedVolume table has a conceptual polymorphic link to the CEX Market and DEX LiquidityPool tables via its source_id and source_type fields.</li>
<li>User [user_id (PK)] 1 =&gt; * CustomAggregationDefinition [definition_id (PK), user_id (FK)]</li>
</ul>
<h3 id="entities--relationships-1"><a class="header" href="#entities--relationships-1">Entities &amp; Relationships</a></h3>
<ul>
<li><strong>Ohlcv</strong>
<ul>
<li>market_id (PK, FK)</li>
<li>timeframe (PK)</li>
<li>open_time (PK)</li>
</ul>
</li>
<li><strong>AggregatedVolume</strong>
<ul>
<li>source_id (PK)</li>
<li>source_type (PK)</li>
<li>timeframe (PK)</li>
<li>timestamp (PK)</li>
</ul>
</li>
<li><strong>CustomAggregationDefinition</strong>
<ul>
<li>definition_id (PK)</li>
<li>user_id (FK â†’ User.user_id)</li>
</ul>
</li>
<li><strong>TimeSeriesLog</strong>
<ul>
<li>log_id (PK)</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="price-aggregation--analytics-engine-2"><a class="header" href="#price-aggregation--analytics-engine-2">Price Aggregation &amp; Analytics Engine</a></h1>
<h2 id="overview-6"><a class="header" href="#overview-6">Overview</a></h2>
<p>This document details the data models that support the platform's <strong>Advanced Analytics Features</strong>. These structures are designed to store the sophisticated outputs generated by analytical engines, including:</p>
<ul>
<li>Token security scores</li>
<li>Liquidity health metrics</li>
<li>Asset volatility calculations</li>
</ul>
<p>The primary purpose of these models is to <strong>persist and serve these complex analytical results efficiently</strong> to end-users.</p>
<hr />
<h2 id="table-relationships"><a class="header" href="#table-relationships">Table Relationships</a></h2>
<ul>
<li><strong>AssetSecurityScore</strong>: One-to-one with the <code>Asset</code> table.</li>
<li><strong>PoolHealthMetric</strong>: Many-to-one with the <code>LiquidityPool</code> table (time-series).</li>
<li><strong>AssetVolatility</strong>: Many-to-one with the <code>Asset</code> table (time-series).</li>
</ul>
<hr />
<h2 id="-entity-assetsecurityscore"><a class="header" href="#-entity-assetsecurityscore">ðŸ“˜ Entity: <code>AssetSecurityScore</code></a></h2>
<p>Stores the results of the automated smart contract analysis for each token.<br />
<strong>Supports Feature:</strong> <code>AA-001</code></p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>asset_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to <code>Asset</code>. Also the Primary Key.</td></tr>
<tr><td><code>overall_score</code></td><td>Integer</td><td>Yes</td><td>0 - 100</td><td>Consolidated safety score (100 = most secure).</td></tr>
<tr><td><code>risk_level</code></td><td>Enum</td><td>Yes</td><td>LOW, MEDIUM, HIGH, CRITICAL</td><td>Categorical risk assessment.</td></tr>
<tr><td><code>check_results</code></td><td>JSON</td><td>Yes</td><td>JSON object</td><td>Detailed results from individual security checks.</td></tr>
<tr><td><code>summary</code></td><td>Text</td><td>No</td><td>Free text</td><td>Human-readable summary of key findings and risks.</td></tr>
<tr><td><code>last_scanned_at</code></td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp of last successful security scan.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-entity-poolhealthmetric"><a class="header" href="#-entity-poolhealthmetric">ðŸ“˜ Entity: <code>PoolHealthMetric</code></a></h2>
<p>Stores time-series data on the health and stability of DEX liquidity pools.<br />
<strong>Supports Feature:</strong> <code>AA-002</code></p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to <code>LiquidityPool</code>. Part of composite PK.</td></tr>
<tr><td><code>timestamp</code></td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Time of metric calculation. Part of composite PK.</td></tr>
<tr><td><code>health_score</code></td><td>Integer</td><td>Yes</td><td>0 - 100</td><td>Overall pool health score.</td></tr>
<tr><td><code>concentration_score</code></td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Liquidity concentration score (1.0 = highly concentrated).</td></tr>
<tr><td><code>sustainability_metric</code></td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Long-term sustainability score.</td></tr>
<tr><td><code>details</code></td><td>JSON</td><td>No</td><td>JSON object</td><td>Other metrics like turnover or impermanent loss.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-entity-assetvolatility"><a class="header" href="#-entity-assetvolatility">ðŸ“˜ Entity: <code>AssetVolatility</code></a></h2>
<p>Stores historical and real-time asset volatility metrics.<br />
<strong>Supports Feature:</strong> <code>AA-006</code></p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td><code>asset_id</code></td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to <code>Asset</code>. Part of composite PK.</td></tr>
<tr><td><code>timestamp</code></td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>&quot;As of&quot; time. Part of composite PK.</td></tr>
<tr><td><code>timeframe</code></td><td>String</td><td>Yes</td><td>e.g. &quot;30d&quot;</td><td>Lookback period. Part of composite PK.</td></tr>
<tr><td><code>volatility_type</code></td><td>Enum</td><td>Yes</td><td>HISTORICAL</td><td>Type of volatility. Part of composite PK.</td></tr>
<tr><td><code>value</code></td><td>Float</td><td>Yes</td><td>Numeric</td><td>Annualized volatility value (e.g., 0.85 = 85%).</td></tr>
<tr><td><code>model</code></td><td>String</td><td>Yes</td><td>e.g. &quot;GARCH&quot;</td><td>Statistical model used for calculation (e.g., &quot;Standard Deviation&quot;).</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-relationships"><a class="header" href="#-relationships">ðŸ”— Relationships</a></h2>
<pre><code class="language-plaintext">Asset [asset_id (PK)]
 â”œâ”€â”€ 1 â†’ 1 AssetSecurityScore     [asset_id (PK, FK)]
 â””â”€â”€ 1 â†’ * AssetVolatility        [asset_id (FK)]

LiquidityPool [pool_id (PK)]
 â””â”€â”€ 1 â†’ * PoolHealthMetric       [pool_id (FK)]

 ## ðŸ“ Entities &amp; Relationships Summary

### ðŸ”¸ AssetSecurityScore

- `asset_id`
  â†’ **Primary Key**
  â†’ **Foreign Key â†’ Asset.asset_id**

---

### ðŸ”¸ PoolHealthMetric

- `pool_id`
  â†’ **Primary Key**
  â†’ **Foreign Key â†’ LiquidityPool.pool_id**

- `timestamp`
  â†’ **Primary Key**

---

### ðŸ”¸ AssetVolatility

- `asset_id`
  â†’ **Primary Key**
  â†’ **Foreign Key â†’ Asset.asset_id**

- `timestamp`
  â†’ **Primary Key**

- `timeframe`
  â†’ **Primary Key**

- `volatility_type`
  â†’ **Primary Key**

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api-key-management--authentication-1"><a class="header" href="#api-key-management--authentication-1">API Key Management &amp; Authentication</a></h1>
<h2 id="overview-7"><a class="header" href="#overview-7">Overview</a></h2>
<p>This document specifies the data models required for the platform's API Key Management and Authentication features. It outlines the structures for managing user-facing API keys, defining granular permissions, logging access requests, and securing internal service-to-service communication. These tables form the backbone for secure, controlled, and auditable access to all platform services.</p>
<h2 id="entity-relationships-2"><a class="header" href="#entity-relationships-2">Entity Relationships</a></h2>
<p>This section provides a detailed explanation of the relationships between the data entities that constitute the API Key Management and Permissions system.</p>
<h3 id="user--apikey"><a class="header" href="#user--apikey">User &lt;=&gt; ApiKey</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: This is a core relationship where a single User can generate and manage multiple ApiKey records. Each key is distinctly owned by one user, creating a clear line of accountability. This allows users to create separate keys for different applications (e.g., one for a mobile widget, another for a trading bot), each with its own lifecycle and permissions, while all being tied back to the master user account. The link is established through a user_id foreign key in the ApiKey table.</li>
</ul>
<h3 id="apikey--permissionset"><a class="header" href="#apikey--permissionset">ApiKey &lt;=&gt; PermissionSet</a></h3>
<ul>
<li><strong>Cardinality</strong>: Many-to-One (* to 1)</li>
<li><strong>Description</strong>: Each ApiKey must be assigned exactly one PermissionSet. This relationship dictates the scope of actions the key is authorized to perform. Multiple API keys, even those belonging to different users, can be assigned the same PermissionSet (e.g., many keys can use the system's &quot;Read-Only&quot; set). This model allows for the efficient reuse of permission configurations and simplifies auditing.</li>
</ul>
<h3 id="permissionset--permission-via-permissionset_mapping"><a class="header" href="#permissionset--permission-via-permissionset_mapping">PermissionSet &lt;=&gt; Permission (via PermissionSet_Mapping)</a></h3>
<ul>
<li><strong>Cardinality</strong>: Many-to-Many (_ to _)</li>
<li><strong>Description</strong>: This relationship defines the granular composition of a permission set. A single PermissionSet can include a collection of many individual Permission records. Conversely, a single Permission (like read_price_feeds) can be a component of multiple different PermissionSets. This many-to-many link is implemented via the PermissionSet_Mapping junction table, which contains pairs of permission_set_id and permission_id, providing maximum flexibility in defining access control policies.</li>
</ul>
<h3 id="user--permissionset"><a class="header" href="#user--permissionset">User &lt;=&gt; PermissionSet</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: Users have the ability to create their own custom PermissionSet records. This is a one-to-many relationship where a User can be the author of multiple permission sets, but each custom set is owned by only one user. System-defined sets (e.g., &quot;Full Access,&quot; &quot;Read-Only&quot;) would not be linked to a specific user, allowing for a clear distinction between global templates and user-specific configurations.</li>
</ul>
<h3 id="apikey--apirequestlog"><a class="header" href="#apikey--apirequestlog">ApiKey &lt;=&gt; ApiRequestLog</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: This relationship is essential for security auditing and usage monitoring. A single ApiKey will be used to authenticate numerous requests over its lifetime, resulting in a large number of entries in the ApiRequestLog table. Each log entry is tied to exactly one ApiKey, providing a comprehensive and non-repudiable trail of every action attempted or performed with that key.</li>
</ul>
<h3 id="internalservice"><a class="header" href="#internalservice">InternalService</a></h3>
<ul>
<li><strong>Description</strong>: The InternalService table is a distinct entity designed for machine-to-machine (M2M) authentication within the platform's microservices architecture. While it serves a similar purpose to ApiKey (authentication and authorization), it is decoupled from the user-centric tables. It manages credentials for backend services, ensuring that inter-service communication is secure and authenticated independently of user sessions or user-generated API keys.</li>
</ul>
<h2 id="data-models"><a class="header" href="#data-models">Data Models</a></h2>
<h3 id="apikey"><a class="header" href="#apikey">ApiKey</a></h3>
<p>Stores user-generated API keys and their associated configurations, supporting features AK-001, AK-002, and AK-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>api_key_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the API key.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>permission_set_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the PermissionSet table.</td></tr>
<tr><td>label</td><td>String</td><td>Yes</td><td>Free text, max 100 chars</td><td>A user-defined name for easy identification (e.g., &quot;My Trading Bot&quot;).</td></tr>
<tr><td>key_prefix</td><td>String</td><td>Yes</td><td>e.g., &quot;CDAP_&quot;...</td><td>A short, non-sensitive prefix of the key used for lookup.</td></tr>
<tr><td>hashed_key</td><td>String</td><td>Yes</td><td>Hashed String</td><td>The securely hashed API key. The full key is only shown to the user once upon creation.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>ACTIVE, REVOKED</td><td>The current status of the key.</td></tr>
<tr><td>ip_whitelist</td><td>JSON</td><td>No</td><td>Array of IP/CIDR</td><td>An array of allowed IP addresses or CIDR blocks for this key. Null or empty means any IP is allowed.</td></tr>
<tr><td>expires_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp when this key will automatically expire. Null for non-expiring keys.</td></tr>
<tr><td>last_used_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>Timestamp of the last successful use of this key.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp when the key was created.</td></tr>
</tbody></table>
</div>
<h3 id="permission"><a class="header" href="#permission">Permission</a></h3>
<p>A master catalog of all granular permissions available on the platform, supporting AK-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>permission_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the permission.</td></tr>
<tr><td>scope_name</td><td>String</td><td>Yes</td><td>e.g., &quot;data:read:trades&quot;</td><td>The unique, machine-readable name for the permission scope.</td></tr>
<tr><td>description</td><td>String</td><td>Yes</td><td>Free text</td><td>A human-readable description of what the permission allows.</td></tr>
</tbody></table>
</div>
<h3 id="permissionset"><a class="header" href="#permissionset">PermissionSet</a></h3>
<p>Stores reusable templates or sets of permissions, supporting AK-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>permission_set_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the permission set.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>No</td><td>UUID</td><td>Foreign key to the User table if it's a user-defined set. Null for system-defined sets.</td></tr>
<tr><td>set_name</td><td>String</td><td>Yes</td><td>e.g., &quot;Read-Only Access&quot;</td><td>The name of the permission set.</td></tr>
<tr><td>is_system_defined</td><td>Boolean</td><td>Yes</td><td>True / False</td><td>True if this is a default set provided by the platform.</td></tr>
<tr><td>description</td><td>String</td><td>No</td><td>Free text</td><td>A brief description of the permission set's purpose.</td></tr>
</tbody></table>
</div>
<h3 id="permissionset_mapping"><a class="header" href="#permissionset_mapping">PermissionSet_Mapping</a></h3>
<p>A pivot table to create the many-to-many relationship between PermissionSet and Permission.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>permission_set_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the PermissionSet table.</td></tr>
<tr><td>permission_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the Permission table.</td></tr>
</tbody></table>
</div>
<h3 id="apirequestlog"><a class="header" href="#apirequestlog">ApiRequestLog</a></h3>
<p>Logs all incoming API requests for auditing, security, and usage tracking, supporting AK-001 and AK-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>log_id</td><td>BigInt</td><td>Yes</td><td>Auto-incrementing</td><td>Unique identifier for the log entry.</td></tr>
<tr><td>api_key_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the ApiKey used for the request.</td></tr>
<tr><td>ip_address</td><td>String</td><td>Yes</td><td>IP Address</td><td>The source IP address of the request.</td></tr>
<tr><td>endpoint</td><td>String</td><td>Yes</td><td>e.g., &quot;/v1/trades/BTC-USD&quot;</td><td>The API endpoint that was accessed.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>SUCCESS, FAIL_KEY, FAIL_PERM</td><td>The outcome of the authentication/authorization check.</td></tr>
<tr><td>user_agent</td><td>String</td><td>No</td><td>User-Agent string</td><td>The User-Agent header from the request.</td></tr>
<tr><td>request_timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The timestamp when the request was received.</td></tr>
</tbody></table>
</div>
<h3 id="internalservice-1"><a class="header" href="#internalservice-1">InternalService</a></h3>
<p>Stores authentication information for internal, service-to-service communication, supporting AK-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>service_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the internal service.</td></tr>
<tr><td>service_name</td><td>String</td><td>Yes</td><td>e.g., &quot;price-aggregator&quot;</td><td>The unique, machine-readable name of the internal service.</td></tr>
<tr><td>auth_type</td><td>Enum</td><td>Yes</td><td>JWT, MTLS</td><td>The authentication method used by the service.</td></tr>
<tr><td>credentials</td><td>JSON</td><td>Yes</td><td>Encrypted JSON</td><td>Securely stored credentials, such as client IDs, secrets for JWTs, or certificate info for mTLS.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>ACTIVE, DECOMMISSIONED</td><td>The operational status of the service's credentials.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp when the service credentials were created.</td></tr>
</tbody></table>
</div>
<h2 id="relationships-1"><a class="header" href="#relationships-1">Relationships</a></h2>
<ul>
<li><strong>User [user_id (PK)] 1 =&gt; * ApiKey [api_key_id (PK), user_id (FK)]</strong></li>
<li><strong>User [user_id (PK)] 1 =&gt; * PermissionSet [permission_set_id (PK), user_id (FK)]</strong></li>
<li><strong>PermissionSet [permission_set_id (PK)] 1 =&gt; * PermissionSet_Mapping</strong></li>
<li><strong>Permission [permission_id (PK)] 1 =&gt; * PermissionSet_Mapping</strong></li>
<li><strong>PermissionSet [permission_set_id (PK)] 1 =&gt; * ApiKey [api_key_id (PK), permission_set_id (FK)]</strong></li>
<li><strong>ApiKey [api_key_id (PK)] 1 =&gt; * ApiRequestLog [log_id (PK), api_key_id (FK)]</strong></li>
</ul>
<h2 id="entities--relationships-2"><a class="header" href="#entities--relationships-2">Entities &amp; Relationships</a></h2>
<ul>
<li><strong>User</strong>
<ul>
<li>user_id (PK)</li>
</ul>
</li>
<li><strong>Permission</strong>
<ul>
<li>permission_id (PK)</li>
</ul>
</li>
<li><strong>PermissionSet</strong>
<ul>
<li>permission_set_id (PK)</li>
<li>user_id (FK â†’ User.user_id)</li>
</ul>
</li>
<li><strong>PermissionSet_Mapping</strong>
<ul>
<li>permission_set_id (PK, FK â†’ PermissionSet.permission_set_id)</li>
<li>permission_id (PK, FK â†’ Permission.permission_id)</li>
</ul>
</li>
<li><strong>ApiKey</strong>
<ul>
<li>api_key_id (PK)</li>
<li>user_id (FK â†’ User.user_id)</li>
<li>permission_set_id (FK â†’ PermissionSet.permission_set_id)</li>
</ul>
</li>
<li><strong>ApiRequestLog</strong>
<ul>
<li>log_id (PK)</li>
<li>api_key_id (FK â†’ ApiKey.api_key_id)</li>
</ul>
</li>
<li><strong>InternalService</strong>
<ul>
<li>service_id (PK)</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription--billing-management-data-specification"><a class="header" href="#subscription--billing-management-data-specification">Subscription &amp; Billing Management Data Specification</a></h1>
<h2 id="overview-8"><a class="header" href="#overview-8">Overview</a></h2>
<p>This document details the data models that support the platform's Subscription &amp; Billing Management features. These structures are designed to store subscription tier definitions, payment processing information, usage tracking metrics, enterprise contract management data, and a complete invoicing system. The primary purpose of these models is to enable flexible subscription management, accurate and auditable billing, and comprehensive usage monitoring for diverse user segments from individual developers to enterprise clients.</p>
<hr />
<h2 id="relations-between-tables-3"><a class="header" href="#relations-between-tables-3">Relations between Tables</a></h2>
<ul>
<li><strong>SubscriptionTier</strong>: Defines the available subscription plans and their associated limits and features. It serves as a master template for what each subscription entails.</li>
<li><strong>UserSubscription</strong>: Links a User to a SubscriptionTier and tracks the subscription's lifecycle. It has a many-to-one relationship with SubscriptionTier and a one-to-one relationship with User. This table has been updated to include a direct link to the specific PaymentMethod to be used for renewals.</li>
<li><strong>PaymentMethod</strong>: Stores user payment information for automated billing. It has a many-to-one relationship with User, allowing multiple payment methods per user.</li>
<li><strong>Invoice (New)</strong>: Represents a bill issued to a user for a specific billing period. It aggregates charges from subscriptions and usage overages. It has a many-to-one relationship with User.</li>
<li><strong>InvoiceLineItem (New)</strong>: Details the specific charges on an invoice, such as the base subscription fee or usage overage costs. It has a many-to-one relationship with the Invoice table.</li>
<li><strong>UsageMetric</strong>: A time-series table that tracks all billable activities. It has a many-to-one relationship with User. Overage metrics can now be linked directly to the Invoice on which they were billed.</li>
<li><strong>EnterpriseContract</strong>: Stores bespoke contract terms for enterprise clients. It has a one-to-one relationship with User for enterprise accounts.</li>
</ul>
<hr />
<h2 id="subscriptiontier"><a class="header" href="#subscriptiontier">SubscriptionTier</a></h2>
<p>Defines available subscription tiers with their features, limits, and pricing, supporting feature SB-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>tier_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the subscription tier.</td></tr>
<tr><td>tier_name</td><td>String</td><td>Yes</td><td>e.g., &quot;Free&quot;, &quot;Professional&quot;</td><td>Human-readable name of the subscription tier.</td></tr>
<tr><td>tier_level</td><td>Integer</td><td>Yes</td><td>0-100</td><td>Numeric level for tier comparison (0=Free, 100=Enterprise).</td></tr>
<tr><td>monthly_price</td><td>Decimal</td><td>Yes</td><td>Currency format</td><td>Monthly subscription price in USD.</td></tr>
<tr><td>annual_price</td><td>Decimal</td><td>No</td><td>Currency format</td><td>Annual subscription price in USD (if applicable).</td></tr>
<tr><td>api_rate_limit</td><td>Integer</td><td>Yes</td><td>Requests per minute</td><td>Maximum API requests allowed per minute.</td></tr>
<tr><td>daily_quota</td><td>Integer</td><td>Yes</td><td>Number</td><td>Maximum API calls allowed per day.</td></tr>
<tr><td>historical_data_days</td><td>Integer</td><td>Yes</td><td>Days</td><td>Number of days of historical data access allowed.</td></tr>
<tr><td>support_level</td><td>Enum</td><td>Yes</td><td>COMMUNITY, EMAIL, PRIORITY, DEDICATED</td><td>Level of customer support provided.</td></tr>
<tr><td>features</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>List of enabled features or capabilities.</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this tier is currently available.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this tier was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this tier was last modified.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="usersubscription"><a class="header" href="#usersubscription">UserSubscription</a></h2>
<p>Tracks user subscription status and lifecycle. This table has been modified to link directly to a payment method for renewals, supporting features SB-001 and SB-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>subscription_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to User.</td></tr>
<tr><td>tier_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to SubscriptionTier.</td></tr>
<tr><td>payment_method_id</td><td>UUID</td><td>No</td><td>UUID</td><td>FK to PaymentMethod.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>TRIAL, ACTIVE, CANCELLED, SUSPENDED, EXPIRED</td><td>Current subscription status.</td></tr>
<tr><td>start_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Start date.</td></tr>
<tr><td>end_date</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>End date (null if ongoing).</td></tr>
<tr><td>trial_end_date</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>End of trial period.</td></tr>
<tr><td>billing_cycle</td><td>Enum</td><td>Yes</td><td>MONTHLY, ANNUAL</td><td>Billing frequency.</td></tr>
<tr><td>auto_renew</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether auto-renews.</td></tr>
<tr><td>cancellation_reason</td><td>String</td><td>No</td><td>Free text</td><td>Reason for cancellation.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Creation time.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Last update.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="paymentmethod"><a class="header" href="#paymentmethod">PaymentMethod</a></h2>
<p>Stores user payment information for automated billing, supporting feature SB-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>payment_method_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to User.</td></tr>
<tr><td>provider</td><td>Enum</td><td>Yes</td><td>STRIPE, PAYPAL, BANK_TRANSFER, CRYPTO</td><td>Payment provider.</td></tr>
<tr><td>provider_payment_id</td><td>String</td><td>Yes</td><td>Provider-specific</td><td>External provider ID.</td></tr>
<tr><td>method_type</td><td>Enum</td><td>Yes</td><td>CREDIT_CARD, DEBIT_CARD, BANK_ACCOUNT, CRYPTO_WALLET</td><td>Method type.</td></tr>
<tr><td>last_four_digits</td><td>String</td><td>No</td><td>4 digits</td><td>Display-only card/account suffix.</td></tr>
<tr><td>expiry_month</td><td>Integer</td><td>No</td><td>1-12</td><td>Expiry month.</td></tr>
<tr><td>expiry_year</td><td>Integer</td><td>No</td><td>YYYY</td><td>Expiry year.</td></tr>
<tr><td>is_default</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Default method?</td></tr>
<tr><td>is_verified</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Verified status.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Created at.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Updated at.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="invoice"><a class="header" href="#invoice">Invoice</a></h2>
<p>Represents a single, auditable bill issued to a user for a specific billing period.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>invoice_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to User.</td></tr>
<tr><td>subscription_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to UserSubscription.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>DRAFT, OPEN, PAID, VOID, UNCOLLECTIBLE</td><td>Invoice status.</td></tr>
<tr><td>issue_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Issue date.</td></tr>
<tr><td>due_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Due date.</td></tr>
<tr><td>paid_date</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>Paid date.</td></tr>
<tr><td>billing_period_start</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Billing period start.</td></tr>
<tr><td>billing_period_end</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Billing period end.</td></tr>
<tr><td>total_amount</td><td>Decimal</td><td>Yes</td><td>Currency</td><td>Amount due.</td></tr>
<tr><td>currency</td><td>String</td><td>Yes</td><td>e.g., USD</td><td>Invoice currency.</td></tr>
<tr><td>invoice_pdf_url</td><td>String</td><td>No</td><td>URL</td><td>Link to invoice PDF.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="invoicelineitem"><a class="header" href="#invoicelineitem">InvoiceLineItem</a></h2>
<p>Detailed breakdown of charges on a specific invoice.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>line_item_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key.</td></tr>
<tr><td>invoice_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to Invoice.</td></tr>
<tr><td>description</td><td>String</td><td>Yes</td><td>Free text</td><td>Charge description.</td></tr>
<tr><td>quantity</td><td>Integer</td><td>Yes</td><td>Positive</td><td>Quantity.</td></tr>
<tr><td>unit_price</td><td>Decimal</td><td>Yes</td><td>Currency</td><td>Price per unit.</td></tr>
<tr><td>total_amount</td><td>Decimal</td><td>Yes</td><td>Currency</td><td>Total (quantity Ã— unit price).</td></tr>
<tr><td>service_period_start</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Service start.</td></tr>
<tr><td>service_period_end</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Service end.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="usagemetric"><a class="header" href="#usagemetric">UsageMetric</a></h2>
<p>Time-series table tracking API usage and billable activities. Modified to link overages to a specific invoice, supporting feature SB-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to User (PK).</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When usage occurred (PK).</td></tr>
<tr><td>metric_type</td><td>Enum</td><td>Yes</td><td>API_CALL, DATA_POINTS, HISTORICAL_REQUESTS</td><td>Usage type (PK).</td></tr>
<tr><td>invoice_id</td><td>UUID</td><td>No</td><td>UUID</td><td>FK to Invoice.</td></tr>
<tr><td>endpoint</td><td>String</td><td>No</td><td>API Path</td><td>Called endpoint.</td></tr>
<tr><td>count</td><td>Integer</td><td>Yes</td><td>Positive</td><td>Units consumed.</td></tr>
<tr><td>billable_units</td><td>Integer</td><td>Yes</td><td>Positive</td><td>Billable units.</td></tr>
<tr><td>overage</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Was it over quota?</td></tr>
<tr><td>metadata</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional usage context.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="enterprisecontract"><a class="header" href="#enterprisecontract">EnterpriseContract</a></h2>
<p>Stores custom enterprise contract terms and SLAs, supporting feature SB-005.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>contract_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>FK to User.</td></tr>
<tr><td>contract_name</td><td>String</td><td>Yes</td><td>Free text</td><td>Contract name.</td></tr>
<tr><td>start_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Start date.</td></tr>
<tr><td>end_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>End date.</td></tr>
<tr><td>monthly_fee</td><td>Decimal</td><td>Yes</td><td>Currency</td><td>Fixed monthly fee.</td></tr>
<tr><td>volume_tiers</td><td>JSON</td><td>No</td><td>JSON array</td><td>Volume discounts.</td></tr>
<tr><td>sla_uptime</td><td>Float</td><td>Yes</td><td>0.0 - 1.0</td><td>Uptime guarantee.</td></tr>
<tr><td>sla_response_time</td><td>Integer</td><td>Yes</td><td>Milliseconds</td><td>Response time SLA.</td></tr>
<tr><td>custom_features</td><td>JSON</td><td>No</td><td>JSON array</td><td>Custom features.</td></tr>
<tr><td>support_level</td><td>String</td><td>Yes</td><td>Free text</td><td>Support description.</td></tr>
<tr><td>account_manager</td><td>String</td><td>No</td><td>Free text</td><td>Assigned manager.</td></tr>
<tr><td>renewal_terms</td><td>Text</td><td>No</td><td>Free text</td><td>Renewal conditions.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>DRAFT, ACTIVE, EXPIRED, TERMINATED</td><td>Contract status.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Created at.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Last modified.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="relationships-2"><a class="header" href="#relationships-2">Relationships</a></h2>
<h2 id="relationships-3"><a class="header" href="#relationships-3">Relationships</a></h2>
<ul>
<li><code>User [user_id (PK)]</code> 1 â†’ 1 <code>UserSubscription [user_id (FK)]</code></li>
<li><code>SubscriptionTier [tier_id (PK)]</code> 1 â†’ * <code>UserSubscription [tier_id (FK)]</code></li>
<li><code>User [user_id (PK)]</code> 1 â†’ * <code>PaymentMethod [user_id (FK)]</code></li>
<li><code>UserSubscription [subscription_id (PK)]</code> 1 â†’ ? <code>PaymentMethod [payment_method_id (FK)]</code></li>
<li><code>User [user_id (PK)]</code> 1 â†’ * <code>Invoice [user_id (FK)]</code></li>
<li><code>Invoice [invoice_id (PK)]</code> 1 â†’ * <code>InvoiceLineItem [invoice_id (FK)]</code></li>
<li><code>User [user_id (PK)]</code> 1 â†’ * <code>UsageMetric [user_id (FK)]</code></li>
<li><code>Invoice [invoice_id (PK)]</code> 1 â†’ * <code>UsageMetric [invoice_id (FK)]</code></li>
<li><code>User [user_id (PK)]</code> 1 â†’ 1 <code>EnterpriseContract [user_id (FK)]</code></li>
</ul>
<hr />
<h2 id="entities--relationships-summary"><a class="header" href="#entities--relationships-summary">Entities &amp; Relationships Summary</a></h2>
<ul>
<li><strong>SubscriptionTier</strong>
<ul>
<li><code>tier_id (PK)</code></li>
</ul>
</li>
<li><strong>UserSubscription</strong>
<ul>
<li><code>subscription_id (PK)</code></li>
<li><code>user_id (FK â†’ User.user_id)</code></li>
<li><code>tier_id (FK â†’ SubscriptionTier.tier_id)</code></li>
<li><code>payment_method_id (FK â†’ PaymentMethod.payment_method_id)</code></li>
</ul>
</li>
<li><strong>PaymentMethod</strong>
<ul>
<li><code>payment_method_id (PK)</code></li>
<li><code>user_id (FK â†’ User.user_id)</code></li>
</ul>
</li>
<li><strong>Invoice</strong>
<ul>
<li><code>invoice_id (PK)</code></li>
<li><code>user_id (FK â†’ User.user_id)</code></li>
<li><code>subscription_id (FK â†’ UserSubscription.subscription_id)</code></li>
</ul>
</li>
<li><strong>InvoiceLineItem</strong>
<ul>
<li><code>line_item_id (PK)</code></li>
<li><code>invoice_id (FK â†’ Invoice.invoice_id)</code></li>
</ul>
</li>
<li><strong>UsageMetric</strong>
<ul>
<li><code>user_id (PK, FK â†’ User.user_id)</code></li>
<li><code>timestamp (PK)</code></li>
<li><code>metric_type (PK)</code></li>
<li><code>invoice_id (FK â†’ Invoice.invoice_id)</code></li>
</ul>
</li>
<li><strong>EnterpriseContract</strong>
<ul>
<li><code>contract_id (PK)</code></li>
<li><code>user_id (FK â†’ User.user_id)</code></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rate-limiting--quota-management-1"><a class="header" href="#rate-limiting--quota-management-1">Rate Limiting &amp; Quota Management</a></h1>
<h2 id="overview-9"><a class="header" href="#overview-9">Overview</a></h2>
<p>This document details the data models that support the platform's Rate Limiting &amp; Quota Management features. These structures are designed to store rate limiting configurations, usage quotas, fair usage policies, and dynamic adjustment parameters. The primary purpose of these models is to ensure fair resource allocation, prevent system abuse, maintain optimal performance, and provide predictable service levels across different subscription tiers.</p>
<h2 id="relations-between-tables-4"><a class="header" href="#relations-between-tables-4">Relations between Tables</a></h2>
<h3 id="ratelimitconfig--subscriptiontier"><a class="header" href="#ratelimitconfig--subscriptiontier">RateLimitConfig &amp; SubscriptionTier</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: A single SubscriptionTier (e.g., &quot;Professional&quot;) serves as a parent for multiple RateLimitConfig records. This allows for defining granular rules for each tier, such as a global request limit, a more stringent limit for computationally expensive endpoints, and a burst allowance, providing flexible and powerful control over API access.</li>
</ul>
<h3 id="userquota--user"><a class="header" href="#userquota--user">UserQuota &amp; User</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: Tracks a user's consumption against their allowances. Each User has multiple UserQuota records, with each record tracking a specific metric (like API_CALLS) over a specific period (DAILY or MONTHLY). This structure is essential for enforcing the limits defined in the user's subscription tier and for triggering usage-based billing or notifications.</li>
</ul>
<h3 id="ratelimitviolation--user"><a class="header" href="#ratelimitviolation--user">RateLimitViolation &amp; User</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: Every time a user's request is denied due to exceeding a rate limit or quota, a new entry is created in the RateLimitViolation table. This provides a complete historical trail of a user's infraction history, which is critical for abuse detection, automated enforcement escalation, and customer support.</li>
</ul>
<h3 id="fairusagepolicy--subscriptiontier"><a class="header" href="#fairusagepolicy--subscriptiontier">FairUsagePolicy &amp; SubscriptionTier</a></h3>
<ul>
<li><strong>Cardinality</strong>: Many-to-One (* to 1)</li>
<li><strong>Description</strong>: Allows for defining different standards of &quot;fair use.&quot; A policy can be global (where tier_id is null) or linked to a specific SubscriptionTier. This gives the platform the flexibility to enforce stricter behavioral rules on free tiers compared to high-paying enterprise clients.</li>
</ul>
<h3 id="dynamicrateadjustment--ratelimitconfig"><a class="header" href="#dynamicrateadjustment--ratelimitconfig">DynamicRateAdjustment &amp; RateLimitConfig</a></h3>
<ul>
<li><strong>Cardinality</strong>: One-to-Many (1 to *)</li>
<li><strong>Description</strong>: Provides a historical record of system-initiated changes. A single, static RateLimitConfig rule may be temporarily altered due to system load or other real-time conditions. Each such alteration is logged as a DynamicRateAdjustment record, ensuring full transparency into how and why service levels were modified.</li>
</ul>
<h3 id="userwhitelist-user--fairusagepolicy"><a class="header" href="#userwhitelist-user--fairusagepolicy">UserWhitelist, User, &amp; FairUsagePolicy</a></h3>
<ul>
<li><strong>Cardinality</strong>: Many-to-Many (_ to _)</li>
<li><strong>Description</strong>: The UserWhitelist table acts as a bridge, allowing specific, trusted Users to be granted full or partial exemptions from automated restrictions defined in a FairUsagePolicy, accommodating legitimate high-volume use cases.</li>
</ul>
<h2 id="data-models-1"><a class="header" href="#data-models-1">Data Models</a></h2>
<h3 id="ratelimitconfig"><a class="header" href="#ratelimitconfig">RateLimitConfig</a></h3>
<p>Defines rate limiting rules for different subscription tiers and endpoints, supporting feature RL-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>config_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the rate limit configuration.</td></tr>
<tr><td>tier_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the SubscriptionTier table.</td></tr>
<tr><td>endpoint_pattern</td><td>String</td><td>No</td><td>e.g., &quot;/api/v1/prices/*&quot;</td><td>Specific endpoint or pattern (null for global limits).</td></tr>
<tr><td>limit_type</td><td>Enum</td><td>Yes</td><td>PER_MINUTE, PER_HOUR, PER_DAY</td><td>Time window for the rate limit.</td></tr>
<tr><td>request_limit</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Maximum requests allowed in the time window.</td></tr>
<tr><td>burst_limit</td><td>Integer</td><td>No</td><td>Positive integer</td><td>Additional requests allowed for short bursts.</td></tr>
<tr><td>burst_window_seconds</td><td>Integer</td><td>No</td><td>Seconds</td><td>Time window for burst allowance.</td></tr>
<tr><td>priority</td><td>Integer</td><td>Yes</td><td>1-100</td><td>Priority when multiple configs apply (higher = more specific).</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this configuration is currently active.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this configuration was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this configuration was last modified.</td></tr>
</tbody></table>
</div>
<h3 id="userquota"><a class="header" href="#userquota">UserQuota</a></h3>
<p>Tracks individual user quota allocations and current usage for multiple metric types, supporting feature RL-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to the User table. Part of composite primary key.</td></tr>
<tr><td>quota_type</td><td>Enum</td><td>Yes</td><td>API_CALLS, DATA_POINTS, HISTORICAL_REQUESTS</td><td>Type of quota being tracked. Part of composite key.</td></tr>
<tr><td>period_type</td><td>Enum</td><td>Yes</td><td>DAILY, MONTHLY</td><td>Quota reset period. Part of composite key.</td></tr>
<tr><td>allocated_quota</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Total quota allocated for the period, based on the user's tier.</td></tr>
<tr><td>used_quota</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Amount of quota currently used in the period.</td></tr>
<tr><td>reset_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the quota will next reset.</td></tr>
<tr><td>last_usage_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>Timestamp of the last quota usage.</td></tr>
<tr><td>warning_threshold</td><td>Float</td><td>Yes</td><td>0.0 - 1.0</td><td>Percentage threshold for usage warnings (e.g., 0.8 for 80%).</td></tr>
<tr><td>warning_sent</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether a warning notification has been sent for this period.</td></tr>
<tr><td>overage_allowed</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether overage beyond the quota is permitted (often tied to billing).</td></tr>
<tr><td>overage_limit</td><td>Integer</td><td>No</td><td>Positive integer</td><td>Maximum overage allowed (if overage_allowed is true).</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this quota record was last updated.</td></tr>
</tbody></table>
</div>
<h3 id="ratelimitviolation"><a class="header" href="#ratelimitviolation">RateLimitViolation</a></h3>
<p>Time-series table logging rate limit violations and enforcement actions, supporting feature RL-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>violation_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the violation record.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the violation occurred.</td></tr>
<tr><td>endpoint</td><td>String</td><td>Yes</td><td>e.g., &quot;/api/v1/prices&quot;</td><td>The endpoint where the violation occurred.</td></tr>
<tr><td>violation_type</td><td>Enum</td><td>Yes</td><td>RATE_LIMIT, QUOTA_EXCEEDED, FAIR_USAGE</td><td>The type of rule that was violated.</td></tr>
<tr><td>limit_exceeded</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The defined limit that was exceeded.</td></tr>
<tr><td>actual_usage</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The actual usage that triggered the violation.</td></tr>
<tr><td>enforcement_action</td><td>Enum</td><td>Yes</td><td>WARNING, THROTTLE, BLOCK, SUSPEND</td><td>Action taken by the system in response.</td></tr>
<tr><td>duration_seconds</td><td>Integer</td><td>No</td><td>Seconds</td><td>Duration of the enforcement action (if applicable).</td></tr>
<tr><td>severity</td><td>Enum</td><td>Yes</td><td>LOW, MEDIUM, HIGH, CRITICAL</td><td>Severity level of the violation, used for escalations.</td></tr>
<tr><td>user_agent</td><td>String</td><td>No</td><td>Free text</td><td>User agent string from the offending request.</td></tr>
<tr><td>ip_address</td><td>String</td><td>No</td><td>IP address</td><td>Client IP address of the offending request.</td></tr>
<tr><td>metadata</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional context about the violation for analysis.</td></tr>
</tbody></table>
</div>
<h3 id="fairusagepolicy"><a class="header" href="#fairusagepolicy">FairUsagePolicy</a></h3>
<p>Defines fair usage rules and automated enforcement thresholds, supporting feature RL-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>policy_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the fair usage policy.</td></tr>
<tr><td>policy_name</td><td>String</td><td>Yes</td><td>Free text</td><td>Human-readable name for the policy (e.g., &quot;Free Tier Anti-Scraping Policy&quot;).</td></tr>
<tr><td>tier_id</td><td>UUID</td><td>No</td><td>UUID</td><td>Foreign key to SubscriptionTier (null for global policies).</td></tr>
<tr><td>detection_window_hours</td><td>Integer</td><td>Yes</td><td>Hours</td><td>Time window for detecting anomalous behavior patterns.</td></tr>
<tr><td>threshold_multiplier</td><td>Float</td><td>Yes</td><td>&gt; 1.0</td><td>Multiplier of a user's normal usage baseline that triggers a violation.</td></tr>
<tr><td>violation_count_threshold</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>Number of violations within the window before escalating action.</td></tr>
<tr><td>escalation_sequence</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>A defined sequence of enforcement actions (e.g., [&quot;WARN&quot;, &quot;THROTTLE_1H&quot;, &quot;BLOCK_24H&quot;]).</td></tr>
<tr><td>whitelist_enabled</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether whitelisting is available for this policy.</td></tr>
<tr><td>appeal_process_enabled</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether users are allowed to appeal actions under this policy.</td></tr>
<tr><td>auto_review_hours</td><td>Integer</td><td>No</td><td>Hours</td><td>Hours before an automated review of a violation is triggered.</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this policy is currently being enforced.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this policy was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this policy was last modified.</td></tr>
</tbody></table>
</div>
<h3 id="dynamicrateadjustment"><a class="header" href="#dynamicrateadjustment">DynamicRateAdjustment</a></h3>
<p>Time-series table storing dynamic rate limit adjustments based on system conditions, supporting feature RL-004.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>adjustment_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the adjustment record.</td></tr>
<tr><td>config_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the specific RateLimitConfig that was adjusted.</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the adjustment was made.</td></tr>
<tr><td>trigger_type</td><td>Enum</td><td>Yes</td><td>SYSTEM_LOAD, USER_BEHAVIOR, PREDICTIVE, MANUAL</td><td>The reason for the adjustment.</td></tr>
<tr><td>original_limit</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The original rate limit value before adjustment.</td></tr>
<tr><td>adjusted_limit</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The new, temporarily adjusted rate limit value.</td></tr>
<tr><td>adjustment_factor</td><td>Float</td><td>Yes</td><td>&gt; 0.0</td><td>Multiplier applied to the original limit to get the adjusted limit.</td></tr>
<tr><td>system_load_pct</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>System-wide load percentage at the time of adjustment.</td></tr>
<tr><td>cpu_usage_pct</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>CPU usage percentage of the relevant service.</td></tr>
<tr><td>memory_usage_pct</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Memory usage percentage of the relevant service.</td></tr>
<tr><td>active_connections</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>Number of active connections to the service.</td></tr>
<tr><td>prediction_confidence</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Confidence level for predictive adjustments.</td></tr>
<tr><td>duration_minutes</td><td>Integer</td><td>No</td><td>Minutes</td><td>Expected duration of the adjustment.</td></tr>
<tr><td>auto_revert</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether the adjustment is configured to automatically revert.</td></tr>
<tr><td>revert_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The specific time the adjustment is scheduled to revert.</td></tr>
<tr><td>created_by</td><td>String</td><td>No</td><td>Free text</td><td>Identifier for the user or system that created the adjustment.</td></tr>
<tr><td>metadata</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional context about the adjustment for analysis.</td></tr>
</tbody></table>
</div>
<h3 id="userwhitelist"><a class="header" href="#userwhitelist">UserWhitelist</a></h3>
<p>Manages whitelisted users who are exempt from certain fair usage policies, supporting feature RL-003.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>whitelist_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the whitelist entry.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>policy_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the FairUsagePolicy from which the user is exempt.</td></tr>
<tr><td>exemption_type</td><td>Enum</td><td>Yes</td><td>PARTIAL, FULL</td><td>The level of exemption from the policy.</td></tr>
<tr><td>custom_limits</td><td>JSON</td><td>No</td><td>JSON object</td><td>Custom limits or rules that apply instead of the policy's defaults (for PARTIAL exemption).</td></tr>
<tr><td>reason</td><td>Text</td><td>Yes</td><td>Free text</td><td>Justification for why the user is being whitelisted.</td></tr>
<tr><td>approved_by</td><td>String</td><td>Yes</td><td>Free text</td><td>The admin or system that approved the whitelist entry.</td></tr>
<tr><td>valid_from</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the whitelist entry becomes active.</td></tr>
<tr><td>valid_until</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When the whitelist entry expires (null for permanent).</td></tr>
<tr><td>review_date</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>A future date when this entry should be manually reviewed.</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this whitelist entry is currently active and enforced.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this entry was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this entry was last modified.</td></tr>
</tbody></table>
</div>
<h2 id="relationships-4"><a class="header" href="#relationships-4">Relationships</a></h2>
<ul>
<li><strong>SubscriptionTier [tier_id (PK)] 1 =&gt; * RateLimitConfig [tier_id (FK)]</strong></li>
<li><strong>User [user_id (PK)] 1 =&gt; * UserQuota [user_id (FK)]</strong></li>
<li><strong>User [user_id (PK)] 1 =&gt; * RateLimitViolation [user_id (FK)]</strong></li>
<li><strong>SubscriptionTier [tier_id (PK)] 1 =&gt; * FairUsagePolicy [tier_id (FK)]</strong></li>
<li><strong>RateLimitConfig [config_id (PK)] 1 =&gt; * DynamicRateAdjustment [config_id (FK)]</strong></li>
<li><strong>User [user_id (PK)] 1 =&gt; * UserWhitelist [user_id (FK)]</strong></li>
<li><strong>FairUsagePolicy [policy_id (PK)] 1 =&gt; * UserWhitelist [policy_id (FK)]</strong></li>
</ul>
<h2 id="entities--relationships-3"><a class="header" href="#entities--relationships-3">Entities &amp; Relationships</a></h2>
<ul>
<li><strong>RateLimitConfig</strong>
<ul>
<li>config_id (PK)</li>
<li>tier_id (FK â†’ SubscriptionTier.tier_id)</li>
</ul>
</li>
<li><strong>UserQuota</strong>
<ul>
<li>user_id (PK, FK â†’ User.user_id)</li>
<li>quota_type (PK)</li>
<li>period_type (PK)</li>
</ul>
</li>
<li><strong>RateLimitViolation</strong>
<ul>
<li>violation_id (PK)</li>
<li>user_id (FK â†’ User.user_id)</li>
</ul>
</li>
<li><strong>FairUsagePolicy</strong>
<ul>
<li>policy_id (PK)</li>
<li>tier_id (FK â†’ SubscriptionTier.tier_id)</li>
</ul>
</li>
<li><strong>DynamicRateAdjustment</strong>
<ul>
<li>adjustment_id (PK)</li>
<li>config_id (FK â†’ RateLimitConfig.config_id)</li>
</ul>
</li>
<li><strong>UserWhitelist</strong>
<ul>
<li>whitelist_id (PK)</li>
<li>user_id (FK â†’ User.user_id)</li>
<li>policy_id (FK â†’ FairUsagePolicy.policy_id)</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api--data-distribution-1"><a class="header" href="#api--data-distribution-1">API &amp; Data Distribution</a></h1>
<p>This document is divided into two parts:</p>
<ol>
<li><strong>Data Specification</strong> â€“ Defines the underlying database tables needed to store and serve the data for the API endpoints.</li>
<li><strong>API Response Examples</strong> â€“ Shows the structure of the JSON data that users will receive from the various API endpoints.</li>
</ol>
<hr />
<h2 id="1-data-specification"><a class="header" href="#1-data-specification">1. Data Specification</a></h2>
<h3 id="overview-10"><a class="header" href="#overview-10">Overview</a></h3>
<p>This specification details the data models required to support the platform's public-facing APIs. It includes tables for:</p>
<ul>
<li>Master asset information</li>
<li>Aggregated market statistics</li>
<li>OHLCV (candlestick) data</li>
<li>Foreign exchange rates</li>
<li>Bulk data export system</li>
</ul>
<p>These models are optimized for efficient read-access to serve high-traffic API endpoints.</p>
<h3 id="relations-between-tables-5"><a class="header" href="#relations-between-tables-5">Relations Between Tables</a></h3>
<ul>
<li><strong>Asset</strong>: Source of truth for descriptive details of each supported cryptocurrency.</li>
<li><strong>MarketStatistics</strong>: Periodically updated table with aggregated metrics per asset.</li>
<li><strong>Ohlcv</strong>: Candlestick data for various timeframes, derived from trades.</li>
<li><strong>FxRate</strong>: Stores fiat currency conversion rates.</li>
<li><strong>DataExportJob</strong>: Tracks status and metadata of user export requests.</li>
</ul>
<hr />
<h3 id="-asset"><a class="header" href="#-asset">ðŸ“„ Asset</a></h3>
<blockquote>
<p>Master registry of all supported cryptocurrencies and tokens.</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>asset_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique identifier for the asset.</td></tr>
<tr><td>name</td><td>String</td><td>Yes</td><td>e.g., &quot;Bitcoin&quot;</td><td>Full name of the asset.</td></tr>
<tr><td>symbol</td><td>String</td><td>Yes</td><td>e.g., &quot;BTC&quot;</td><td>Ticker symbol.</td></tr>
<tr><td>description</td><td>Text</td><td>No</td><td>Free text</td><td>Brief description of the asset.</td></tr>
<tr><td>logo_url</td><td>String</td><td>No</td><td>URL</td><td>Link to asset logo.</td></tr>
<tr><td>contract_address</td><td>JSON</td><td>No</td><td>{&quot;ethereum&quot;: &quot;0x...&quot;}</td><td>Maps chains to contract addresses.</td></tr>
<tr><td>tags</td><td>JSON</td><td>No</td><td>Array of strings</td><td>Categorization tags (e.g., [&quot;defi&quot;, &quot;layer-1&quot;])</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-marketstatistics"><a class="header" href="#-marketstatistics">ðŸ“„ MarketStatistics</a></h3>
<blockquote>
<p>Aggregated metrics per asset (supports <code>API-001</code> and <code>API-002</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>asset_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to <code>Asset</code>. Primary key.</td></tr>
<tr><td>current_price_usd</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Aggregated price in USD.</td></tr>
<tr><td>market_cap_usd</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Market capitalization in USD.</td></tr>
<tr><td>volume_24h_usd</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Trading volume in last 24h.</td></tr>
<tr><td>circulating_supply</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Circulating supply.</td></tr>
<tr><td>price_change_24h_percent</td><td>Float</td><td>Yes</td><td>Numeric</td><td>24h price change in %.</td></tr>
<tr><td>rank</td><td>Integer</td><td>No</td><td>Numeric</td><td>Market cap ranking.</td></tr>
<tr><td>last_updated</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Last aggregation timestamp.</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-ohlcv"><a class="header" href="#-ohlcv">ðŸ“„ Ohlcv</a></h3>
<blockquote>
<p>Aggregated candlestick data per market and timeframe (supports <code>API-003</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>market_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to <code>Market</code>. Composite PK</td></tr>
<tr><td>timeframe</td><td>String</td><td>Yes</td><td>e.g., &quot;1h&quot;</td><td>Timeframe for the candle. Composite PK</td></tr>
<tr><td>open_time</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Start time of the candle. Composite PK</td></tr>
<tr><td>open_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Price at the beginning.</td></tr>
<tr><td>high_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Highest price.</td></tr>
<tr><td>low_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Lowest price.</td></tr>
<tr><td>close_price</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Price at the end.</td></tr>
<tr><td>volume</td><td>Decimal(36,18)</td><td>Yes</td><td>Numeric</td><td>Volume traded during timeframe.</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-fxrate"><a class="header" href="#-fxrate">ðŸ“„ FxRate</a></h3>
<blockquote>
<p>Foreign exchange conversion rates.</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>currency_pair</td><td>String</td><td>Yes</td><td>e.g., &quot;USD/EUR&quot;</td><td>Currency pair. Primary key.</td></tr>
<tr><td>rate</td><td>Decimal(18,8)</td><td>Yes</td><td>Numeric</td><td>Conversion rate.</td></tr>
<tr><td>last_updated</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Timestamp of last update.</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="-dataexportjob"><a class="header" href="#-dataexportjob">ðŸ“„ DataExportJob</a></h3>
<blockquote>
<p>Tracks user requests for bulk historical data (supports <code>API-006</code>).</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>job_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Unique job identifier.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Requesting user's ID.</td></tr>
<tr><td>data_type</td><td>Enum</td><td>Yes</td><td>TRADES, OHLCV</td><td>Type of data to export.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>PENDING, PROCESSING, COMPLETED, FAILED</td><td>Job status</td></tr>
<tr><td>params</td><td>JSON</td><td>Yes</td><td>JSON object</td><td>Export parameters (e.g., market, date range).</td></tr>
<tr><td>download_url</td><td>String</td><td>No</td><td>URL</td><td>URL to download file post-completion.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>Request timestamp.</td></tr>
<tr><td>completed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>Completion timestamp.</td></tr>
</tbody></table>
</div>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="real-time-data-streaming-1"><a class="header" href="#real-time-data-streaming-1">Real-Time Data Streaming</a></h1>
<h2 id="overview-11"><a class="header" href="#overview-11">Overview</a></h2>
<p>This document details the data models that support the platform's Real-Time Data Streaming features. These structures are designed to manage WebSocket connections, streaming subscriptions, push notifications, and real-time data delivery. The primary purpose of these models is to enable efficient real-time data distribution, manage streaming quotas, handle connection lifecycle, and ensure reliable delivery of time-sensitive information to applications and users.</p>
<h2 id="relations-between-tables-6"><a class="header" href="#relations-between-tables-6">Relations between Tables</a></h2>
<ul>
<li><strong>WebSocketConnection &amp; User</strong>: A foundational one-to-many relationship that tracks every active real-time session. A single User can have multiple WebSocketConnection records, representing simultaneous connections from different devices or applications (e.g., a web browser and a trading bot). This allows the system to manage the lifecycle, authentication status, and resource usage of each connection independently.</li>
<li><strong>StreamingSubscription, WebSocketConnection, &amp; User</strong>: This table acts as a crucial link between a session and the data it requests. A single WebSocketConnection can have many StreamingSubscription records, allowing a client to subscribe to multiple data streams (e.g., BTC prices, ETH trades) over a single connection. The direct link to the User provides a clear ownership trail for enforcing permissions and quotas without needing to traverse through the connection record first.</li>
<li><strong>StreamingQuota &amp; User</strong>: This one-to-many relationship is how the platform enforces streaming limits based on a user's subscription tier. Each User has multiple StreamingQuota records, with each record tracking a specific limit, such as the maximum number of concurrent connections or the total messages allowed per hour. This granular structure is essential for fair resource allocation and preventing abuse of the real-time infrastructure.</li>
<li><strong>PriceAlert, PushNotificationConfig, &amp; User</strong>: This set of relationships creates a highly flexible notification system. A User can define multiple PushNotificationConfig records, each representing a unique delivery channel (e.g., an email address, a webhook URL, a mobile device token). The PriceAlert table then has a many-to-one relationship with PushNotificationConfig, which allows the user to decide exactly how and where they want to be notified for each specific alert they create.</li>
<li><strong>NotificationDelivery &amp; PushNotificationConfig</strong>: This is a logging-focused one-to-many relationship that provides a complete audit trail for all outgoing notifications. Every time the system attempts to send an alert via a specific PushNotificationConfig, a NotificationDelivery record is created. This tracks the entire lifecycle of the messageâ€”from PENDING to SENT or FAILEDâ€”and stores valuable diagnostic information like provider response codes and failure reasons.</li>
</ul>
<h2 id="websocketconnection"><a class="header" href="#websocketconnection">WebSocketConnection</a></h2>
<p>Manages active WebSocket connections and their lifecycle, supporting feature RT-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>connection_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the WebSocket connection.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>session_id</td><td>String</td><td>Yes</td><td>Alphanumeric</td><td>Unique session identifier for the connection, generated by the server.</td></tr>
<tr><td>connection_status</td><td>Enum</td><td>Yes</td><td>CONNECTING, ACTIVE, IDLE, DISCONNECTED, FAILED</td><td>Current connection status.</td></tr>
<tr><td>server_endpoint</td><td>String</td><td>Yes</td><td>URL</td><td>WebSocket server endpoint (node) handling this connection.</td></tr>
<tr><td>client_ip</td><td>String</td><td>Yes</td><td>IP address</td><td>Client IP address of the connection.</td></tr>
<tr><td>user_agent</td><td>String</td><td>No</td><td>Free text</td><td>Client user agent string for identification.</td></tr>
<tr><td>protocol_version</td><td>String</td><td>Yes</td><td>e.g., &quot;v1.0&quot;</td><td>The version of the WebSocket protocol being used.</td></tr>
<tr><td>connected_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the connection was successfully established.</td></tr>
<tr><td>last_ping_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp of the last received client ping or server heartbeat.</td></tr>
<tr><td>last_activity_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The timestamp of the last message or activity on this connection.</td></tr>
<tr><td>disconnected_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When the connection was closed.</td></tr>
<tr><td>disconnect_reason</td><td>String</td><td>No</td><td>Free text</td><td>Reason for disconnection (e.g., &quot;client-close&quot;, &quot;timeout&quot;, &quot;error&quot;).</td></tr>
<tr><td>auto_reconnect</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether the client has indicated it supports auto-reconnection.</td></tr>
<tr><td>compression_enabled</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether data compression (e.g., permessage-deflate) is enabled.</td></tr>
<tr><td>rate_limit_remaining</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The remaining message rate limit for the current window for this connection.</td></tr>
<tr><td>subscription_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The number of active subscriptions on this connection.</td></tr>
<tr><td>bytes_sent</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Total bytes sent from the server to the client.</td></tr>
<tr><td>bytes_received</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Total bytes received from the client by the server.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the connection record was created in the database.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the connection record was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="streamingsubscription"><a class="header" href="#streamingsubscription">StreamingSubscription</a></h2>
<p>Manages user subscriptions to specific real-time data streams, supporting feature RT-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>subscription_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the streaming subscription.</td></tr>
<tr><td>connection_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the parent WebSocketConnection.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table for permission checks.</td></tr>
<tr><td>stream_type</td><td>Enum</td><td>Yes</td><td>PRICE_TICKER, ORDER_BOOK, TRADES, MARKET_STATS</td><td>The type of data stream being subscribed to.</td></tr>
<tr><td>asset_symbol</td><td>String</td><td>No</td><td>e.g., &quot;BTC&quot;, &quot;ETH&quot;</td><td>Specific asset symbol (null for multi-asset streams).</td></tr>
<tr><td>market_pair</td><td>String</td><td>No</td><td>e.g., &quot;BTC/USDT&quot;</td><td>Trading pair for market-specific streams.</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>No</td><td>UUID</td><td>Specific exchange filter (null for aggregated data).</td></tr>
<tr><td>subscription_params</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional subscription parameters (e.g., filters, intervals, depth for order books).</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>ACTIVE, PAUSED, CANCELLED, ERROR</td><td>The current status of the subscription.</td></tr>
<tr><td>subscribed_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the subscription was created.</td></tr>
<tr><td>last_data_sent_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp when data was last sent for this subscription.</td></tr>
<tr><td>message_count</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>The total number of messages sent for this subscription.</td></tr>
<tr><td>error_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The number of errors encountered while processing this subscription.</td></tr>
<tr><td>last_error_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp of the last error.</td></tr>
<tr><td>last_error_message</td><td>Text</td><td>No</td><td>Free text</td><td>The message from the last error encountered.</td></tr>
<tr><td>priority</td><td>Integer</td><td>Yes</td><td>1-10</td><td>Subscription priority for resource allocation (higher is more important).</td></tr>
<tr><td>rate_limit_per_second</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The maximum messages per second allowed for this subscription.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the subscription record was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the subscription record was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="streamingquota"><a class="header" href="#streamingquota">StreamingQuota</a></h2>
<p>Manages streaming quotas and usage limits per user, supporting feature RT-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to User table. Part of the composite primary key.</td></tr>
<tr><td>quota_type</td><td>Enum</td><td>Yes</td><td>CONCURRENT_CONNECTIONS, SUBSCRIPTIONS, MESSAGES_PER_HOUR</td><td>The type of streaming quota being tracked. Part of the composite key.</td></tr>
<tr><td>allocated_quota</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The maximum quota allocated based on the user's subscription tier.</td></tr>
<tr><td>used_quota</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The current usage against the allocated quota.</td></tr>
<tr><td>peak_usage</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The highest usage recorded in the current period for analysis.</td></tr>
<tr><td>reset_period_hours</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The number of hours between quota resets (e.g., 1 for hourly, 24 for daily).</td></tr>
<tr><td>last_reset_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The timestamp when the quota was last reset.</td></tr>
<tr><td>next_reset_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>The timestamp when the quota will next reset.</td></tr>
<tr><td>warning_threshold</td><td>Float</td><td>Yes</td><td>0.0 - 1.0</td><td>The percentage threshold for sending usage warnings (e.g., 0.8 for 80%).</td></tr>
<tr><td>warning_sent</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>A flag to indicate if a warning has been sent for the current period.</td></tr>
<tr><td>overage_allowed</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether usage can exceed the quota (potentially incurring extra charges).</td></tr>
<tr><td>overage_multiplier</td><td>Float</td><td>No</td><td>&gt; 1.0</td><td>The maximum overage allowed, expressed as a multiplier of the base quota.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the quota usage was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="pushnotificationconfig"><a class="header" href="#pushnotificationconfig">PushNotificationConfig</a></h2>
<p>Stores user notification preferences and delivery channel settings, supporting feature RT-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>config_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the notification configuration.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>notification_type</td><td>Enum</td><td>Yes</td><td>PRICE_ALERT, MARKET_EVENT, SYSTEM_NOTIFICATION</td><td>The general type of notification this config applies to.</td></tr>
<tr><td>delivery_channel</td><td>Enum</td><td>Yes</td><td>EMAIL, SMS, WEBHOOK, PUSH_NOTIFICATION</td><td>The specific delivery method or channel.</td></tr>
<tr><td>is_enabled</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this notification channel is currently enabled by the user.</td></tr>
<tr><td>delivery_address</td><td>String</td><td>Yes</td><td>Contact info</td><td>The destination address (e.g., email, phone number, or webhook URL).</td></tr>
<tr><td>delivery_schedule</td><td>JSON</td><td>No</td><td>JSON object</td><td>Time-based delivery preferences (e.g., daily digests, specific hours).</td></tr>
<tr><td>priority_level</td><td>Enum</td><td>Yes</td><td>LOW, MEDIUM, HIGH, URGENT</td><td>The priority level of notifications sent via this channel.</td></tr>
<tr><td>retry_attempts</td><td>Integer</td><td>Yes</td><td>0-10</td><td>The maximum number of delivery retry attempts on failure.</td></tr>
<tr><td>retry_delay_minutes</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The number of minutes to wait between retry attempts.</td></tr>
<tr><td>confirmation_required</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether delivery confirmation from the provider is required.</td></tr>
<tr><td>rate_limit_per_hour</td><td>Integer</td><td>Yes</td><td>Positive integer</td><td>The maximum number of notifications to send per hour via this channel.</td></tr>
<tr><td>quiet_hours_start</td><td>Time</td><td>No</td><td>HH:MM</td><td>The start of a &quot;do not disturb&quot; period.</td></tr>
<tr><td>quiet_hours_end</td><td>Time</td><td>No</td><td>HH:MM</td><td>The end of a &quot;do not disturb&quot; period.</td></tr>
<tr><td>timezone</td><td>String</td><td>Yes</td><td>e.g., &quot;UTC&quot;, &quot;America/New_York&quot;</td><td>The user's timezone for scheduling and quiet hours.</td></tr>
<tr><td>custom_template</td><td>Text</td><td>No</td><td>Template string</td><td>A user-defined message template (e.g., using Mustache or Handlebars).</td></tr>
<tr><td>metadata</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional configuration parameters specific to the channel.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the configuration was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the configuration was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="notificationdelivery"><a class="header" href="#notificationdelivery">NotificationDelivery</a></h2>
<p>Time-series table logging notification delivery attempts and status, supporting feature RT-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>delivery_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the delivery record.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>config_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the PushNotificationConfig used for this delivery.</td></tr>
<tr><td>notification_type</td><td>Enum</td><td>Yes</td><td>PRICE_ALERT, MARKET_EVENT, SYSTEM_NOTIFICATION</td><td>The type of notification that was sent.</td></tr>
<tr><td>delivery_channel</td><td>Enum</td><td>Yes</td><td>EMAIL, SMS, WEBHOOK, PUSH_NOTIFICATION</td><td>The delivery method that was used.</td></tr>
<tr><td>delivery_address</td><td>String</td><td>Yes</td><td>Contact info</td><td>The specific destination address where the notification was sent.</td></tr>
<tr><td>message_content</td><td>Text</td><td>Yes</td><td>Free text</td><td>The final, rendered content of the notification message.</td></tr>
<tr><td>subject_line</td><td>String</td><td>No</td><td>Free text</td><td>The email subject or notification title, if applicable.</td></tr>
<tr><td>trigger_event</td><td>String</td><td>Yes</td><td>Free text</td><td>A description of the event that triggered this notification (e.g., &quot;BTC price &gt; $70000&quot;).</td></tr>
<tr><td>trigger_data</td><td>JSON</td><td>No</td><td>JSON object</td><td>The data related to the trigger event (e.g., actual price, volume).</td></tr>
<tr><td>scheduled_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the notification was scheduled for delivery.</td></tr>
<tr><td>sent_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp when the notification was actually sent.</td></tr>
<tr><td>delivery_status</td><td>Enum</td><td>Yes</td><td>PENDING, SENT, DELIVERED, FAILED, REJECTED</td><td>The current delivery status, as reported by the provider.</td></tr>
<tr><td>delivery_confirmed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp when delivery was confirmed by the provider.</td></tr>
<tr><td>failure_reason</td><td>String</td><td>No</td><td>Free text</td><td>The reason for delivery failure, if any.</td></tr>
<tr><td>retry_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The number of retry attempts that have been made.</td></tr>
<tr><td>last_retry_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp of the last retry attempt.</td></tr>
<tr><td>external_id</td><td>String</td><td>No</td><td>Free text</td><td>The delivery ID from the external provider (e.g., SendGrid, Twilio).</td></tr>
<tr><td>response_code</td><td>Integer</td><td>No</td><td>HTTP status code</td><td>The response code from the provider's API (e.g., 200, 404).</td></tr>
<tr><td>response_message</td><td>Text</td><td>No</td><td>Free text</td><td>The response message from the provider's API.</td></tr>
<tr><td>processing_time_ms</td><td>Integer</td><td>No</td><td>Milliseconds</td><td>The time taken for the system to process and send the notification.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the delivery record was created.</td></tr>
</tbody></table>
</div>
<h2 id="pricealert"><a class="header" href="#pricealert">PriceAlert</a></h2>
<p>Stores user-defined price alerts and their trigger conditions, supporting feature RT-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>alert_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the price alert.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>asset_symbol</td><td>String</td><td>Yes</td><td>e.g., &quot;BTC&quot;, &quot;ETH&quot;</td><td>The asset symbol to monitor.</td></tr>
<tr><td>market_pair</td><td>String</td><td>No</td><td>e.g., &quot;BTC/USDT&quot;</td><td>A specific trading pair (null for globally aggregated price).</td></tr>
<tr><td>exchange_id</td><td>UUID</td><td>No</td><td>UUID</td><td>A specific exchange (null for aggregated price).</td></tr>
<tr><td>alert_type</td><td>Enum</td><td>Yes</td><td>PRICE_ABOVE, PRICE_BELOW, PRICE_CHANGE_PCT, VOLUME_SPIKE</td><td>The type of condition that triggers the alert.</td></tr>
<tr><td>threshold_value</td><td>Decimal</td><td>Yes</td><td>Numeric</td><td>The threshold value for the alert condition.</td></tr>
<tr><td>current_value</td><td>Decimal</td><td>No</td><td>Numeric</td><td>The current value of the metric being monitored.</td></tr>
<tr><td>alert_name</td><td>String</td><td>No</td><td>Free text</td><td>A user-defined name for the alert for easy identification.</td></tr>
<tr><td>is_active</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether the alert is currently active and being monitored.</td></tr>
<tr><td>is_repeating</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether the alert should automatically re-arm after triggering.</td></tr>
<tr><td>cooldown_minutes</td><td>Integer</td><td>No</td><td>Positive integer</td><td>The number of minutes to wait before a repeating alert can trigger again.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the alert was created.</td></tr>
<tr><td>last_triggered_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp when the alert was last triggered.</td></tr>
<tr><td>trigger_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>The number of times this alert has been triggered.</td></tr>
<tr><td>expires_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>The timestamp when the alert expires (null for permanent alerts).</td></tr>
<tr><td>priority</td><td>Enum</td><td>Yes</td><td>LOW, MEDIUM, HIGH</td><td>The priority level of the alert.</td></tr>
<tr><td>notification_config_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key to the PushNotificationConfig to use when this alert triggers.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the alert was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="relationships-5"><a class="header" href="#relationships-5">Relationships</a></h2>
<ul>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>WebSocketConnection</strong> [user_id (FK)]</li>
<li><strong>WebSocketConnection</strong> [connection_id (PK)] 1 =&gt; * <strong>StreamingSubscription</strong> [connection_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>StreamingSubscription</strong> [user_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>StreamingQuota</strong> [user_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>PushNotificationConfig</strong> [user_id (FK)]</li>
<li><strong>PushNotificationConfig</strong> [config_id (PK)] 1 =&gt; * <strong>NotificationDelivery</strong> [config_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>PriceAlert</strong> [user_id (FK)]</li>
<li><strong>PushNotificationConfig</strong> [config_id (PK)] 1 =&gt; * <strong>PriceAlert</strong> [notification_config_id (FK)]</li>
</ul>
<h2 id="entities--relationships-4"><a class="header" href="#entities--relationships-4">Entities &amp; Relationships</a></h2>
<h3 id="websocketconnection-1"><a class="header" href="#websocketconnection-1">WebSocketConnection</a></h3>
<ul>
<li><strong>connection_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id)</li>
</ul>
<h3 id="streamingsubscription-1"><a class="header" href="#streamingsubscription-1">StreamingSubscription</a></h3>
<ul>
<li><strong>subscription_id</strong> (PK)</li>
<li><strong>connection_id</strong> (FK â†’ WebSocketConnection.connection_id)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id)</li>
</ul>
<h3 id="streamingquota-1"><a class="header" href="#streamingquota-1">StreamingQuota</a></h3>
<ul>
<li><strong>user_id</strong> (PK, FK â†’ User.user_id)</li>
<li><strong>quota_type</strong> (PK)</li>
</ul>
<h3 id="pushnotificationconfig-1"><a class="header" href="#pushnotificationconfig-1">PushNotificationConfig</a></h3>
<ul>
<li><strong>config_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id)</li>
</ul>
<h3 id="notificationdelivery-1"><a class="header" href="#notificationdelivery-1">NotificationDelivery</a></h3>
<ul>
<li><strong>delivery_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id)</li>
<li><strong>config_id</strong> (FK â†’ PushNotificationConfig.config_id)</li>
</ul>
<h3 id="pricealert-1"><a class="header" href="#pricealert-1">PriceAlert</a></h3>
<ul>
<li><strong>alert_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id)</li>
<li><strong>notification_config_id</strong> (FK â†’ PushNotificationConfig.config_id)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compliance--security-1"><a class="header" href="#compliance--security-1">Compliance &amp; Security</a></h1>
<h2 id="overview-12"><a class="header" href="#overview-12">Overview</a></h2>
<p>This document details the data models that support the platform's Compliance &amp; Security features. These structures are designed to manage data privacy compliance, user consent tracking, security threat detection, and incident response. The primary purpose of these models is to ensure regulatory compliance (GDPR, CCPA, etc.), protect user privacy rights, maintain comprehensive security monitoring, and provide robust protection against malicious attacks and data breaches.</p>
<h2 id="relations-between-tables-7"><a class="header" href="#relations-between-tables-7">Relations between Tables</a></h2>
<ul>
<li><strong>UserConsent &amp; User</strong>: The UserConsent table has a many-to-one relationship with the User table. Each user can have multiple consent records over time (e.g., granting, then withdrawing consent), but each individual consent record must belong to exactly one user. This is tracked via the UserConsent.user_id foreign key and is foundational for privacy compliance.</li>
<li><strong>DataExportRequest &amp; User</strong>: This is a many-to-one relationship where multiple data export requests can be initiated by a single user. Each request in the DataExportRequest table is firmly linked back to one User via the user_id foreign key, ensuring proper handling of data portability rights under GDPR Article 20.</li>
<li><strong>DataDeletionRequest &amp; User</strong>: Similar to export requests, this is a many-to-one relationship. A user can submit multiple &quot;right to be forgotten&quot; requests, and each record in the DataDeletionRequest table is associated with exactly one user. This facilitates tracking and fulfillment of deletion requests per GDPR Article 17.</li>
<li><strong>SecurityIncident &amp; User / IPReputationScore</strong>: The SecurityIncident table has two key relationships. It has an optional many-to-one relationship with User (user_id can be null for system-wide incidents). It also has a many-to-one relationship with IPReputationScore via the source_ip field. This means many incidents can be traced back to a single malicious IP address, allowing for aggregated threat analysis.</li>
<li><strong>IPReputationScore</strong>: This table acts as a central hub for threat intelligence. It does not have outgoing foreign keys but is referenced by other tables. Its primary key, ip_address, links to SecurityIncident and SecurityAuditLog records, allowing events to be enriched with reputation and risk data.</li>
<li><strong>SecurityAuditLog &amp; User</strong>: This table has a many-to-one relationship with User. A single user's activity can generate a large volume of audit log entries. The user_id is nullable because some system-level security events may not be attributable to a specific user.</li>
<li><strong>PrivacyPolicyVersion &amp; UserConsent</strong>: A one-to-many relationship exists where one record in PrivacyPolicyVersion can be associated with many UserConsent records. The UserConsent.consent_version field links to the specific policy version the user agreed to, creating an immutable, auditable record of acceptance.</li>
</ul>
<h2 id="userconsent"><a class="header" href="#userconsent">UserConsent</a></h2>
<p>Manages user consent for various data processing activities, supporting feature CS-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>consent_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the consent record.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>consent_type</td><td>Enum</td><td>Yes</td><td>DATA_PROCESSING, MARKETING, ANALYTICS, COOKIES</td><td>Type of consent being tracked.</td></tr>
<tr><td>purpose_description</td><td>Text</td><td>Yes</td><td>FreeAd text</td><td>Detailed description of data processing purpose.</td></tr>
<tr><td>consent_status</td><td>Enum</td><td>Yes</td><td>GRANTED, DENIED, WITHDRAWN, EXPIRED</td><td>Current consent status.</td></tr>
<tr><td>consent_method</td><td>Enum</td><td>Yes</td><td>EXPLICIT_OPT_IN, IMPLIED, PRE_CHECKED, GRANULAR</td><td>How consent was obtained.</td></tr>
<tr><td>consent_version</td><td>String</td><td>Yes</td><td>e.g., &quot;v2.1&quot;</td><td>Version of privacy policy/terms when consent was given.</td></tr>
<tr><td>legal_basis</td><td>Enum</td><td>Yes</td><td>CONSENT, CONTRACT, LEGAL_OBLIGATION, VITAL_INTERESTS, PUBLIC_TASK, LEGITIMATE_INTERESTS</td><td>GDPR legal basis for processing.</td></tr>
<tr><td>data_categories</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>Categories of personal data covered by this consent.</td></tr>
<tr><td>processing_purposes</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>Specific purposes for data processing.</td></tr>
<tr><td>third_party_sharing</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether data may be shared with third parties.</td></tr>
<tr><td>retention_period_days</td><td>Integer</td><td>No</td><td>Positive integer</td><td>Data retention period in days (null for indefinite).</td></tr>
<tr><td>granted_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When consent was granted.</td></tr>
<tr><td>withdrawn_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When consent was withdrawn.</td></tr>
<tr><td>expires_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When consent expires (null for indefinite).</td></tr>
<tr><td>ip_address</td><td>String</td><td>No</td><td>IP address</td><td>IP address when consent was given.</td></tr>
<tr><td>user_agent</td><td>String</td><td>No</td><td>Free text</td><td>Browser/client when consent was given.</td></tr>
<tr><td>evidence_data</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional evidence of consent (e.g., form data, timestamps).</td></tr>
<tr><td>withdrawal_reason</td><td>Text</td><td>No</td><td>Free text</td><td>Reason for consent withdrawal.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When consent record was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When consent record was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="dataexportrequest"><a class="header" href="#dataexportrequest">DataExportRequest</a></h2>
<p>Tracks user requests for data portability and export (GDPR Article 20), supporting feature CS-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>request_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the export request.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>request_type</td><td>Enum</td><td>Yes</td><td>FULL_EXPORT, PARTIAL_EXPORT, SPECIFIC_DATA</td><td>Scope of data export requested.</td></tr>
<tr><td>data_categories</td><td>JSON</td><td>Yes</td><td>JSON array</td><td>Specific categories of data requested.</td></tr>
<tr><td>export_format</td><td>Enum</td><td>Yes</td><td>JSON, CSV, XML, PDF</td><td>Requested format for exported data.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>PENDING, PROCESSING, COMPLETED, FAILED, CANCELLED</td><td>Current request status.</td></tr>
<tr><td>requested_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When request was submitted.</td></tr>
<tr><td>processed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When processing began.</td></tr>
<tr><td>completed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When request was completed.</td></tr>
<tr><td>expires_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When download link expires.</td></tr>
<tr><td>file_path</td><td>String</td><td>No</td><td>File path</td><td>Location of generated export file.</td></tr>
<tr><td>file_size_bytes</td><td>BigInt</td><td>No</td><td>Bytes</td><td>Size of exported data file.</td></tr>
<tr><td>download_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of times file was downloaded.</td></tr>
<tr><td>last_downloaded_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When file was last downloaded.</td></tr>
<tr><td>verification_token</td><td>String</td><td>No</td><td>Token</td><td>Security token for download verification.</td></tr>
<tr><td>delivery_method</td><td>Enum</td><td>Yes</td><td>DOWNLOAD_LINK, EMAIL, SECURE_PORTAL</td><td>How export is delivered to user.</td></tr>
<tr><td>delivery_address</td><td>String</td><td>No</td><td>Email/URL</td><td>Delivery destination.</td></tr>
<tr><td>processing_notes</td><td>Text</td><td>No</td><td>Free text</td><td>Notes about processing or issues encountered.</td></tr>
<tr><td>failure_reason</td><td>Text</td><td>No</td><td>Free text</td><td>Reason for failure (if status is FAILED).</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When request was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When request was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="datadeletionrequest"><a class="header" href="#datadeletionrequest">DataDeletionRequest</a></h2>
<p>Manages &quot;right to be forgotten&quot; requests and tracks deletion progress (GDPR Article 17), supporting feature CS-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>deletion_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the deletion request.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Foreign key linking to the User table.</td></tr>
<tr><td>deletion_scope</td><td>Enum</td><td>Yes</td><td>COMPLETE_DELETION, PARTIAL_DELETION, ANONYMIZATION</td><td>Scope of deletion requested.</td></tr>
<tr><td>data_categories</td><td>JSON</td><td>No</td><td>JSON array</td><td>Specific data categories to delete (for partial deletion).</td></tr>
<tr><td>legal_ground</td><td>Enum</td><td>Yes</td><td>CONSENT_WITHDRAWN, UNLAWFUL_PROCESSING, NO_LONGER_NECESSARY, OBJECTION</td><td>Legal ground for deletion.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>PENDING, UNDER_REVIEW, APPROVED, REJECTED, PROCESSING, COMPLETED</td><td>Current request status.</td></tr>
<tr><td>requested_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When deletion was requested.</td></tr>
<tr><td>reviewed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When request was reviewed.</td></tr>
<tr><td>approved_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When deletion was approved.</td></tr>
<tr><td>processing_started_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When deletion processing began.</td></tr>
<tr><td>completed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When deletion was completed.</td></tr>
<tr><td>reviewer_id</td><td>String</td><td>No</td><td>User ID</td><td>Who reviewed the request.</td></tr>
<tr><td>rejection_reason</td><td>Text</td><td>No</td><td>Free text</td><td>Reason for rejection (if applicable).</td></tr>
<tr><td>retention_override</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether legal retention requirements override deletion.</td></tr>
<tr><td>retention_reason</td><td>Text</td><td>No</td><td>Free text</td><td>Reason for retention override.</td></tr>
<tr><td>backup_deletion_status</td><td>Enum</td><td>Yes</td><td>PENDING, IN_PROGRESS, COMPLETED, NOT_APPLICABLE</td><td>Status of backup deletion.</td></tr>
<tr><td>third_party_notification</td><td>JSON</td><td>No</td><td>JSON object</td><td>Status of third-party deletion notifications.</td></tr>
<tr><td>verification_required</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether additional identity verification is required.</td></tr>
<tr><td>verification_completed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When identity verification was completed.</td></tr>
<tr><td>processing_log</td><td>JSON</td><td>No</td><td>JSON array</td><td>Log of deletion processing steps.</td></tr>
<tr><td>data_subjects_notified</td><td>JSON</td><td>No</td><td>JSON array</td><td>List of data subjects/contacts notified.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When deletion request was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When request was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="securityincident"><a class="header" href="#securityincident">SecurityIncident</a></h2>
<p>Logs security threats, attacks, and incidents for monitoring and response, supporting feature CS-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>incident_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the security incident.</td></tr>
<tr><td>incident_type</td><td>Enum</td><td>Yes</td><td>DDOS_ATTACK, BRUTE_FORCE, SQL_INJECTION, XSS_ATTEMPT, RATE_LIMIT_VIOLATION, SUSPICIOUS_BEHAVIOR</td><td>Type of security incident.</td></tr>
<tr><td>severity_level</td><td>Enum</td><td>Yes</td><td>LOW, MEDIUM, HIGH, CRITICAL</td><td>Severity level of the incident.</td></tr>
<tr><td>status</td><td>Enum</td><td>Yes</td><td>DETECTED, INVESTIGATING, MITIGATED, RESOLVED, FALSE_POSITIVE</td><td>Current incident status.</td></tr>
<tr><td>source_ip</td><td>String</td><td>Yes</td><td>IP address</td><td>Source IP address of the incident.</td></tr>
<tr><td>target_endpoint</td><td>String</td><td>No</td><td>URL/endpoint</td><td>API endpoint or resource targeted.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>No</td><td>UUID</td><td>Associated user (if applicable).</td></tr>
<tr><td>attack_vector</td><td>Enum</td><td>No</td><td>HTTP_FLOOD, SYN_FLOOD, SLOWLORIS, APPLICATION_LAYER, VOLUMETRIC</td><td>Type of attack vector used.</td></tr>
<tr><td>request_count</td><td>Integer</td><td>No</td><td>Positive integer</td><td>Number of malicious requests detected.</td></tr>
<tr><td>blocked_requests</td><td>Integer</td><td>No</td><td>Non-negative integer</td><td>Number of requests blocked.</td></tr>
<tr><td>detection_method</td><td>Enum</td><td>Yes</td><td>RATE_LIMITING, PATTERN_MATCHING, ML_ANOMALY, REPUTATION_FILTER, MANUAL</td><td>How incident was detected.</td></tr>
<tr><td>detection_confidence</td><td>Float</td><td>No</td><td>0.0 - 1.0</td><td>Confidence level of detection (for ML-based detection).</td></tr>
<tr><td>first_detected_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When incident was first detected.</td></tr>
<tr><td>last_activity_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When last malicious activity was observed.</td></tr>
<tr><td>duration_seconds</td><td>Integer</td><td>No</td><td>Seconds</td><td>Duration of the incident.</td></tr>
<tr><td>mitigation_actions</td><td>JSON</td><td>No</td><td>JSON array</td><td>Actions taken to mitigate the incident.</td></tr>
<tr><td>impact_assessment</td><td>Text</td><td>No</td><td>Free text</td><td>Assessment of incident impact.</td></tr>
<tr><td>root_cause</td><td>Text</td><td>No</td><td>Free text</td><td>Identified root cause of the incident.</td></tr>
<tr><td>lessons_learned</td><td>Text</td><td>No</td><td>Free text</td><td>Lessons learned and preventive measures.</td></tr>
<tr><td>assigned_to</td><td>String</td><td>No</td><td>User ID</td><td>Security team member assigned.</td></tr>
<tr><td>escalated</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether incident was escalated.</td></tr>
<tr><td>escalated_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When incident was escalated.</td></tr>
<tr><td>resolved_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When incident was resolved.</td></tr>
<tr><td>false_positive</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether incident was determined to be false positive.</td></tr>
<tr><td>threat_intelligence</td><td>JSON</td><td>No</td><td>JSON object</td><td>Related threat intelligence data.</td></tr>
<tr><td>forensic_data</td><td>JSON</td><td>No</td><td>JSON object</td><td>Forensic evidence and analysis.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When incident record was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When incident record was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="ipreputationscore"><a class="header" href="#ipreputationscore">IPReputationScore</a></h2>
<p>Maintains IP address reputation data for threat detection and blocking, supporting feature CS-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>ip_address</td><td>String</td><td>Yes</td><td>IP address</td><td>IP address being tracked. Primary key.</td></tr>
<tr><td>reputation_score</td><td>Integer</td><td>Yes</td><td>0 - 100</td><td>Overall reputation score (0 = malicious, 100 = trusted).</td></tr>
<tr><td>risk_level</td><td>Enum</td><td>Yes</td><td>TRUSTED, LOW_RISK, MEDIUM_RISK, HIGH_RISK, MALICIOUS</td><td>Categorical risk assessment.</td></tr>
<tr><td>threat_categories</td><td>JSON</td><td>No</td><td>JSON array</td><td>Categories of threats associated with this IP.</td></tr>
<tr><td>first_seen_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When IP was first observed.</td></tr>
<tr><td>last_seen_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When IP was last observed.</td></tr>
<tr><td>request_count</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Total requests from this IP.</td></tr>
<tr><td>blocked_count</td><td>BigInt</td><td>Yes</td><td>Non-negative integer</td><td>Total blocked requests from this IP.</td></tr>
<tr><td>incident_count</td><td>Integer</td><td>Yes</td><td>Non-negative integer</td><td>Number of security incidents from this IP.</td></tr>
<tr><td>last_incident_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When last security incident occurred.</td></tr>
<tr><td>geolocation</td><td>JSON</td><td>No</td><td>JSON object</td><td>Geographic location data.</td></tr>
<tr><td>asn_info</td><td>JSON</td><td>No</td><td>JSON object</td><td>Autonomous System Number information.</td></tr>
<tr><td>is_vpn</td><td>Boolean</td><td>No</td><td>true/false/null</td><td>Whether IP is identified as VPN/proxy.</td></tr>
<tr><td>is_tor</td><td>Boolean</td><td>No</td><td>true/false/null</td><td>Whether IP is identified as Tor exit node.</td></tr>
<tr><td>is_datacenter</td><td>Boolean</td><td>No</td><td>true/false/null</td><td>Whether IP belongs to datacenter/hosting provider.</td></tr>
<tr><td>whitelist_status</td><td>Enum</td><td>Yes</td><td>NOT_LISTED, WHITELISTED, TEMPORARILY_WHITELISTED</td><td>Whitelist status.</td></tr>
<tr><td>blacklist_status</td><td>Enum</td><td>Yes</td><td>NOT_LISTED, BLACKLISTED, TEMPORARILY_BLACKLISTED</td><td>Blacklist status.</td></tr>
<tr><td>auto_block_until</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When automatic blocking expires.</td></tr>
<tr><td>external_reputation</td><td>JSON</td><td>No</td><td>JSON object</td><td>Reputation data from external threat intelligence.</td></tr>
<tr><td>notes</td><td>Text</td><td>No</td><td>Free text</td><td>Manual notes about this IP.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When reputation record was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When reputation was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="securityauditlog"><a class="header" href="#securityauditlog">SecurityAuditLog</a></h2>
<p>Time-series table logging all security-relevant events for compliance and forensic analysis, supporting features CS-001 and CS-002.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>log_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the audit log entry.</td></tr>
<tr><td>timestamp</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When the event occurred.</td></tr>
<tr><td>event_type</td><td>Enum</td><td>Yes</td><td>LOGIN, LOGOUT, API_ACCESS, DATA_EXPORT, CONSENT_CHANGE, SECURITY_INCIDENT, ADMIN_ACTION</td><td>Type of security event.</td></tr>
<tr><td>user_id</td><td>UUID</td><td>No</td><td>UUID</td><td>User associated with the event (if applicable).</td></tr>
<tr><td>session_id</td><td>String</td><td>No</td><td>Session ID</td><td>Session identifier.</td></tr>
<tr><td>ip_address</td><td>String</td><td>Yes</td><td>IP address</td><td>Source IP address.</td></tr>
<tr><td>user_agent</td><td>String</td><td>No</td><td>Free text</td><td>Client user agent.</td></tr>
<tr><td>endpoint</td><td>String</td><td>No</td><td>URL/endpoint</td><td>API endpoint or resource accessed.</td></tr>
<tr><td>http_method</td><td>String</td><td>No</td><td>HTTP method</td><td>HTTP method used (GET, POST, etc.).</td></tr>
<tr><td>response_code</td><td>Integer</td><td>No</td><td>HTTP status code</td><td>HTTP response code.</td></tr>
<tr><td>request_size_bytes</td><td>Integer</td><td>No</td><td>Bytes</td><td>Size of request payload.</td></tr>
<tr><td>response_size_bytes</td><td>Integer</td><td>No</td><td>Bytes</td><td>Size of response payload.</td></tr>
<tr><td>processing_time_ms</td><td>Integer</td><td>No</td><td>Milliseconds</td><td>Time taken to process request.</td></tr>
<tr><td>event_result</td><td>Enum</td><td>Yes</td><td>SUCCESS, FAILURE, BLOCKED, SUSPICIOUS</td><td>Result of the event.</td></tr>
<tr><td>risk_score</td><td>Integer</td><td>No</td><td>0 - 100</td><td>Calculated risk score for the event.</td></tr>
<tr><td>threat_indicators</td><td>JSON</td><td>No</td><td>JSON array</td><td>Security threat indicators detected.</td></tr>
<tr><td>geolocation</td><td>JSON</td><td>No</td><td>JSON object</td><td>Geographic location of request.</td></tr>
<tr><td>device_fingerprint</td><td>String</td><td>No</td><td>Hash</td><td>Device fingerprint hash.</td></tr>
<tr><td>referrer</td><td>String</td><td>No</td><td>URL</td><td>HTTP referrer header.</td></tr>
<tr><td>additional_headers</td><td>JSON</td><td>No</td><td>JSON object</td><td>Relevant HTTP headers.</td></tr>
<tr><td>payload_hash</td><td>String</td><td>No</td><td>Hash</td><td>Hash of request payload (for integrity).</td></tr>
<tr><td>compliance_flags</td><td>JSON</td><td>No</td><td>JSON array</td><td>Compliance-related flags (GDPR, etc.).</td></tr>
<tr><td>retention_category</td><td>Enum</td><td>Yes</td><td>SECURITY, COMPLIANCE, OPERATIONAL, FORENSIC</td><td>Data retention category.</td></tr>
<tr><td>anonymized</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether personally identifiable data has been anonymized.</td></tr>
<tr><td>metadata</td><td>JSON</td><td>No</td><td>JSON object</td><td>Additional event metadata.</td></tr>
</tbody></table>
</div>
<h2 id="privacypolicyversion"><a class="header" href="#privacypolicyversion">PrivacyPolicyVersion</a></h2>
<p>Tracks privacy policy versions and user acceptance, supporting feature CS-001.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Required?</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>version_id</td><td>UUID</td><td>Yes</td><td>UUID</td><td>Primary key for the privacy policy version.</td></tr>
<tr><td>version_number</td><td>String</td><td>Yes</td><td>e.g., &quot;v3.2&quot;</td><td>Human-readable version number.</td></tr>
<tr><td>effective_date</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When this version becomes effective.</td></tr>
<tr><td>expiry_date</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When this version expires (null for current).</td></tr>
<tr><td>policy_content</td><td>Text</td><td>Yes</td><td>Free text</td><td>Full text of the privacy policy.</td></tr>
<tr><td>content_hash</td><td>String</td><td>Yes</td><td>SHA-256 hash</td><td>Hash of policy content for integrity.</td></tr>
<tr><td>major_changes</td><td>JSON</td><td>No</td><td>JSON array</td><td>Summary of major changes from previous version.</td></tr>
<tr><td>legal_review_status</td><td>Enum</td><td>Yes</td><td>DRAFT, UNDER_REVIEW, APPROVED, PUBLISHED</td><td>Legal review status.</td></tr>
<tr><td>reviewed_by</td><td>String</td><td>No</td><td>User ID</td><td>Legal reviewer.</td></tr>
<tr><td>reviewed_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When legal review was completed.</td></tr>
<tr><td>published_at</td><td>Timestamp</td><td>No</td><td>ISO 8601</td><td>When version was published.</td></tr>
<tr><td>acceptance_required</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether users must explicitly accept this version.</td></tr>
<tr><td>notification_sent</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether users were notified of changes.</td></tr>
<tr><td>is_current</td><td>Boolean</td><td>Yes</td><td>true/false</td><td>Whether this is the current active version.</td></tr>
<tr><td>created_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When version was created.</td></tr>
<tr><td>updated_at</td><td>Timestamp</td><td>Yes</td><td>ISO 8601</td><td>When version was last updated.</td></tr>
</tbody></table>
</div>
<h2 id="relationships-6"><a class="header" href="#relationships-6">Relationships</a></h2>
<ul>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>UserConsent</strong> [user_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>DataExportRequest</strong> [user_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; * <strong>DataDeletionRequest</strong> [user_id (FK)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; 0...* <strong>SecurityIncident</strong> [user_id (FK, Nullable)]</li>
<li><strong>User</strong> [user_id (PK)] 1 =&gt; 0...* <strong>SecurityAuditLog</strong> [user_id (FK, Nullable)]</li>
<li><strong>IPReputationScore</strong> [ip_address (PK)] 1 =&gt; * <strong>SecurityIncident</strong> [source_ip (FK)]</li>
<li><strong>IPReputationScore</strong> [ip_address (PK)] 1 =&gt; * <strong>SecurityAuditLog</strong> [ip_address (FK)]</li>
<li><strong>PrivacyPolicyVersion</strong> [version_number (Unique Key)] 1 =&gt; * <strong>UserConsent</strong> [consent_version (FK)]</li>
</ul>
<h2 id="entities--relationships-5"><a class="header" href="#entities--relationships-5">Entities &amp; Relationships</a></h2>
<h3 id="userconsent-1"><a class="header" href="#userconsent-1">UserConsent</a></h3>
<ul>
<li><strong>consent_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id): Links consent to the specific user who provided it.</li>
<li><strong>consent_version</strong> (FK â†’ PrivacyPolicyVersion.version_number): Links to the exact policy version that was accepted.</li>
</ul>
<h3 id="dataexportrequest-1"><a class="header" href="#dataexportrequest-1">DataExportRequest</a></h3>
<ul>
<li><strong>request_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id): Links the export request to the user who made it.</li>
</ul>
<h3 id="datadeletionrequest-1"><a class="header" href="#datadeletionrequest-1">DataDeletionRequest</a></h3>
<ul>
<li><strong>deletion_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id): Links the deletion request to the user who made it.</li>
</ul>
<h3 id="securityincident-1"><a class="header" href="#securityincident-1">SecurityIncident</a></h3>
<ul>
<li><strong>incident_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id): Optionally links the incident to an affected user account.</li>
<li><strong>source_ip</strong> (FK â†’ IPReputationScore.ip_address): Links the incident to the reputation record of the source IP.</li>
</ul>
<h3 id="ipreputationscore-1"><a class="header" href="#ipreputationscore-1">IPReputationScore</a></h3>
<ul>
<li><strong>ip_address</strong> (PK): The unique IP address. Referenced by SecurityIncident and SecurityAuditLog.</li>
</ul>
<h3 id="securityauditlog-1"><a class="header" href="#securityauditlog-1">SecurityAuditLog</a></h3>
<ul>
<li><strong>log_id</strong> (PK)</li>
<li><strong>user_id</strong> (FK â†’ User.user_id): Optionally links the logged event to the user who performed the action.</li>
<li><strong>ip_address</strong> (FK â†’ IPReputationScore.ip_address): Links the log to the reputation record of the source IP.</li>
</ul>
<h3 id="privacypolicyversion-1"><a class="header" href="#privacypolicyversion-1">PrivacyPolicyVersion</a></h3>
<ul>
<li><strong>version_id</strong> (PK)</li>
<li><strong>version_number</strong> (Unique Key): The business key referenced by UserConsent.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="4-class-diagram"><a class="header" href="#4-class-diagram">4. Class Diagram</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="5-er-diagram"><a class="header" href="#5-er-diagram">5. ER Diagram</a></h1>
<iframe src="redoc.html" width="100%" height="800px" style="border:none;"></iframe>
<div style="break-before: page; page-break-before: always;"></div><h1 id="6-data-flow-diagram-dfd"><a class="header" href="#6-data-flow-diagram-dfd">6. Data Flow Diagram (DFD)</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rpc-node-provider-service"><a class="header" href="#rpc-node-provider-service">RPC Node Provider Service</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
