# Price Aggregation & Analytics Engine

## Overview

This document details the data models that support the platform's **Advanced Analytics Features**. These structures are designed to store the sophisticated outputs generated by analytical engines, including:

- Token security scores
- Liquidity health metrics
- Asset volatility calculations

The primary purpose of these models is to **persist and serve these complex analytical results efficiently** to end-users.

---

## Table Relationships

- **AssetSecurityScore**: One-to-one with the `Asset` table.
- **PoolHealthMetric**: Many-to-one with the `LiquidityPool` table (time-series).
- **AssetVolatility**: Many-to-one with the `Asset` table (time-series).

---

## üìò Entity: `AssetSecurityScore`

Stores the results of the automated smart contract analysis for each token.  
**Supports Feature:** `AA-001`

| Field Name        | Type      | Required? | Format                      | Description                                       |
| ----------------- | --------- | --------- | --------------------------- | ------------------------------------------------- |
| `asset_id`        | UUID      | Yes       | UUID                        | Foreign key to `Asset`. Also the Primary Key.     |
| `overall_score`   | Integer   | Yes       | 0 - 100                     | Consolidated safety score (100 = most secure).    |
| `risk_level`      | Enum      | Yes       | LOW, MEDIUM, HIGH, CRITICAL | Categorical risk assessment.                      |
| `check_results`   | JSON      | Yes       | JSON object                 | Detailed results from individual security checks. |
| `summary`         | Text      | No        | Free text                   | Human-readable summary of key findings and risks. |
| `last_scanned_at` | Timestamp | Yes       | ISO 8601                    | Timestamp of last successful security scan.       |

---

## üìò Entity: `PoolHealthMetric`

Stores time-series data on the health and stability of DEX liquidity pools.  
**Supports Feature:** `AA-002`

| Field Name              | Type      | Required? | Format      | Description                                                |
| ----------------------- | --------- | --------- | ----------- | ---------------------------------------------------------- |
| `pool_id`               | UUID      | Yes       | UUID        | Foreign key to `LiquidityPool`. Part of composite PK.      |
| `timestamp`             | Timestamp | Yes       | ISO 8601    | Time of metric calculation. Part of composite PK.          |
| `health_score`          | Integer   | Yes       | 0 - 100     | Overall pool health score.                                 |
| `concentration_score`   | Float     | No        | 0.0 - 1.0   | Liquidity concentration score (1.0 = highly concentrated). |
| `sustainability_metric` | Float     | No        | 0.0 - 1.0   | Long-term sustainability score.                            |
| `details`               | JSON      | No        | JSON object | Other metrics like turnover or impermanent loss.           |

---

## üìò Entity: `AssetVolatility`

Stores historical and real-time asset volatility metrics.  
**Supports Feature:** `AA-006`

| Field Name        | Type      | Required? | Format       | Description                                                          |
| ----------------- | --------- | --------- | ------------ | -------------------------------------------------------------------- |
| `asset_id`        | UUID      | Yes       | UUID         | Foreign key to `Asset`. Part of composite PK.                        |
| `timestamp`       | Timestamp | Yes       | ISO 8601     | "As of" time. Part of composite PK.                                  |
| `timeframe`       | String    | Yes       | e.g. "30d"   | Lookback period. Part of composite PK.                               |
| `volatility_type` | Enum      | Yes       | HISTORICAL   | Type of volatility. Part of composite PK.                            |
| `value`           | Float     | Yes       | Numeric      | Annualized volatility value (e.g., 0.85 = 85%).                      |
| `model`           | String    | Yes       | e.g. "GARCH" | Statistical model used for calculation (e.g., "Standard Deviation"). |

---

## üîó Relationships

```plaintext
Asset [asset_id (PK)]
 ‚îú‚îÄ‚îÄ 1 ‚Üí 1 AssetSecurityScore     [asset_id (PK, FK)]
 ‚îî‚îÄ‚îÄ 1 ‚Üí * AssetVolatility        [asset_id (FK)]

LiquidityPool [pool_id (PK)]
 ‚îî‚îÄ‚îÄ 1 ‚Üí * PoolHealthMetric       [pool_id (FK)]

 ## üìê Entities & Relationships Summary

### üî∏ AssetSecurityScore

- `asset_id`
  ‚Üí **Primary Key**
  ‚Üí **Foreign Key ‚Üí Asset.asset_id**

---

### üî∏ PoolHealthMetric

- `pool_id`
  ‚Üí **Primary Key**
  ‚Üí **Foreign Key ‚Üí LiquidityPool.pool_id**

- `timestamp`
  ‚Üí **Primary Key**

---

### üî∏ AssetVolatility

- `asset_id`
  ‚Üí **Primary Key**
  ‚Üí **Foreign Key ‚Üí Asset.asset_id**

- `timestamp`
  ‚Üí **Primary Key**

- `timeframe`
  ‚Üí **Primary Key**

- `volatility_type`
  ‚Üí **Primary Key**

```
